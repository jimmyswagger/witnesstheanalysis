passA <- pass%>%filter(Teamnum == "A")

passA <- passA[passA$main!="Spoil Off", ]
passA <- passA[passA$main!="Def Act", ]
passA <- passA[passA$main!="Tck Def", ]
passA <- passA[passA$main!="Free Loss", ]
passA <- passA[passA$main!="Tck End", ]
passA <- passA[passA$main!="Tck Att", ]
passA <- passA[passA$main!="Tck Att Ndp", ]

#id poss with shots
pashscr <- passA%>%group_by(Team, Action) %>% filter(main  == "Shot Op Oc"|main =="Shot Rs Oc")

#Pulls out all of the poss
teamsht <- subset(passA,poss%in%pashscr$poss)
 
teamAsht<- teamsht%>%group_by(poss) %>% filter(Teamnum == "A")%>%select(Player,poss)

teamAshtA <-dplyr::distinct(teamAsht)

teamAshtA<- teamAshtA %>%group_by(Player)%>%select(Player,poss)%>%summarize(count=n()) 


ggplot(teamAshtA , aes(x = Player, y = count)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =count, vjust = 0), size = 8,colour ="black") +
scale_x_continuous(labels = passA$Player, breaks = passA$Player)  + 
ylab("Shot involvements") +
theme(legend.position="none") +
 theme_classic()


pashscr <- pass%>%group_by(Team, Action) %>% filter(subset  == "Scr Op"|subset =="Scr Rs")

#Pulls out all of the poss
teamscr <- subset(pass,poss%in%pashscr$poss)


teamscr<-dplyr::distinct(teamscr)

scr <- teamscr %>%group_by(Team, Player,Pitch_Area)%>%summarize(count=n()) 

scr
