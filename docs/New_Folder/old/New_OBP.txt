#Add ToB to Playerstats

ToBA <- run %>% group_by(Team,Player)%>% filter (keep == "Y",Teamnum == "A",main %in% c("Rec Op", "Rec Rs", "Ko Rec", "PW")) %>% summarise(Time_on_Ball =sum(time_diff))

ToBA  = ToBA  %>% 
   unite(plyid, Team, Player, sep = " ", remove = FALSE)

ToBA <- ToBA %>%  mutate(plyname = VLOOKUP(plyid,teamsheet,plyid, Player))

plystatsA <- plystatsA %>%  mutate(ToB = VLOOKUP(ply,ToBA,Player,Time_on_Ball))


plytree <- plystatsA 

plytreeA = plytree %>% 
   unite(combined, Player, OBP,ToB, sep = " ", remove = FALSE)

treemap(dtf = plytreeA,
        index=c("combined"),
        vSize="OBP",
        vColor="OBP",
        palette="Spectral",
        type="value",
        border.col=c("grey70", "grey90"),
        fontsize.title = 36,
        algorithm="pivotSize",
        title ="On Ball Possessions",
        title.legend="Possessions",
        fontsize.labels= 25)
