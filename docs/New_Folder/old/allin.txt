ZdeAA1015 <- zonedAA %>% group_by (Team) %>%filter (Teamnum == "A") %>%
summarize(Possessions =sum(main %in% c("PW","Ko Rec")),
inentry = COUNT_IFS(inzone,main %in% c("Shot Op","Shot Rs"), inzone %in% c("1","3")),
ocentry = COUNT_IFS(oczone,mainoc %in% c("ToL"), oczone %in% c("1","3")), 
entry = (inentry + ocentry), 
shots =sum(main %in% c("Shot Op","Shot Rs")), 
scores = sum(subsetoc %in% c("Scr Op","Scr Rs"))) %>% select (Team,Possessions, entry, shots,scores,ocentry) 




# Creates for all rows 

#0 point is strictly exterior to polygon
#1 point is strictly interior to polygon
#2 point lies on the relative interior of an edge of polygon
#3 point is a vertex of polygon


#looking at poss that started in in_def and see if they ended in inzone
#creating the hull
#Finds the shots

scoresAarea <- scores %>%ungroup() %>%filter (Teamnum == "A") %>% select(Areax, Areay)

#creates the hull for all shots - think about changing this to scores only
hull <- scoresAarea %>%slice(chull(Areax, Areay))

#filters end of possessions - actions only
TeamAEnd  <- run %>%group_by(Team, Action) %>% filter(keep=="Y",Teamnum == "A")

#finds which are inside 
#point.in.polygon( TeamAEnd$Areax, TeamAEnd$Areay,hull$Areax, hull$Areay, mode.checked=FALSE)

#creates a dataframe of oc 
inzone <- data.frame(inzone = point.in.polygon(TeamAEnd$Areax, TeamAEnd$Areay,hull$Areax, hull$Areay, mode.checked=FALSE))

#creates a df of all action - allows to create other things
zonedA <-bind_cols(TeamAEnd,inzone)


#filters end of possessions - actions only
zonedB  <- zonedA %>%group_by(Team, Action) %>% filter(keep=="Y",Teamnum == "A")

#finds which are inside 
#point.in.polygon(zonedB$xend,zonedA$yend,hull$Areax, hull$Areay, mode.checked=FALSE)

#creates a dataframe of oc 
oczone <- data.frame(oczone = point.in.polygon(zonedB$xend,zonedB$yend,hull$Areax, hull$Areay, mode.checked=FALSE))

#creates col based on oc - allows to create other things
zonedA <-bind_cols(zonedA,oczone)

zonedA <- zonedA %>% mutate (ihw = ifelse(zone <16, 1, 2))

zonedA <- zonedA %>% mutate (ohwend = ifelse(zoneoc >15, 1, 2))

zonedA


