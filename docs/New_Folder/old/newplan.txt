---
title: " Ballyboden (0.08) vs Eire Og(0.06)"
output:
  html_document:
    theme: cosmo
    toc: yes
    toc_float: yes

---

Leinster Club Final - 2019

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))
#Load packages
library(flexdashboard)
library(dplyr)
library(deldir)
library(ggplot2)
library(ggrepel)
library(ggpubr)
library(knitr)
library(rmarkdown)
library(kableExtra)
library(data.table)
library(RColorBrewer)
library(gridExtra)
library(igraph)
library(tidyverse)
library(treemap)
library(plotly)
library(networkD3)
library (curl)
library(formattable)
library(grid)
library(yaml)
```

```{r}

pass <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/passbodeir.csv", header=TRUE, sep=";")
attach (pass)

passline <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/passlinebodeir.csv", header=TRUE, sep=";")
attach (passline)

position  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/positionbodeir.csv", header=TRUE, sep=";")
attach (position)

plytree  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/plytreebodeir.csv", header=TRUE, sep=";")
attach (plytree)

plystats <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/plystatsbodeir.csv", header=TRUE, sep=";")
attach (plystats)

passmap  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/passmapbodeir.csv", header=TRUE, sep=";")
attach (passmap)

scorelist  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/scorelistbodeir.csv", header=TRUE, sep=";")
attach (scorelist)

summary  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/summarybodeir.csv", header=TRUE, sep=";")
attach (summary)

scores  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/scoresbodeir.csv", header=TRUE, sep=";")
attach (scores)

scrd  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/scrdbodeir.csv", header=TRUE, sep=";")
attach (scrd)

shots <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/shotsbodeir.csv", header=TRUE, sep=";")
attach (shots)

passtofrom  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/passtofrombodeir.csv", header=TRUE, sep=";")
attach (passtofrom)

attstats <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/attstatsbodeir.csv", header=TRUE, sep=";")
attach (attstats)

origtime <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/origtimebodeir.csv", header=TRUE, sep=";")
attach (origtime)

shotstats <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/shotstatsbodeir.csv", header=TRUE, sep=";")
attach (shotstats)

koeff <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/koeffbodeir.csv", header=TRUE, sep=";")
attach (koeff)

rseff <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/rseffbodeir.csv", header=TRUE, sep=";")
attach (rseff)

overview <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/overbodeir.csv", header=TRUE, sep=";")
attach (overview)

run <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/runbodeir.csv", header=TRUE, sep=";")
attach (run)

tabrun <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/tabrun.csv", header=TRUE, sep=";")
attach (tabrun)

linecol <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/linecol.csv", header=TRUE, sep=";")
attach (linecol)

passbd<- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/passbdbodeir.csv", header=TRUE, sep=";")
attach (passbd)

tack <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/tackbodeir.csv", header=TRUE, sep=";")
attach (tack)

ppda <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/ppdabodeir.csv", header=TRUE, sep=";")
attach (ppda)

```

```{r}
create_GAA_Pitch <- function(grass_colour, line_colour, background_colour, goala_colour,goalb_colour,label_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      # panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      panel.background=element_rect(fill= background_colour,colour= background_colour),
      strip.text.x=element_text(size=size*1))}

  ymin <- 0 # minimum width
  ymax <- 98 # maximum width
  xmin <- 0 # minimum length
  xmax <- 144 # maximum length
  
  # pitch lines
  def13 <- 13
  def20 <- 20
  def45 <- 45
  def65 <- 65
  off65 <- 79
  off45 <- 99
  off20 <- 124
  off13 <- 131
  
  
  # small sqaure

  sixYardrd <- 42
  sixYardld <- 56
  sixYardDefxst <- 4.5
  sixYardOffxst <- 139.5

  #13 box
  right14d <- 39.5
  left14d <- 58.5

  #Goals
  glxst <- 0
  glyst <- 45.75
  glxed <- 144
  glyed <- 52.25

  #halfway line
  hwxst <- 72
  hwyst <- 45.75
  hwyed <- 52.25

  #pen spot

  pdxst <- 11
  pdyst <- 48.5
  pdyed <- 49.5
  poxst <- 133
  
# tramlines
  srwing <- 19.6
  rhalfsp <- 39.2
  ctre <- 58.8
  lhalfsp <- 78.4
      
  circleFundef <- function(center=c(0,0), diameter=1, npoints=100, start=0, end=2)
  {
    tt <- seq(start*pi, end*pi, length.out=npoints)
    data.frame(x = center[1] + diameter / 2 * cos(tt), 
               y = center[2] + diameter / 2 * sin(tt))
  }
  
  circleFunatt <- function(center=c(0,0), diameter=1, npoints=100, start=0, end=2)
  {
    tt <- seq(start*pi, end*pi, length.out=npoints)
    data.frame(x = center[1] - diameter / 2 * cos(tt), 
               y = center[2] - diameter / 2 * sin(tt))
  }
  #### create semi circle ####
  def_circle <-  circleFundef(c(20,49), 26, start=1.5, end=2.5)
  att_circle <-  circleFunatt(c(124,49), 26, start=1.5, end=2.5)
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    p <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add lines goals etc
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def13, y = ymin, xend = def13, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +   
      geom_segment(aes(x = def20, y = ymin, xend = def20, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off20, y = ymin, xend = off20, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off13, y = ymin, xend = off13, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = right14d, xend = def13, yend = right14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = left14d, xend = def13, yend = left14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmax, y = right14d, xend = off13, yend = right14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmax, y = left14d, xend = off13, yend = left14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = hwxst, y = hwyst, xend = hwxst, yend = hwyed),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmin, y = sixYardrd, xend = sixYardDefxst, yend = sixYardrd),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmin, y = sixYardld, xend = sixYardDefxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = sixYardDefxst, y = sixYardrd, xend = sixYardDefxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmax, y = sixYardrd, xend = sixYardOffxst, yend = sixYardrd),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmax, y = sixYardld, xend = sixYardOffxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = sixYardOffxst, y = sixYardrd, xend = sixYardOffxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = pdxst, y = pdyst, xend = pdxst, yend = pdyed),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = poxst, y = pdyst, xend = poxst, yend = pdyed),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = glxst, y =  glyst, xend = glxst, yend = glyed),colour = goala_colour, size = 1) +
      geom_segment(aes(x =glxed, y =  glyst, xend =glxed, yend = glyed),colour = goalb_colour, size = 1) +
      geom_path(data=def_circle, aes(x,y), colour = line_colour,size = 0.5) +
      geom_path(data=att_circle, aes(x,y), colour = line_colour,size = 0.5) + 
      annotate(geom="text", x= 21.5, y=1.25, label="20",color = label_colour,size = 4) +
      annotate(geom="text", x= 46.5, y=1.25, label="45",color = label_colour,size = 4) +
      annotate(geom="text", x= 66.5, y=1.25, label="65",color = label_colour,size = 4) +
      annotate(geom="text", x= 80.5, y=1.25, label="65",color = label_colour,size = 4) +
      annotate(geom="text", x=100.5, y=1.25, label="45", color=label_colour,size = 4) +
      annotate(geom="text", x=125.5, y=1.25, label="20",color = label_colour,size = 4) +
      annotate(geom="text", x= 131, y=4, label="www.witnesstheanalysis.com",color = label_colour,size = 4, alpha = 0.4) +
      annotate(geom="text", x= 12, y=96, label="www.witnesstheanalysis.com",color = label_colour,size = 4, alpha = 0.4) +
      annotate("segment", x = 68, xend = 76, y = 2, yend = 2, colour = "pink", size=3, alpha=0.6, arrow=arrow())
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
     p <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add lines goals etc
            geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def13, y = ymin, xend = def13, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +   
      geom_segment(aes(x = def20, y = ymin, xend = def20, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off20, y = ymin, xend = off20, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off13, y = ymin, xend = off13, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = right14d, xend = def13, yend = right14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = left14d, xend = def13, yend = left14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmax, y = right14d, xend = off13, yend = right14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmax, y = left14d, xend = off13, yend = left14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = hwxst, y = hwyst, xend = hwxst, yend = hwyed),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmin, y = sixYardrd, xend = sixYardDefxst, yend = sixYardrd),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = sixYardld, xend = sixYardDefxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = sixYardDefxst, y = sixYardrd, xend = sixYardDefxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmax, y = sixYardrd, xend = sixYardOffxst, yend = sixYardrd),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmax, y = sixYardld, xend = sixYardOffxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = sixYardOffxst, y = sixYardrd, xend = sixYardOffxst, yend = sixYardld),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = pdxst, y = pdyst, xend = pdxst, yend = pdyed),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = poxst, y = pdyst, xend = poxst, yend = pdyed),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = glxst, y =  glyst, xend = glxst, yend = glyed),colour = goala_colour, size = 1) +
      geom_segment(aes(x =glxed, y =  glyst, xend =glxed, yend = glyed),colour = goalb_colour, size = 1) +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted",size = 0.5) +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted",size = 0.5) +
      geom_segment(aes(x = xmin, y = ctre, xend = xmax, yend = ctre),colour = line_colour,linetype="dotted",size = 0.5) +
      geom_segment(aes(x = xmin, y = lhalfsp, xend = xmax, yend = lhalfsp),colour = line_colour,linetype="dotted",size = 0.5) +
      geom_path(data=def_circle, aes(x,y), colour = line_colour,size = 0.5) +
      geom_path(data=att_circle, aes(x,y), colour = line_colour,size = 0.5) + 
      annotate(geom="text", x= 21.5, y=1.25, label="20",color = label_colour,size = 4) +
      annotate(geom="text", x= 46.5, y=1.25, label="45",color = label_colour,size = 4) +
      annotate(geom="text", x= 66.5, y=1.25, label="65",color = label_colour,size = 4) +
      annotate(geom="text", x= 80.5, y=1.25, label="65",color = label_colour,size = 4) +
      annotate(geom="text", x=100.5, y=1.25, label="45", color=label_colour,size = 4) +
      annotate(geom="text", x=125.5, y=1.25, label="20",color = label_colour,size = 4) +
      annotate(geom="text", x= 100, y=2, label="www.witnesstheanalysis.com",color = "white",size = 2, alpha = 0.4) +
      annotate(geom="text", x= 12, y=97, label="www.witnesstheanalysis.com",color = "white",size = 2, alpha = 0.4)
  }
  
  return(p)}


p <- create_GAA_Pitch("#A2CD5A", "white", "lightblue", "blue","red","white", BasicFeatures=TRUE)

```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  def14 <- 1.25
  def21 <- 1.5
  def45 <- 2.5
  def65 <- 3.5
  off65 <- 4.5
  off45 <- 5.5
  off21 <- 6.5
  off14 <- 6.75
  offel <- 7.5
  
  
  
  # Defining features along the width
  srwing <- 1.5
  frightwing <- 5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    wp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "black",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "black",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "black",linetype="solid") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "black",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "black",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_rect(aes(xmin=boxEdgeOff, xmax=xmax, ymin=boxEdgeLeft, ymax=boxEdgeRight), colour = "black", fill = grass_colour) + 
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "black") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "black", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "white") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="white") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") + 
      annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 4, alpha = 0.4)
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    wp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(wp)}


wp <- create_Stats_Pitch("#ffffff", "#A9A9A9", "#ffffff", "#000000", BasicFeatures=TRUE)


```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 3.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 5.5 # maximum length
  
  # Defining features along the length
  srwing <- 1.5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  sixYardLeft <- 2.75
  sixYardRight <- 3.25
  
  # Defining features along the width
  
  off14 <- 2.7
  off21 <- 2.5
  off45 <- 1.5
  left14 <- 2.65
  right14 <- 3.35
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    qp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = xmin, y = off21, xend = xmax, yend = off21),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = off45, xend = xmax, yend = off45),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = off14, xend = xmax, yend = off14),colour = "white",linetype="solid") +
      geom_segment(aes(x = srwing, y = ymin, xend = srwing, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = rhalfsp, y = ymin, xend = rhalfsp, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = ctre, y = ymin, xend = ctre, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = lhspce, y = ymin, xend = lhspce, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = left14, y = ymax, xend = left14, yend = 2.7),colour = "white" ,linetype="solid") + 
      geom_segment(aes(x = right14, y = ymax, xend = right14, yend = 2.7),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = sixYardLeft, y = ymax, xend = sixYardLeft, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = sixYardRight, y = ymax, xend = sixYardRight, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = 2.75, y = 3.25, xend = 3.25, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x =2.8, y = 3.5, xend = 3.20, yend = 3.5),colour = "black", size = 2) +
      annotate(geom="text", x=0.57, y=1.45, label="45", color="white") +
      annotate(geom="text", x=0.57, y=2.45, label="21",color = "white") +
      annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 4, alpha = 0.4)
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    qp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(qp)}


qp <- create_Stats_Pitch("#A2CD5A", "#6495ED", "#ffffff", "#000000", BasicFeatures=TRUE)
```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  defe1 <- 1
  def14 <- 1.25
  def21 <- 1.5
  defe2 <- 2
  def45 <- 2.5
  defe3 <- 3
  def65 <- 3.5
  defe4 <- 4
  off65 <- 4.5
  defe5 <- 5
  off45 <- 5.5
  defe6 <- 6
  off21 <- 6.5
  off14 <- 6.75
  defe7 <- 7
  offel <- 7.5
  
  
  
  # Defining features along the width
  ctre1 <- 1
  srwing <- 1.5
  ctre2 <- 2
  rhalfsp <- 2.5
  ctre3 <- 3
  ctre <- 3.5
  ctre4 <- 4
  lhspce <- 4.5
  ctre5 <- 5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  right14o <- 2.6
  left14o <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    sp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "white",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "blue",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "red",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "white",linetype="solid") + 
        geom_segment(aes(x = defe1, y = ymin, xend = defe1, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe2, y = ymin, xend = defe2, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe3, y = ymin, xend = defe3, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe4, y = ymin, xend = defe4, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe5, y = ymin, xend = defe5, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe6, y = ymin, xend = defe6, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe7, y = ymin, xend = defe7, yend = ymax),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = left14o, xend = xmax, yend = left14o),colour = "white",linetype="solid") +	
      geom_segment(aes(x = off14, y = right14o, xend = xmax, yend = right14o),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = ctre1, xend = xmax, yend = ctre1),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre2, xend = xmax, yend = ctre2),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre3, xend = xmax, yend = ctre3),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre4, xend = xmax, yend = ctre4),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre5, xend = xmax, yend = ctre5),colour = line_colour,linetype="dotted") +
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "white") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "red", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "blue") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="red") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") + 
      annotate("segment", x = 3.6, xend = 4.4, y = 0.65, yend = 0.65, colour = "pink", size=3, alpha=0.6, arrow=arrow()) +
      annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 8, alpha = 0.4)
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    sp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "red",linetype="dotted") +
                 annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 4, alpha = 0.4)
    
  }
  
  return(sp)}


sp <- create_Stats_Pitch("#A2CD5A", "black", "#ffffff", "#000000", BasicFeatures=TRUE)

```

#Summary 
##Starting Line Up (Number, Player, Playing time)
###Ballyboden
```{r, fig.width = 16, fig.height = 10}
#Starting Line up change to single team

positionA <-position %>% filter (Teamnum == "A") 

p + geom_point(data = positionA, aes(x=Areax, y=Areay, shape = Team), colour = "blue",size = 8) +
  theme(plot.title = element_text( size=32, hjust=0)) +
  geom_text_repel(data = positionA, aes(x=Areax, y=Areay, label = ptPlayer), colour = "white", size = 8) +
  theme(legend.position="none")
```

###Eire Og
```{r, fig.width = 16, fig.height = 10}
positionB <-position %>% filter (Teamnum == "B") 

p + geom_point(data = positionB, aes(x=Areax, y=Areay, shape = Team), colour = "red",size = 8) +
  theme(plot.title = element_text( size=32, hjust=0)) +
  geom_text_repel(data = positionB, aes(x=Areax, y=Areay, label = ptPlayer), colour = "white", size = 8) +
  theme(legend.position="none")

```

##Scores

Team A|Team B
------------|---------------------
C. Basquel (0-02) |Gannon (0-02)
R. Basquel (0-02, 0-01f)| Dunphy (0-02)
Conal Keaney (0-02)| Blake (0-01)
Macauley (0-01) |Morrissey (0-01)
Egan (0-01) |



```{r}
my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black")) +
theme(legend.position="none")
  }

# Plot
ggplot(overview, aes(x=Stat, y= Ballyboden)) + 
  geom_point(data = overview,aes(x=Stat, y=Ballyboden), col="blue", size=10) +  
  geom_point(data = overview,aes(x=Stat, y=Eire.Og), col="red", size= 10) +
  geom_segment(aes(x=Stat, xend=Stat, y=min(Ballyboden), yend=max(Ballyboden)), 
  linetype="dashed", size=0.1,colour = "grey") +     
  coord_flip() +
geom_text(data = overview,aes(x=Stat, y=Ballyboden,label = Ballyboden), size = 6,col="white") +
geom_text(data = overview,aes(x=Stat, y=Eire.Og,label = Eire.Og), size = 6,col="white") +
my_theme ()


```

##Efficiency
```{r}
 
kable (summary) %>%
  kable_styling(bootstrap_options = c("striped"),full_width = F)

```


```{r,out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}
goal_theme <- function(){
  theme_classic() +
    theme(text = element_blank(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title.x = element_blank(),
          axis.title.y = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          plot.title =  element_blank())
}

  
          ymin <- 0 # minimum width
          ymax <- 5 # maximum width
          xmin <- 0 # minimum length
          xmax <- 3 # maximum length

      bygoal<- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = "lightgreen", colour = "white") + 
      geom_segment(aes(x = 0, y = 1, xend = 3, yend = 1),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 1, xend = 1, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 2, y = 1, xend = 2, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 2, xend = 2, yend = 2),colour = "white",linetype="solid",size = 3) +
      annotate(geom="text", x= 1.50, y=1.5, label="Goal - 0",color = "black",size = 14) + 
      annotate(geom="text", x= 1.50, y=3.5, label="Point - 8",color = "black",size = 14) + 
      annotate(geom="text", x= 2.50, y=3, label="Wide Right - 4",color = "black",size = 14) + 
      annotate(geom="text", x= .50, y=3, label="Wide Left - 0",color = "black",size = 14) + 
      annotate(geom="text", x= 1, y=.5, label="Short/Post - 1/0",color = "black",size = 14) + 
      annotate(geom="text", x= 2, y=.5, label="Save/Blkd - 1/1",color = "black",size = 14) +
      annotate(geom="text", x= 0.5, y=4.7, label="Ballyboden",color = "black",size = 18)  +
      annotate(geom="text", x= 0.5, y=4.4, label="Total Shots - 15",color = "black",size = 16)  +
      goal_theme ()
      
      bygoal
      
      crkgoal<-ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = "lightgreen", colour = "white") + 
      geom_segment(aes(x = 0, y = 1, xend = 3, yend = 1),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 1, xend = 1, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 2, y = 1, xend = 2, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 2, xend = 2, yend = 2),colour = "white",linetype="solid",size = 3) +
      annotate(geom="text", x= 1.50, y=1.5, label="Goal - 0",color = "black",size = 14) + 
      annotate(geom="text", x= 1.50, y=3.5, label="Point - 6",color = "black",size = 14) + 
      annotate(geom="text", x= 2.50, y=3, label="Wide Right - 3",color = "black",size = 14) + 
      annotate(geom="text", x= .50, y=3, label="Wide Left - 0",color = "black",size = 14) + 
      annotate(geom="text", x= 1, y=.5, label="Short/Post - 5/0",color = "black",size = 14) + 
      annotate(geom="text", x= 2, y=.5, label="Save/Blkd - 0/2",color = "black",size = 14) +
      annotate(geom="text", x= 0.5, y=4.7, label="Eire Og",color = "black",size = 18)  +
      annotate(geom="text", x= 0.5, y=4.4, label="Total Shots - 16",color = "black",size = 16)  +
      goal_theme ()
      
      crkgoal
      
```


##Scoring Timeline
```{r, fig.width = 16, fig.height = 10}
wormA <-scores%>%filter(Teamnum == "A", subsetoc =="Start"|subsetoc =="Scr Op"|subsetoc =="Scr Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

wormB <-scores%>%filter(Teamnum == "B",subsetoc =="Start"|subsetoc =="Scr Op"|subsetoc =="Scr Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

wormC <-scores%>%filter(Teamnum == "A", subsetoc =="Start"|subsetoc =="Ms Op"|subsetoc =="Ms Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

wormD <-scores%>%filter(Teamnum == "B",subsetoc =="Start"|subsetoc =="Ms Op"|subsetoc == "MS Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

 
ggplot(data=scores, aes(x=timeoc, y=score, group=Team)) +
    geom_step(data=wormA, aes(x=timeoc, y=score), colour = "black", ,size=2) + 
    geom_step(data=wormB, aes(x=timeoc, y=score), colour = "black", size=2) + 
    geom_point(data = wormA, shape = 1, size = 4, stroke = 2, colour = "blue") +
    geom_point(data = wormB, shape = 1, size = 4, stroke = 2, colour = "red") +
    geom_point(data = wormC, shape = 4, size = 3, stroke = 2, colour = "blue") +
    geom_point(data = wormD, shape = 4, size = 3, stroke = 2, colour = "red") +
    theme_classic() + 
    theme(plot.background = element_blank(),
    legend.position="bottom",
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()) +
    geom_text_repel(data = wormA, aes(x=timeoc, y=score, label = plylabrec), size = 4, colour = "blue",  
    segment.size  = 0.2,   hjust = 1,nudge_x = -2, nudge_y = 2) + 
    geom_text_repel(data = wormB, aes(x=timeoc, y=score, label = plylabrec), size = 4, colour = "red",  
    segment.size  = 0.2,   direction = "y",nudge_x = 3, nudge_y = -4) + 
    guides(size = FALSE) + 
  theme(axis.text.y =element_text(size=16),
        axis.title.y =element_text(size=16,face="bold"), axis.text.x =element_text(size=16),
        axis.title.x =element_text(size=16,face="bold"))


```

##Score Differential
```{r, fig.width = 16, fig.height = 10}
scores <- scores%>%filter(subsetoc =="Start"|subsetoc =="Scr Op"|subsetoc =="Scr Rs")%>%select(Team,octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff,scrd,scrds)

#margins

ggplot(data=scores, aes(x=timeoc, y=scorediff )) +
  geom_step(size=2) +
  geom_point() +
geom_hline(yintercept=0, linetype="dashed", color = "orange") +
theme_classic() +
geom_text_repel(data = scores, aes(x=timeoc, y=scorediff, label = scrd),  size = 8) + 
    annotate(geom="text", x=4, y=4.5, label="Ballyboden", color="black", size = 12) +
    annotate(geom="text", x=3.5, y=-4.5, label="Eire Og", color="black", size = 12) +
    theme(plot.background = element_blank(),
    legend.position="none",
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(), 
    axis.title.y = element_blank(),
         axis.text.x =element_text(size=16),
        axis.title.x =element_text(size=16,face="bold"))

```

##Path of Possession

```{r}

runcolpal <- c(
  "0" = "blue",
  "1" = "black", 
  "2" = "blue", 
  "3" = "white",
  "4" = "yellow",
  "5" =  "gold",
  "6" = "darkred",
  "7" = "red",
  "8" = "red",
  "9" = "pink",
  "10" = "lightblue",
  "Team"= "orange",
"PW" = "purple")


runlinepal <- c(
  "0" = 2,
  "1" = 1, 
  "2" = 2, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 2,
  "7" = 2,
  "8" = 2,
  "9" = 1,
  "10"= 1,
  "Team"= 6)
```


```{r, out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}
run <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/runbodeir.csv", header=TRUE, sep=";")
attach (run)

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "1")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "1")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "1")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "1")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "1")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "1")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "1")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 

run <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/runbodeir.csv", header=TRUE, sep=";")
attach (run)

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "2")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "2")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "2")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "2")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "2")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "2")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "2")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 

run <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/runbodeir.csv", header=TRUE, sep=";")
attach (run)

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "3")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "3")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "3")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "3")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "3")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "3")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "3")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 

run <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/runbodeir.csv", header=TRUE, sep=";")
attach (run)

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "4")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "4")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "4")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "4")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "4")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "4")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "4")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 



```

#Positioning & Possessions
##Average Position by Action
###Ballyboden
###Game
```{r, fig.width = 16, fig.height = 10}

aveposA <- pass %>%group_by(Player, main)%>%filter( Teamnum == "A", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "blue", size = 6) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 8, colour = "white") +
theme(legend.position="none")
```

###Period
```{r,  out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}

aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "1", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "red", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 1") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "2", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "blue", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 2") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))


aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "3", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "black", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 3") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "4", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "darkblue", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 4") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))
```

###Eire Og
###Game
```{r,  fig.width = 16, fig.height = 10}

aveposB <- pass %>%group_by(Player, main)%>%filter( Teamnum == "B", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "red", size = 6) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 8, colour = "white") +
theme(legend.position="none")
```

###Period 
```{r, out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}

aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "1", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Free Won"|main == "Free Loss"|main == "Spoil Off"|main == "RBW"| main == "Def Act" |main == "Tack Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "red", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
 ggtitle ("Period 1") +
theme(legend.position="none") + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "2", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "blue", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
ggtitle("Period 2") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))


aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "3", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "black", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
ggtitle("Period 3") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "4", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "darkblue", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
ggtitle("Period 4") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))
```

##Areas of Play by Possession
###Ballyboden
```{r, fig.width = 16, fig.height = 10}
heatmapA <- passmap %>%filter(plyr == "A")


p + geom_raster(data = heatmapA, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "blue") + 
 theme(legend.position="none")
```

###Eire Og
```{r, fig.width = 16, fig.height = 10}
heatmapB <- passmap %>%filter(plyr == "B")

p + geom_raster(data = heatmapB, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "red") + 
 theme(legend.position="none")

```

##Denisty Map (All Actions)
###Ballyboden 
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "A", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|main == "Ko Rec"|main == "Free Won"|main == "Free Loss"| main == "Spoil Def" |main == "Spoil Off")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main),colour = "black",size = 4,stroke = 1)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

###Eire Og 
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "B", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|main == "Ko Rec"|main == "Free Won"|main == "Free Loss"| main == "Spoil Def" |main == "Spoil Off")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main),colour = "black",size = 4,stroke = 1)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

##Path of Possession

```{r}

runcolpal <- c(
  "0" = "blue",
  "1" = "black", 
  "2" = "blue", 
  "3" = "white",
  "4" = "yellow",
  "5" =  "gold",
  "6" = "darkred",
  "7" = "red",
  "8" = "red",
  "9" = "pink",
  "10" = "lightblue",
  "Team"= "orange",
"PW" = "purple")


runlinepal <- c(
  "0" = 2,
  "1" = 1, 
  "2" = 2, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 2,
  "7" = 2,
  "8" = 2,
  "9" = 1,
  "10"= 1,
  "Team"= 6)
```

##Lines

Action|	Colour|	Action|	Colour
-------|-------|------|----------------
Hand Pass|	Black|	Kickout Lost|	Dark Red
Run	Blue|	Kick Pass Left|	Pink
Score	Yellow|	Kick Pass Right	White
Miss shot	Red|Fk/Mk/Sl Pass	Light Blue
Kickout	Gold|	Pass Loss	Red

##Dots

Action|	Colour	
------------------|-----
Possession Won	Purple|		
Ko/Pass Lost	Red|		
Fk Won	Blue|		
Fk Won (in 45)	Orange|		
Kickout Won	Black|

###Ballyboden - Game
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```

```{r, fig.width = 16, fig.height = 10}


heatmapA <- passmap %>%filter(plyr == "A")

runA <- run%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")

p + geom_raster(data = heatmapA, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "orange") + 
 theme(legend.position="none") +
    geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```


###Ballyboden - Shots and Scores
```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="Shot Op"|main == "Shot Rs")



#Pulls out all shots from main TeamA
runA <- subset(run, poss %in% TeamAPAScr$poss)

runA <- runA%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```


###Pop Starting from Possession Won 
```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "A", main == "PW")


#Pulls out all shots from main TeamA
runA <- subset(runA, poss %in% TeamAPAScr$poss)

runA <- runA%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```


###Pop Starting from Kick Out
```{r, fig.width = 16, fig.height = 10}



#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "A", main == "Ko")



#Pulls out all shots from main TeamA
runA <- subset(run, poss %in% TeamAPAScr$poss)

runA <- runA%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```



###Ballyboden - Period 1
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "1")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "1")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "1")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "1")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "1")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "1")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "1")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 




```

###Ballyboden - Period 2
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "2")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "2")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "2")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "2")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "2")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "2")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "2")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Ballyboden - Period 3
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "3")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "3")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "3")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "3")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "3")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "3")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "3")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 

```

###Ballyboden - Period 4
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "4")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "4")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "4")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "4")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "4")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "4")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "4")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 



```

###Eire Og - Game
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
       geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
   geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```

```{r, fig.width = 16, fig.height = 10}
heatmapA <- passmap %>%filter(plyr == "B")

runB <- run%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")



p + geom_raster(data = heatmapA, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "orange") + 
 theme(legend.position="none") + 
  geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
   geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```


###Eire Og - Shots and Scores

```{r, fig.width = 16, fig.height = 10}


#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "B", main =="Shot Op"|main == "Shot Rs")



#Pulls out all shots from main TeamA
runB <- subset(run, poss %in% TeamAPAScr$poss)



runB <- runB%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)  +
    geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)
```

###Pop Starting from Possession Won 

```{r, fig.width = 16, fig.height = 10}


#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "B", main == "PW")



#Pulls out all shots from main TeamA
runB <- subset(run, poss %in% TeamAPAScr$poss)



runB <- runB%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)  +
    geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)
```

###Pop Starting from Kick Out

```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "B", main == "Ko")



#Pulls out all shots from main TeamA
runB <- subset(run, poss %in% TeamAPAScr$poss)



runB <- runB%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)  +
    geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```


###Eire Og Period - 1
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "1")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "1")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "1")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "1")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "1")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "1")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec",period == "1")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x=xend, y=yend,), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x=xend, y=yend,), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x=xend, y=yend,, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Eire Og Period - 2
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "2")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "2")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "2")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "2")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "2")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "2")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec",period == "2")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x=xend, y=yend,), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x=xend, y=yend,), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x=xend, y=yend,, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Eire Og Period - 3
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "3")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "3")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "3")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "3")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "3")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "3")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc== "Ko Rec",period == "3")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x=xend, y=yend,), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x=xend, y=yend,), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x=xend, y=yend,, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Eire Og Period - 4
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "4")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "4")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "4")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "4")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "4")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "4")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec",period == "4")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x=xend, y=yend,), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x=xend, y=yend,), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x=xend, y=yend,, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

##45 Entries
###Ballyboden 

```{r}
total45A <- run%>%group_by(Team) %>% filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99 )%>%summarize(count=n())

hp45A <- run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, seg == "1" )%>%summarize(count=n())

KPLA <-  run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, seg == "9" )%>%summarize(count=n())

KPRA <-  run%>%filter(Teamnum=="A",keep=="Y",  Areax <98.9 & xend > 99, seg == "3" )%>%summarize(count=n())

run45A <- run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, seg == "2"| seg == "0" )%>%summarize(count=n())

RestartA <-  run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, seg == "10" )%>%summarize(count=n())

LostA <-  run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, seg == "7" )%>%summarize(count=n())


tot45A <- bind_cols (total45A,hp45A,KPLA,KPRA,run45A, RestartA, LostA)

library(plyr)

tot45A <- rename(tot45A, c( count = "Total", count1 = "Hp", count2 = "KPL", count3 = "KPR", count4 = "run", count5 = "Restart", count6 = "Lost"))

detach(package:plyr)

formattable (tot45A)
```

###Ballyboden - Game

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99 )

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 1

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y",  Areax <98.9 & xend > 99, period == "1")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 2

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, period == "2")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 3

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, period == "3")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 4

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <98.9 & xend > 99, period == "4")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

##45 Entries
###Eire Og

```{r}
total45B <- run%>%group_by(Team) %>% filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99 )%>%summarize(count=n())

hp45B <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, seg == "1" )%>%summarize(count=n())

KPLB <-  run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, seg == "9" )%>%summarize(count=n())

KPRB <-  run%>%filter(Teamnum=="B",keep=="Y",  Areax <98.9 & xend > 99, seg == "3" )%>%summarize(count=n())

run45B <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, seg == "2"| seg == "0" )%>%summarize(count=n())

RestartB <-  run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, seg == "10" )%>%summarize(count=n())

LostB <-  run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, seg == "7" )%>%summarize(count=n())


tot45B <- bind_cols (total45B,hp45B,KPLB,KPRB,run45B, RestartB, LostB)

library(plyr)

tot45B <- rename(tot45B, c( count = "Total", count1 = "Hp", count2 = "KPL", count3 = "KPR", count4 = "run", count5 = "Restart", count6 = "Lost"))

detach(package:plyr)

formattable (tot45B)
```

###Eire Og - Game

```{r, fig.width = 16, fig.height = 10}



runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99 )


actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Eire Og - Period 1

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, period == "1")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Eire Og- Period 2

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, period == "2")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Eire Og - Period 3

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, period == "3")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Eire Og - Period 4

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <98.9 & xend > 99, period == "4")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

#General
##Kick Outs
###Ballyboden

```{r}

ko <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset=="Ko Rec"| subset =="Ko ToL")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 20, color = "gray10"))
  }

final_data <- ko %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ko <- paste0("Total Kickouts: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Kickout Outcomes", 
          subtitle = total_ko) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 16, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))




```

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 1
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="1")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 2
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="2")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 3

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="3")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 4

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="4")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Kickout Efficiency 
```{r, fig.width = 16, fig.height = 10}
koeffA <- koeff %>% filter(Teamnum== "A", yes == "2")

sp + geom_text(data= koeffA, aes(x= tx, y= ty, label = Recd),colour = "white", size = 9) +
geom_text(data= koeffA, aes(x= bx, y= by, label = Rec),colour = "white", size = 7)
```

###Kickout Network - Ballyboden
```{r, fig.width = 20, fig.height = 20}

linksABs <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/linkskobodeir.csv", header=TRUE, sep=";")
attach (linksABs)

nodesteamAko <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/nodeskobodeir.csv", header=TRUE, sep=";")
attach (nodesteamAko)

linksAko <- linksABs %>% filter( Teamnum == "A") %>% select(Teamnum,plypass, plyrecs)

linksAko <- rename(count(linksAko, plypass, plyrecs), weight = n)

netAko <- graph_from_data_frame(d=linksAko, vertices=nodesteamAko, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("blue", "blue", "blue", "blue", "blue")
V(netAko)$color <- colrs[V(netAko)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netAko, mode="all")
V(netAko)$size <- deg*2 #size of node 

nodes.coordA <- data.frame(data = nodesteamAko,
    x= Areax,
    y=Areay)

plot(netAko, edge.arrow.size=.4, edge.color="blue",edge.arrow.width=.4,
      edge.width=E(netAko)$weight*5, layout=as.matrix(nodes.coordA[,c("x","y")]), vertex.label.color="black", vertex.label = labkoA, vertex.label.cex = 5)

```

###Kickout Density
```{r, fig.width = 16, fig.height = 10}

komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL")
pal <- c("Ko Rec" = "blue",
"Ko ToL"  = "red")

pals <- c("Ko Rec" = 19,
"Ko ToL"  = 4)

p  +  geom_density_2d(data = komapA, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = komapA, aes(x=Areax, y=Areay, shape= subset,colour = subset),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
 scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal) +
  guides(color = FALSE)
```


###Eire Og

```{r}

ko <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset=="Ko Rec"| subset =="Ko ToL")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 20, color = "gray10"))
  }

final_data <- ko %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ko <- paste0("Total Kickouts: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Kickout Outcomes", 
          subtitle = total_ko) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 16, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))


```

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4)
#Map Team B
komapB <-filter(pass, Teamnum == "B", subset =="Ko Rec"| subset =="Ko ToL")

p + geom_point(data = komapB, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapB, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)
```

###Period 1
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="1")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 2
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="2")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 3

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="3")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 4

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="4")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Kickout Efficiency 

```{r, fig.width = 16, fig.height = 10}
koeffB <- koeff %>% filter(Teamnum== "B", yes == "2")

sp + geom_text(data= koeffB, aes(x= tx, y= ty, label = Recd),colour = "white", size = 9) +
geom_text(data= koeffB, aes(x= bx, y= by, label = Rec),colour = "white", size = 7)
```

###Kickout Network - Eire Og
```{r, fig.width = 20, fig.height = 20}

linksABs <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/linkskobodeir.csv", header=TRUE, sep=";")
attach (linksABs)

nodesteamBko <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/bodeir/nodeskoeirbod.csv", header=TRUE, sep=";")
attach (nodesteamBko)

linksBko <- linksABs %>% filter( Teamnum == "B") %>% select(Teamnum,plypass, plyrecs)

linksBko <- rename(count(linksBko, plypass, plyrecs), weight = n)

netBko <- graph_from_data_frame(d=linksBko, vertices=nodesteamBko, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("red", "red", "red","red","red")
V(netBko)$color <- colrs[V(netBko)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netBko, mode="all")
V(netBko)$size <- deg*2 #size of node 

nodes.coordB <- data.frame(data = nodesteamBko,
    x= Areax,
    y=Areay)

plot(netBko, edge.arrow.size=.4, edge.color="red",edge.arrow.width=.4,
      edge.width=E(netBko)$weight*5, layout=as.matrix(nodes.coordB[,c("x","y")]), vertex.label.color="black",  vertex.label = labkoB, vertex.label.cex = 5)

```

###Kickout Density
```{r, fig.width = 16, fig.height = 10}

komapB <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL")

pal <- c("Ko Rec" = "blue",
"Ko ToL"  = "red")

pals <- c("Ko Rec" = 19,
"Ko ToL"  = 4)

p  +  geom_density_2d(data = komapB, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = komapB, aes(x=Areax, y=Areay, shape= subset,colour = subset),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
 scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal) +
  guides(color = FALSE)
```

##Turn overs/Possession Won
```{r}
paltow <- c("Tack W"="#000000",
"KP Int"="blue",
"HP Int"="purple",
"Kp Brk Int"="#FF6347",
"Hp Brk Int"="#0000FF",
"Kp Free Int"="#FFFF00",
"Fk Brk Int"="#00FFFF",
"Mk Kp Int"="#FF00FF",
"Sl Int"="darkblue",
"Short Def"=" black",
"Ko Int"="#800000",
"KoBrk Int"="#808000",
"Ko Int Mk"="#D2691E",
"Fk Short Gk"="#800080",
"Short Gk"="#008080",
"Loose TBW"="#000080",
"Free Won Def"="gold",
"Sl Kp Won To"="darkred",
"Rebnd Def"="#808080",
"Loss BW"="#000000",
"Brk Won"="#FF0000",
"Loose RBW"="#800000",
"Ko Fk Won Def" = "lightblue")

```

###Ballyboden

```{r}

ToWA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="PW")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ToWA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ToWA <- paste0("Total Possession Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Possession Won",  # Add the title and subtitle
          subtitle = total_ToWA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
conqmapA <- filter(pass, Teamnum == "A", main =="PW")


p + geom_point(data = conqmapA, aes(x=Areax, y=Areay, colour = Action, shape = main), size = 6)+
geom_text_repel(data = conqmapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(legend.position="none") + scale_colour_manual(
    values = paltow)

```

###Eire Og

```{r}

ToWA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", main =="PW")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ToWA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ToWA <- paste0("Total Possession Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Possession Won",  # Add the title and subtitle
          subtitle = total_ToWA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
conqmapB <-filter(pass, Teamnum == "B", main =="PW")


p + geom_point(data = conqmapB, aes(x=Areax, y=Areay, colour = Action, shape = Team ), size = 6)+
geom_text_repel(data = conqmapB, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(legend.position="none")+ scale_colour_manual(
    values = paltow)

  
```

##Passes per Defensive Action
###Ballyboden

```{r}

Adef <- pass %>%group_by(Team)%>%filter(Teamnum == "A")  %>%summarize(Def = sum(main == "Def Act"),Tack = sum(Action == "Tack Def"),Spoil = sum(subset == "Spoil Def"))

Bpass <- pass %>%group_by(Team)%>%filter(Teamnum == "B") %>%summarize(Pass =sum(main == "Pass Op"))

BA <- bind_cols(Bpass,Adef)


BAdefact <- BA %>% summarize (Pass, Def, PPDA = (Pass/Def))

formattable (BAdefact)

```


###Eire Og
```{r}

Bdef <- pass %>%group_by(Team)%>%filter(Teamnum == "B")  %>%summarize(Def = sum(main == "Def Act"),Tack = sum(Action == "Tack Def"),Spoil = sum(subset == "Spoil Def"))

Apass <- pass %>%group_by(Team)%>%filter(Teamnum == "A") %>%summarize(Pass =sum(main == "Pass Op"))

AB <- bind_cols(Apass,Bdef)

ABdefact <- AB %>% summarize (Pass, Def, PPDA = (Pass/Def))

formattable (ABdefact)

```


##Tackle Attempts and Defensive Actions
###Ballyboden

```{r, fig.width = 16, fig.height = 10}

defactA <- pass %>%filter(Teamnum == "A",subset == "Tack Def"|subset=="Spoil Def")

p + geom_point(data = defactA, aes(x = Areax, y = Areay, colour = subset), size = 7) + theme(legend.position="bottom") 

```

##Tackle Attempts and Defensive Actions
###Eire Og

```{r, fig.width = 16, fig.height = 10}

defactB <- pass %>%filter(Teamnum == "B",subset == "Tack Def"|subset=="Spoil Def")

p + geom_point(data = defactB, aes(x = Areax, y = Areay, colour = subset), size = 7) + 
  theme(legend.position="bottom") 


```


##Time to First Tackle Attempt After Possession Won
###Ballyboden

```{r, fig.width = 16, fig.height = 10}

tackA <- tack%>%filter(Teamnum == "A",main == "PW")

p + geom_segment(data = tackA, aes(x = Areax, y = Areay, xend = Areaxoc, yend = Areayoc),size = .5,arrow = arrow()) +
    geom_point(data = tackA, aes(x = Areax, y = Areay), size = 7,colour = "white") +
    geom_point(data = tackA, aes(x = Areaxoc, y = Areayoc), size = 7,colour = "blue") +
    geom_text(data = tackA, aes(x = Areax, y = Areay,label = possno), size = 4,colour = "blue") +
    geom_text(data = tackA, aes(x = Areaxoc, y = Areayoc,label = possno), size = 4,colour = "white") +
    geom_text_repel(data = tackA, aes(x = Areaxoc, y = Areayoc,label = timedif), size = 5,colour = "blue") 

```

##Time to First Tackle Attempt After Possession Won
###Eire Og

```{r, fig.width = 16, fig.height = 10}
tackB <- tack%>%filter(Teamnum == "B",main == "PW")

p + geom_segment(data = tackB, aes(x = Areax, y = Areay, xend = Areaxoc, yend = Areayoc),size = .5,arrow = arrow()) +
    geom_point(data = tackB, aes(x = Areax, y = Areay), size = 7,colour = "white") +
    geom_point(data = tackB, aes(x = Areaxoc, y = Areayoc), size = 7,colour = "blue") +
    geom_text(data = tackB, aes(x = Areax, y = Areay,label = possno), size = 4,colour = "blue") +
    geom_text(data = tackB, aes(x = Areaxoc, y = Areayoc,label = possno), size = 4,colour = "white") +
    geom_text_repel(data = tackB, aes(x = Areaxoc, y = Areayoc,label = timedif), size = 5,colour = "blue") 

```



##Frees Won
###Ballyboden

```{r}

FKA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKA <- paste0("Total Fk Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Won",  # Add the title and subtitle
          subtitle = total_FKA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}

freeAmap <- filter(pass, Teamnum == "A", subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")

p + geom_point(data = freeAmap, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6)) +
geom_text_repel(data = freeAmap, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="bottom")
```

###Eire Og

```{r}

FKB <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKB %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKB <- paste0("Total Fk Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Won",  # Add the title and subtitle
          subtitle = total_FKB) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}

#Map Team B

freeBmap <-filter(pass, Teamnum == "B",subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")

p + geom_point(data = freeBmap, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6)) +
geom_text_repel(data = freeBmap, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="bottom")
```

##Frees Loss
###Ballyboden

```{r}

FKLA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A",  subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKLA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKLA  <- paste0("Total Fk Loss: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Loss",  # Add the title and subtitle
          subtitle = total_FKLA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
#Map Team A

freeAmap <- filter(pass, Teamnum == "A", subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")

p + geom_point(data = freeAmap, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6)) +
geom_text_repel(data = freeAmap, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="bottom")
```

###Eire Og

```{r}

FKLB <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKLB %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKLB <- paste0("Total Fk Loss: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Loss",  # Add the title and subtitle
          subtitle = total_FKLB) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}

freeBmap <-filter(pass, Teamnum == "B", subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")

p + geom_point(data = freeBmap, aes(x=Areax, y=Areay, colour = subset, shape = subset, size = 6)) +
geom_text_repel(data = freeBmap, aes(x=Areax, y=Areay, label = plylab, col = subset), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="bottom")
```


```{r}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))

kable (attstats)%>% kable_styling(bootstrap_options=c("striped",full_width = F))%>%column_spec(1,bold = T)%>%add_header_above(c(" "= 1, "Ballyboden" = 2, "Eire Og" = 2))

```

```{r}
formattable(attstats)
```

