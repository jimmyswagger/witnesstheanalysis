---
title: "Ballymun vs Crokes Networks"
output:
  html_document:
    theme: cosmo
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))
#Load packages
library(flexdashboard)
library(dplyr)
library(deldir)
library(ggplot2)
library(ggrepel)
library(ggpubr)
library(knitr)
library(rmarkdown)
library(kableExtra)
library(data.table)
library(RColorBrewer)
library(gridExtra)
library(igraph)
library(tidyverse)
library(treemap)
library(plotly)
library(networkD3)
library (curl)
library(formattable)
library(yaml)
```

#Shot Network
##Ballymun
```{r, fig.width = 20, fig.height = 20}

linksABps <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/muncrk/passshotmuncrk.csv", header=TRUE, sep=";")
attach (linksABps)

nodesteamAps <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/muncrk/nodesshotmuncrk.csv", header=TRUE, sep=";")
attach (nodesteamAps)

nodesteamBps <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/muncrk/nodesshotcrkmun.csv", header=TRUE, sep=";")
attach (nodesteamBps)

linksAps <- linksABps %>% filter( Teamnum == "A") %>% select(Teamnum,plypass, plyrec)

linksAps <- rename(count(linksAps, plypass, plyrec), weight = n)

netAps <- graph_from_data_frame(d=linksAps, vertices=nodesteamAps, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("red", "red", "red", "red", "red")
V(netAps)$color <- colrs[V(netAps)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netAps, mode="all")
V(netAps)$size <- deg*2 #size of node 

nodes.coordA <- data.frame(data = nodesteamAps,
    x= Areax,
    y=Areay)

plot(netAps, edge.arrow.size=.4, edge.color="lightgreen",edge.arrow.width=.4,
      edge.width=E(netAps)$weight*5, layout=as.matrix(nodes.coordA[,c("x","y")]), vertex.label.color="lightgreen", vertex.label = labelAsh, vertex.label.cex = 5)

```


###In Degree (Number of Players a Player Received a Pass from)
```{r}
-sort(-degree(netAps, mode="in"))
```

###Out Degree (Number of Players a Player Made a Pass to)
```{r}
-sort(-degree(netAps, mode="out"))
```

###Strength in (Number of Passes Received by a Player)
```{r}
-sort(-strength(netAps, mode="in"))
```

###Strength Out (Number of Passes/Shots Made by a Player)
```{r}
-sort(-strength(netAps, mode="out"))
```

###Betweenness Centrality (Flow of Passes through a Player)
```{r}
-sort(-betweenness(netAps, directed=F, weights=NA, normalized = T))
```

###Closeness Centrality (How Well connected and central a Player is within the Teams Network)
```{r}
-sort(-closeness(netAps, mode="all", weights=NA, normalized=T))
```

###Entropy (The Unpredictability in who a Player Passes to/Takes shot)
```{r}
diversity(netAps)
```

###Global clustering coefficient (Groups of Players who pass to each other)
```{r}
transitivity(netAps)
```
###eigen_centrality (How well connected the well connected are)
```{r}
-sort(-eigen_centrality(netAps)$vector)
```


#Shot Network - Crokes
```{r, fig.width = 20, fig.height = 20}

linksABps <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/muncrk/passshotmuncrk.csv", header=TRUE, sep=";")
attach (linksABps)

nodesteamBps <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/muncrk/nodesshotcrkmun.csv", header=TRUE, sep=";")
attach (nodesteamBps)

linksBps <- linksABps %>% filter( Teamnum == "B") %>% select(Teamnum,plypass, plyrec)

linksBps <- rename(count(linksBps, plypass, plyrec), weight = n)

netBps <- graph_from_data_frame(d=linksBps, vertices=nodesteamBps, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("purple", "gold", "gold","gold","gold")
V(netBps)$color <- colrs[V(netBps)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netBps, mode="all")
V(netBps)$size <- deg*2 #size of node 

nodes.coordB <- data.frame(data = nodesteamBps,
    x= Areax,
    y=Areay)

plot(netBps, edge.arrow.size=.4, edge.color="gold",edge.arrow.width=.4,
      edge.width=E(netBps)$weight*5, layout=as.matrix(nodes.coordB[,c("x","y")]), vertex.label.color="gold",  vertex.label = labelBsh, vertex.label.cex = 5)

```


###In Degree
```{r}
-sort(-degree(netBps, mode="in"))
```

###Out Degree
```{r}
-sort(-degree(netBps, mode="out"))
```

###Strength in
```{r}
-sort(-strength(netBps, mode="in"))
```

###Strength Out
```{r}
-sort(-strength(netBps, mode="out"))
```
###Betweenness Centrality
```{r}
-sort(-betweenness(netBps, directed=F, weights=NA, normalized = T))
```

###Closeness Centrality
```{r}
-sort(-closeness(netBps, mode="all", weights=NA, normalized=T))
```

###Entropy
```{r}
diversity(netBps)
```

###Global clustering coefficient
```{r}
transitivity(netBps)
```
###eigen_centrality
```{r}
-sort(-eigen_centrality(netBps)$vector)
```




