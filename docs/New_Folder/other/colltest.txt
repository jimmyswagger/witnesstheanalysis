---
title: "coltest"
author: "JSwag"
date: "19 April 2019"
output: html_document
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))
#Load packages
library(flexdashboard)
library(dplyr)
library(deldir)
library(ggplot2)
library(ggrepel)
library(ggpubr)
library(knitr)
library(rmarkdown)
library(kableExtra)
library(data.table)
library(RColorBrewer)
library(gridExtra)
library(igraph)
library(tidyverse)
library(treemap)
library(plotly)
library(networkD3)
library (curl)
library(formattable)
library(grid)
library(yaml)
```

```{r}

pass <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/gamelogmayker.csv", header=TRUE, sep=";")
attach (pass)

glmayker <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/glfour.csv", header=TRUE, sep=";")
attach (glmayker)

glmaykernine <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/glnine.csv", header=TRUE, sep=";")
attach (glmaykernine)

position  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/positionmayker.csv", header=TRUE, sep=";")
attach (position)

scorelist  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/scorelistmayker.csv", header=TRUE, sep=";")
attach (scorelist)

summary  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/summarymayker.csv", header=TRUE, sep=";")
attach (summary)

scores  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/scoresmayker.csv", header=TRUE, sep=";")
attach (scores)

scrd  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/scrdmayker.csv", header=TRUE, sep=";")
attach (scrd)

scrdnine  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/scrdnine.csv", header=TRUE, sep=";")
attach (scrdnine)

scrdten <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/scrdten.csv", header=TRUE, sep=";")
attach (scrdten)

passtofrom  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/passtofrommayker.csv", header=TRUE, sep=";")
attach (passtofrom)

passmap  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/passmapmayker.csv", header=TRUE, sep=";")
attach (passmap)

plytree  <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/plytreemayker.csv", header=TRUE, sep=";")
attach (plytree)

plystats <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/plystatsmayker.csv", header=TRUE, sep=";")
attach (plystats)

shots <- read.csv(file="c:/Users/donag/OneDrive/Spreadsheet fun/PA Analytics/PA Template/mayker/shotsmayker.csv", header=TRUE, sep=";")
attach (shots)


```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  def14 <- 1.25
  def21 <- 1.5
  def45 <- 2.5
  def65 <- 3.5
  off65 <- 4.5
  off45 <- 5.5
  off21 <- 6.5
  off14 <- 6.75
  offel <- 7.5
  
  
  
  # Defining features along the width
  srwing <- 1.5
  frightwing <- 5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    wp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "black",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "black",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "black",linetype="solid") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "black",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "black",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_rect(aes(xmin=boxEdgeOff, xmax=xmax, ymin=boxEdgeLeft, ymax=boxEdgeRight), colour = "black", fill = grass_colour) + 
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "black") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "black", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "white") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="white") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") 
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    wp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(wp)}


wp <- create_Stats_Pitch("#ffffff", "#A9A9A9", "#ffffff", "#000000", BasicFeatures=TRUE)


```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 3.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 5.5 # maximum length
  
  # Defining features along the length
  srwing <- 1.5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  sixYardLeft <- 2.75
  sixYardRight <- 3.25
  
  # Defining features along the width
  
  off14 <- 2.7
  off21 <- 2.5
  off45 <- 1.5
  left14 <- 2.65
  right14 <- 3.35
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    qp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = xmin, y = off21, xend = xmax, yend = off21),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = off45, xend = xmax, yend = off45),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = off14, xend = xmax, yend = off14),colour = "white",linetype="solid") +
      geom_segment(aes(x = srwing, y = ymin, xend = srwing, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = rhalfsp, y = ymin, xend = rhalfsp, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = ctre, y = ymin, xend = ctre, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = lhspce, y = ymin, xend = lhspce, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = left14, y = ymax, xend = left14, yend = 2.7),colour = "white" ,linetype="solid") + 
      geom_segment(aes(x = right14, y = ymax, xend = right14, yend = 2.7),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = sixYardLeft, y = ymax, xend = sixYardLeft, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = sixYardRight, y = ymax, xend = sixYardRight, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = 2.75, y = 3.25, xend = 3.25, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x =2.8, y = 3.5, xend = 3.20, yend = 3.5),colour = "black", size = 2) +
      annotate(geom="text", x=0.57, y=1.45, label="45", color="white") +
      annotate(geom="text", x=0.57, y=2.45, label="21",color = "white") 
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    qp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(qp)}


qp <- create_Stats_Pitch("#A2CD5A", "#6495ED", "#ffffff", "#000000", BasicFeatures=TRUE)
```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  def14 <- 1.25
  def21 <- 1.5
  def45 <- 2.5
  def65 <- 3.5
  off65 <- 4.5
  off45 <- 5.5
  off21 <- 6.5
  off14 <- 6.75
  offel <- 7.5
  
  
  
  # Defining features along the width
  srwing <- 1.5
  frightwing <- 5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    p <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "white",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "blue",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_rect(aes(xmin=boxEdgeOff, xmax=xmax, ymin=boxEdgeLeft, ymax=boxEdgeRight), colour = "white", fill = grass_colour) + 
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "white") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "black", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "blue") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="black") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") +
      annotate("segment", x = 3.5, xend = 4.5, y = 0.75, yend = 0.75, colour = "pink", size=3, alpha=0.6, arrow=arrow())
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    p <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(p)}


p <- create_Stats_Pitch("#A2CD5A", "#6495ED", "#ffffff", "#000000", BasicFeatures=TRUE)

```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  defe1 <- 1
  def14 <- 1.25
  def21 <- 1.5
  defe2 <- 2
  def45 <- 2.5
  defe3 <- 3
  def65 <- 3.5
  defe4 <- 4
  off65 <- 4.5
  defe5 <- 5
  off45 <- 5.5
  defe6 <- 6
  off21 <- 6.5
  off14 <- 6.75
  defe7 <- 7
  offel <- 7.5
  
  
  
  # Defining features along the width
  ctre1 <- 1
  srwing <- 1.5
  ctre2 <- 2
  rhalfsp <- 2.5
  ctre3 <- 3
  ctre <- 3.5
  ctre4 <- 4
  lhspce <- 4.5
  ctre5 <- 5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  right14o <- 2.6
  left14o <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    sp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "white",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "blue",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "red",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "white",linetype="solid") + 
        geom_segment(aes(x = defe1, y = ymin, xend = defe1, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe2, y = ymin, xend = defe2, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe3, y = ymin, xend = defe3, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe4, y = ymin, xend = defe4, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe5, y = ymin, xend = defe5, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe6, y = ymin, xend = defe6, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe7, y = ymin, xend = defe7, yend = ymax),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = left14o, xend = xmax, yend = left14o),colour = "white",linetype="solid") +	
      geom_segment(aes(x = off14, y = right14o, xend = xmax, yend = right14o),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = ctre1, xend = xmax, yend = ctre1),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre2, xend = xmax, yend = ctre2),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre3, xend = xmax, yend = ctre3),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre4, xend = xmax, yend = ctre4),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre5, xend = xmax, yend = ctre5),colour = line_colour,linetype="dotted") +
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "white") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "red", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "blue") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="red") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") + 
      annotate("segment", x = 3.6, xend = 4.4, y = 0.65, yend = 0.65, colour = "pink", size=3, alpha=0.6, arrow=arrow())
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    sp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(sp)}


sp <- create_Stats_Pitch("#A2CD5A", "black", "#ffffff", "#000000", BasicFeatures=TRUE)

```


#All Shots Origin by Possession

```{r}
scrdAA <- scrdnine %>% filter(Teamnum == "A")%>%select(Colour,Seconds,Shot,Score)
kable (scrdAA) %>% kable_styling()
```

```{r}
scrdAAA <- scrdnine %>% filter(Teamnum2 == "A")%>%select(PitchArea,count)
kable (scrdAAA) %>% kable_styling()
```


##Mayo (Blue = Score)
```{r, fig.width = 16, fig.height = 10}
TeamAPAScr <- glmaykernine %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Goal"|Action== "Point"|Action== "Fk Goal"|
Action== "Fk Point"|Action== "Mk Goal"|Action== "Mk Point"|Action== "45 goal"|Action== "45 Point")

TeamAPAScr <- glmaykernine %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Goal"|Action== "Point"|Action== "Fk Goal"|
Action== "Fk Point"|Action== "Mk Goal"|Action== "Mk Point"|Action== "45 goal"|Action== "45 Point")

TeamAPAMis <- glmaykernine %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Wide Left"|Action== "Wide Right"|Action== "Save"|Action== "Shot Blk"|Action== "Short"|Action== "Fk Short"|Action== "Fk Wide Left"|Action== "Fk Wide Right"|
Action== "Fk Save"|Action== "Mk Short"|Action== "Mk Wide Left"|Action== "Mk Wide Right"|Action== "Mk Save"|Action== "Mk Pass")

#Pulls out all shots from main TeamA
TeamAPASc <- subset(glmaykernine, possno %in% TeamAPAScr$possno)

TeamAPAMi <- subset(glmaykernine, possno %in% TeamAPAMis$possno)

#Ones that start from turnover
TeamAphasePASccq <- TeamAPASc %>% filter(main == "PW")

TeamAphasePAMicq <- TeamAPAMi %>% filter(main == "PW")

#Ones that start from kickout

TeamAphasePAScko <- TeamAPASc %>% filter(main == "Ko Rec")

TeamAphasePAMiko <- TeamAPAMi %>% filter(main == "Ko Rec")


A1 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A1") 
A2 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A2") 
A3 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A3") 
A4 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A4") 
A5 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A5") 
A6 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A6") 
A7 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A7") 
A8 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A8") 
A9 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A9") 
A10 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A10") 
A11 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A11") 
A12 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A12") 
A13 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A13") 
A14 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A14") 
A15 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A15") 
A16 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A16") 
A17 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A17") 
A18 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A18") 
A19 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A19") 
A20 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A20") 
A21 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A21") 
A22 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A22") 
A23 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A23") 
A24 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A24") 
A25 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A25") 
A26 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A26") 
A27 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A27") 
A28 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A28") 
A29 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A29") 
A30 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A30") 
A31 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A31") 
A32 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A32") 
A33 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A33") 
A34 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A34") 
A35 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A35") 
A36 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A36") 
A37 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A37") 
A38 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A38") 
A39 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A39") 
A40 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A40") 
A41 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A41") 
A42 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A42") 
A43 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A43") 
A44 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A44") 
A45 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A45") 
A46 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A46") 
A47 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A47") 
A48 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A48")
A49 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A49")
A50 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A50")
A51 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A51")
A52 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A52")
A53 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A53")
A54 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A54")
A55 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A55")
A56 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A56")
A57 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A57")
A58 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A58")
A59 <- glmaykernine %>% filter(Teamnum == "A" & possno == "A59")


p + geom_path(data = A1, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A2, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A3, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A4, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A5, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A6, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A7, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A8, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A9, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A10, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A11, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A12, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A13, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A14, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A15, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A16, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A17, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A18, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A19, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A20, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A21, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A22, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A23, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A24, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A25, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A26, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A27, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A28, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A29, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A30, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A31, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A32, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A33, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A34, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A35, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A36, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A37, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A38, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A39, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A40, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A41, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A42, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A43, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A44, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A45, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A46, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A47, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = A48, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = A49, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = A50, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = A51, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +   
geom_path(data = A52, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A53, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A54, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A55, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A56, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = A57, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = A58, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = A59, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data =A24, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A33, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A34, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A35, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A46, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A48, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A59, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =A4, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A5, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A7, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A21, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A27, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A30, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A36, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A37, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A37, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A38, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A40, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A49, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A58, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =A22, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =A33, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =A42, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =A56, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =A57, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =A2, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =A23, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =A31, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =A51, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =A1, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "darkred") + 
geom_path(data =A15, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "darkred") + 
geom_path(data =A3, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "orange") + 
geom_path(data =A8, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "orange") + 
geom_path(data =A13, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "white") + 
geom_path(data =A53, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "white") + 
geom_path(data =A25, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "pink")  +
geom_point(data = TeamAphasePASccq , aes(x=Areax, y=Areay), colour = "blue", size = 3, shape = 19) +
geom_point(data = TeamAphasePAMicq, aes(x=Areax, y=Areay), colour = "white", size = 3,shape = 19) +
geom_point(data = TeamAphasePAScko, aes(x=Areax, y=Areay), colour = "blue", size = 3, shape = 19) +
geom_point(data = TeamAphasePAMiko, aes(x=Areax, y=Areay), colour = "white", size = 3,shape = 19)

```

#All Shots Origin by Possession
##Mayo (Blue = Score)

```{r}
scrdBB <- scrdnine %>% filter(Teamnum == "B")%>%select(Colour,Seconds,Shot,Score)
kable (scrdBB) %>% kable_styling()
```


```{r}
scrdBBB <- scrdnine %>% filter(Teamnum2 == "B")%>%select(PitchArea,count)
kable (scrdBBB) %>% kable_styling()
```


```{r, fig.width = 16, fig.height = 10}

TeamBPAScr <- glmaykernine %>%group_by(Team, Action) %>% filter(Teamnum == "B", Action== "Goal"|Action== "Point"|Action== "Fk Goal"|
Action== "Fk Point"|Action== "Mk Goal"|Action== "Mk Point"|Action== "45 goal"|Action== "45 Point")

TeamBPAMis <- glmaykernine %>%group_by(Team, Action) %>% filter(Teamnum == "B", Action== "Wide Left"|Action== "Wide Right"|Action== "Save"|Action== "Shot Blk"|
Action== "Short"|Action== "Fk Short"|Action== "Fk Wide Left"|Action== "Fk Wide Right"|
Action== "Fk Save"|Action== "Mk Short"|Action== "Mk Wide Left"|Action== "Mk Wide Right"|Action== "Mk Save"|Action== "Mk Pass")

#Pulls out all shots from main TeamB
TeamBPASc <- subset(glmaykernine, possno %in% TeamBPAScr$possno)

TeamBPAMi <- subset(glmaykernine, possno %in% TeamBPAMis$possno)

#Ones that start from turnover
TeamBphasePASccq <- TeamBPASc %>% filter(main == "PW")

TeamBphasePAMicq <- TeamBPAMi %>% filter(main == "PW")

#Ones that start from kickout

TeamBphasePAScko <- TeamBPASc %>% filter(main =="Ko Rec")

TeamBphasePAMiko <- TeamBPAMi %>% filter(main =="Ko Rec")


B1 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B1") 
B2 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B2") 
B3 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B3") 
B4 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B4") 
B5 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B5") 
B6 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B6") 
B7 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B7") 
B8 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B8") 
B9 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B9") 
B10 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B10") 
B11 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B11") 
B12 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B12") 
B13 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B13") 
B14 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B14") 
B15 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B15") 
B16 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B16") 
B17 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B17") 
B18 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B18") 
B19 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B19") 
B20 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B20") 
B21 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B21") 
B22 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B22") 
B23 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B23") 
B24 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B24") 
B25 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B25") 
B26 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B26") 
B27 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B27") 
B28 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B28") 
B29 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B29") 
B30 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B30") 
B31 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B31") 
B32 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B32") 
B33 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B33") 
B34 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B34") 
B35 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B35") 
B36 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B36") 
B37 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B37") 
B38 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B38") 
B39 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B39") 
B40 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B40") 
B41 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B41") 
B42 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B42") 
B43 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B43") 
B44 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B44") 
B45 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B45") 
B46 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B46") 
B47 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B47") 
B48 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B48") 
B49 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B49") 
B50 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B50")
B51 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B51")
B52 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B52")
B53 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B53")
B54 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B54")
B55 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B55")
B56 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B56")
B57 <- glmaykernine %>% filter(Teamnum == "B" & possno == "B57")


p + geom_path(data = B1, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B2, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B3, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B4, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B5, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B6, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B7, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B8, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B9, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B10, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B11, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B12, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B13, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B14, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B15, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B16, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B17, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B18, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B19, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B20, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B21, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B22, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B23, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B24, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B25, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B26, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B27, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B28, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B29, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B30, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B31, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B32, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B33, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B34, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B35, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B36, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B37, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B38, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B39, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B40, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B41, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B42, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B43, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B44, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B45, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B46, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B47, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B48, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data = B49, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B50, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B51, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +  
geom_path(data = B52, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B53, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B54, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B55, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B56, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") +
geom_path(data = B57, aes(x=Areax, y=Areay), size = 0.4, linetype="dotted", colour = "black") + 
geom_path(data =B8, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =B14, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "blue") + 
geom_path(data =B1, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =B18, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =B21, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =B36, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =B40, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "red") + 
geom_path(data =B5, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =B12, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =B13, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =B19, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =B38, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =B55, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "purple") + 
geom_path(data =B25, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =B42, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =B56, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "yellow") + 
geom_path(data =B2, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "darkred") + 
geom_path(data =B27, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "darkred") + 
geom_path(data =B39, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "darkred") + 
geom_path(data =B51, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "darkred") + 
geom_path(data =B54, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "orange") + 
geom_path(data =B50, aes(x=Areax, y=Areay), size = 0.6, linetype="solid", colour = "white") +
geom_point(data = TeamBphasePASccq , aes(x=Areax, y=Areay), colour = "blue", size = 3, shape = 19) +
geom_point(data = TeamBphasePAMicq, aes(x=Areax, y=Areay), colour = "white", size = 3,shape = 19) +
geom_point(data = TeamBphasePAScko, aes(x=Areax, y=Areay), colour = "blue", size = 3, shape = 19) +
geom_point(data = TeamBphasePAMiko, aes(x=Areax, y=Areay), colour = "white", size = 3,shape = 19)
```

```{r}
my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 30, color = "gray10"),
          plot.title =  element_text( size = 40,color = "red"))
}

scrdtenA <- scrdten%>%filter(Teamnum=="A")
ggplot(scrdtenA, aes(x = Player, y = Pscrcount)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 1) +  
geom_text(aes(label =ply, hjust = 1, angle = 90), size = 8,colour ="black") +
  my_theme() +
theme(legend.position="none")
```




#Open Play Shot Origin by Phase
##Mayo (Blue = Score)
```{r, fig.width = 16, fig.height = 10}
#change from shot to coutcomes
TeamAPhScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Goal"|Action== "Point")

TeamAPhAMis <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Wide Left"|Action== "Wide Right"|Action== "Save"|Action== "Shot Blk"|
Action== "Short")

#Pulls out all shots from main TeamB
TeamAPhASc <- subset(pass, Phase %in% TeamAPhScr$Phase)

TeamAPhAMi <- subset(pass, Phase %in% TeamAPhAMis$Phase)

#Score
TeamAphasecq <- TeamAPhASc %>% filter(main == "ToW"|Action=="Rebnd Off")

TeamAphaseRs <- TeamAPhASc%>% filter(Action=="Sl Pass"|Action == "Fk Pass"|Action == "Mk Kp"|Action =="Mk Hp")

TeamAphaseko <- TeamAPhASc %>% filter(main =="Ko Rec")

#Add in Miss
TeamAphasecqMi <- TeamAPhAMi %>% filter(main == "ToW"|Action=="Rebnd Off")

TeamAphaseRsMi <- TeamAPhAMi%>% filter(Action=="Sl Pass"|Action == "Fk Pass"|Action == "Mk Kp"|Action =="Mk Hp")

TeamAphasekoMi <- TeamAPhAMi %>% filter(main =="Ko Rec")

#Add in Miss

p + geom_point(data = TeamAphasecq, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphaseRs, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphaseko, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
  geom_point(data = TeamAphasecqMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamAphaseRsMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamAphasekoMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_text_repel(data = TeamAphasecq, aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) +
geom_text_repel(data = TeamAphaseRs, aes(x=Areax, y=Areay, label = plylab), col = "blue", size = 8) +
geom_text_repel(data = TeamAphaseko, aes(x=Areax, y=Areay, label = plylab), col = "blue", size = 8) +
  geom_text_repel(data = TeamAphasecqMi, aes(x=Areax, y=Areay, label = plylab), colour = "white", size = 8) +
geom_text_repel(data = TeamAphaseRsMi, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) +
geom_text_repel(data = TeamAphasekoMi, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8)
```


#Open Play Shots - Location & Outcome 
```{r, include=FALSE, message=FALSE, warning=FALSE}
colshotvertpal <- c(
"Goal"= "white",
"Point"= "black",
"Wide Left"="purple",
"Wide Right"="#FF6347",
"Save"="#FFFF00",
"Blkd"="#00FFFF",
"Short"="#FF00FF",
"Post"="darkblue",
"Fk Goal"= "#FFFFFF",
"Fk Point"="#800000",
"Fk Wide Left"="#808000",
"Fk Wide Right"="#D2691E",
"Fk Save"="#800080",
"Fk Short"="#008080",
"Fk Post"="#000080",
"45 Goal"="#FFFFFF",
"45 Point"="darkred",
"45 Wide Left"="#808080",
"45 Wide Right"="#000000",
"45 Save"="#FF0000",
"45 Short"="#800000",
"45 Post"="yellow",
"Pen Goal" ="#619CFF",
"Pen Point"="#00BA38",
"Pen Wide Left"="#F8766D",
"Pen Wide Right"="#FF9326",
"Pen Save"="#FFFF4D",
"Pen Post"="#21D921",
"Mk Goal"="#D92121",
"Mk Point"="blue",
"Mk Wide Left"="gold",
"Mk Wide Right"="orange",
"Mk Short"="red",
"Mk Save"="#2121D9")

```

##Mayo

```{r}

OPA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="Shot Oc")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- OPA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_OPA <- paste0("Total Op Shots: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Open Play Shots",  # Add the title and subtitle
          subtitle = total_OPA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 14}
shotsA <- scrd  %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action=="Shot Right"| Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch")

p + geom_point(data = shotsA, aes(x=Areax, y=Areay, colour = octype, size = 8, shape = Action, stroke = 1.5)) + 
 scale_colour_manual(values = colshotvertpal) +
  geom_text_repel(data = shotsA, aes(x=Areax, y=Areay, label = plylabrec, col = octype), size = 8) +
    scale_shape_manual(values = 0:18) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12)))
```


#All Shots - Location & Outcome 
##Mayo
```{r,  out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}

ASA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="Shot Oc"| main == "Shot Oc Rs")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ASA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ASA <- paste0("All Shots: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("All Shots",  # Add the title and subtitle
          subtitle = total_ASA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))




```

```{r}
shotsA <- scrd %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action=="Shot Right"| Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch"|Action =="Fk Shot Right"| Action =="Fk Shot Left"
|Action=="Mk Shot Right"| Action =="Mk Shot Left"|Action =="45 Shot Right"| Action =="45 Shot Left")

p + geom_point(data = shotsA, aes(x=Areax, y=Areay, colour = octype, size = 8, shape = Action, stroke = 1.5)) + 
   scale_colour_manual(values = colshotvertpal) +
  geom_text_repel(data = shotsA, aes(x=Areax, y=Areay, label = plylabrec, col = octype), size = 8) +
    scale_shape_manual(values = 0:18) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12)))
```


##Score %
```{r, fig.width = 16, fig.height = 14}

shotsA <- shots %>% filter(Teamnum== "A", yes == "2")

sp + geom_text(data= shotsA, aes(x= tx, y= ty, label = Scrd),colour = "blue", size = 6) +
geom_text(data= shotsA, aes(x= bx, y= by, label = Scr),colour = "blue", size = 5.5)

shotsB <- shots %>% filter(Teamnum== "B", yes == "2")

sp + geom_text(data= shotsB, aes(x= tx, y= ty, label = Scrd),colour = "blue", size = 6) +
geom_text(data= shotsB, aes(x= bx, y= by, label = Scr),colour = "blue", size = 5.5)
```

#All Shots Origin by Possession
##Mayo (Blue = Score)
```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Goal"|Action== "Point"|Action== "Fk Goal"|
Action== "Fk Point"|Action== "Mk Goal"|Action== "Mk Point"|Action== "45 goal"|Action== "45 Point")

TeamAPAScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Goal"|Action== "Point"|Action== "Fk Goal"|
Action== "Fk Point"|Action== "Mk Goal"|Action== "Mk Point"|Action== "45 goal"|Action== "45 Point")

TeamAPAMis <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Wide Left"|Action== "Wide Right"|Action== "Save"|Action== "Shot Blk"|Action== "Short"|Action== "Fk Short"|Action== "Fk Wide Left"|Action== "Fk Wide Right"|
Action== "Fk Save"|Action== "Mk Short"|Action== "Mk Wide Left"|Action== "Mk Wide Right"|Action== "Mk Save"|Action== "Mk Pass")

#Pulls out all shots from main TeamA
TeamAPASc <- subset(pass, possno %in% TeamAPAScr$possno)

TeamAPAMi <- subset(pass, possno %in% TeamAPAMis$possno)

#Ones that start from turnover
TeamAphasePASccq <- TeamAPASc %>% filter(main == "ToW"|Action=="Rebnd Off")

TeamAphasePAMicq <- TeamAPAMi %>% filter(main == "ToW"|Action=="Rebnd Off")

#Ones that start from kickout

TeamAphasePAScko <- TeamAPASc %>% filter(main == "Ko Rec")

TeamAphasePAMiko <- TeamAPAMi %>% filter(main == "Ko Rec")

p + geom_point(data = TeamAphasePASccq , aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphasePAMicq, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamAphasePAScko, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphasePAMiko, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
theme(legend.position = "bottom") + 
geom_text_repel(data = TeamAphasePASccq , aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) +
geom_text_repel(data = TeamAphasePAMicq, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) +
geom_text_repel(data = TeamAphasePAScko, aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) + 
geom_text_repel(data = TeamAphasePAMiko, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) 


```

#Turn overs/Possession Won
```{r}
paltow <- c("Tack W"="#000000",
"KP Int"="#FFFFFF",
"HP Int"="purple",
"Kp Brk Int"="#FF6347",
"Hp Brk Int"="#0000FF",
"Kp Free Int"="#FFFF00",
"Fk Brk Int"="#00FFFF",
"Mk Kp Int"="#FF00FF",
"Sl Int"="darkblue",
"Sl Brk Int"=" black",
"Ko Int"="#800000",
"KoBrk Int"="#808000",
"Ko Int Mk"="#D2691E",
"Fk Short Gk"="#800080",
"Short Gk"="#008080",
"Loose TBW"="#000080",
"Free Won Def"="#FFFFFF",
"Sl Kp Won To"="darkred",
"Rebnd Def"="#808080",
"Loss BW"="#000000",
"Brk Won"="#FF0000",
"Loose RBW"="#800000")

```
##Mayo

```{r}

ToWA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="ToW"| main == "Rbd Off")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ToWA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ToWA <- paste0("Total Possession Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Possession Won",  # Add the title and subtitle
          subtitle = total_ToWA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
conqmapA <- filter(pass, Teamnum == "A", main == "ToW"| main == "Rbd Off")


p + geom_point(data = conqmapA, aes(x=Areax, y=Areay, colour = Action, shape = main), size = 6)+
geom_text_repel(data = conqmapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(legend.position="none") + scale_colour_manual(
    values = paltow)

```

```{r, fig.width = 16, fig.height = 10}
scr136A <- pass %>% filter(Areax > .5,Areax <1.5,Areay >2.5, Areay <3.5, Teamnum == "A",main =="ToW")%>% summarize(count=n())

scr136A <- scr136A %>% 
    mutate(total = (sum(.$count)))

final_data136A <-scr136A %>% 
  # Combine that percentage with the actual value
  mutate(bar_label136A = paste0(format(total)))

TeamAPAScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action== "Goal"|Action== "Point"|Action== "Fk Goal"|
Action== "Fk Point"|Action== "Mk Goal"|Action== "Mk Point"|Action== "45 goal"|Action== "45 Point")

#Pulls out all scores from main TeamA
TeamAPASc <- subset(pass, possno %in% TeamAPAScr$possno)

#Ones that start from turnover
TeamAphasePASccq <- TeamAPASc %>% filter(Areax > .5,Areax <1.5,Areay >2.5, Areay <3.5,main == "ToW"|Action=="Rebnd Off")%>% summarize(count=n())

TeamAphasePASccq <- TeamAphasePASccq %>% 
    mutate(total = (sum(.$count)))

final_data1 <-TeamAphasePASccq %>% 
  # Combine that percentage with the actual value
  mutate(bar_label136 = paste0(format(total)))


p + geom_text(data= final_data136A, aes(x= 1, y= 3.2, label = bar_label136A),colour = "blue", size = 6) +
geom_text(data= final_data1, aes(x= 1, y= 2.9, label = bar_label136),colour = "white", size = 5)
```

