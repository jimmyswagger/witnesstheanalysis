---
title: "St Judes (1.10) vs Ballyboden (2.10)"
output:
  html_document:
    theme: cosmo
    toc: yes
    toc_float: yes

---

Dublin Senior Football Championship Sf - 2019

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))
#Load packages
library(flexdashboard)
library(dplyr)
library(deldir)
library(ggplot2)
library(ggrepel)
library(ggpubr)
library(knitr)
library(rmarkdown)
library(kableExtra)
library(data.table)
library(RColorBrewer)
library(gridExtra)
library(igraph)
library(tidyverse)
library(treemap)
library(plotly)
library(networkD3)
library (curl)
library(formattable)
library(grid)
library(yaml)
```

```{r}

pass <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passjudbod.csv", header=TRUE, sep=";")
attach (pass)

passline <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passlinejudbod.csv", header=TRUE, sep=";")
attach (passline)

position  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/positionjudbod.csv", header=TRUE, sep=";")
attach (position)

plytree  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/plytreejudbod.csv", header=TRUE, sep=";")
attach (plytree)

plystats <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/plystatsjudbod.csv", header=TRUE, sep=";")
attach (plystats)

passmap  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passmapjudbod.csv", header=TRUE, sep=";")
attach (passmap)

scorelist  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/scorelistjudbod.csv", header=TRUE, sep=";")
attach (scorelist)

summary  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/summaryjudbod.csv", header=TRUE, sep=";")
attach (summary)

scores  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/scoresjudbod.csv", header=TRUE, sep=";")
attach (scores)

scrd  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/scrdjudbod.csv", header=TRUE, sep=";")
attach (scrd)

shots <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/shotsjudbod.csv", header=TRUE, sep=";")
attach (shots)

passtofrom  <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passtofromjudbod.csv", header=TRUE, sep=";")
attach (passtofrom)

attstats <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/attstatsjudbod.csv", header=TRUE, sep=";")
attach (attstats)

origtime <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/origtimejudbod.csv", header=TRUE, sep=";")
attach (origtime)

shotstats <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/shotstatsjudbod.csv", header=TRUE, sep=";")
attach (shotstats)

koeff <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/koeffjudbod.csv", header=TRUE, sep=";")
attach (koeff)

rseff <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/rseffjudbod.csv", header=TRUE, sep=";")
attach (rseff)

overview <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/overjudbod.csv", header=TRUE, sep=";")
attach (overview)

run <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/runjudbod.csv", header=TRUE, sep=";")
attach (run)

tabrun <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/tabrun.csv", header=TRUE, sep=";")
attach (tabrun)

linecol <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/linecol.csv", header=TRUE, sep=";")
attach (linecol)

passbd<- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passbdjudbod.csv", header=TRUE, sep=";")
attach (passbd)

```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goala_colour,goalb_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  def14 <- 1.25
  def21 <- 1.5
  def45 <- 2.5
  def65 <- 3.5
  off65 <- 4.5
  off45 <- 5.5
  off21 <- 6.5
  off14 <- 6.75
  offel <- 7.5
  
  # Defining features along the width
  srwing <- 1.5
  frightwing <- 5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  leftwing <- 5.5

  #13 Square & small square
  right14d <- 2.6
  left14d <- 3.4
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3

  sixlinest <- 2.7
  sixlineend <- 3.3
  sixdefx <- 0.75 
  sixoffx <- 7.25 

  #halfway
  hwlinest <- 2.9
  hwlineend <- 3.1
  hwx <- 4


 #Goals

  goallinest <- 2.8
  goallineend <- 3.25
  goaldefx <- 0.5 
  goaloffx <- 7.50 

  

circleFundef <- function(center=c(0,0), diameter=1, npoints=100, start=0, end=2)
  {
    tt <- seq(start*pi, end*pi, length.out=npoints)
    data.frame(x = center[1] + diameter / 2 * cos(tt), 
               y = center[2] + diameter / 2 * sin(tt))
  }
  
  circleFunatt <- function(center=c(0,0), diameter=1, npoints=100, start=0, end=2)
  {
    tt <- seq(start*pi, end*pi, length.out=npoints)
    data.frame(x = center[1] - diameter / 2 * cos(tt), 
               y = center[2] - diameter / 2 * sin(tt))
  }
  #### create semi circle ####
  def_circle <-  circleFundef(c(1.5,3), 1, start=1.5, end=2.5)
  att_circle <-  circleFunatt(c(6.5,3), 1, start=1.5, end=2.5)
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    p <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour,size = 0.5) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x = xmax, y = right14d, xend = off14, yend = right14d),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = xmax, y = left14d, xend = off14, yend = left14d),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x=xmin,y=sixYardLeft, xend= sixYardDef, yend=sixYardLeft),colour = line_colour,linetype="solid",size = 0.5) +  
      geom_segment(aes(x=xmin,y=sixYardRight, xend= sixYardDef, yend=sixYardRight),colour = line_colour,linetype="solid",size = 0.5) +
      geom_segment(aes(x=xmax, y=sixYardLeft, xend=sixYardOff, , yend=sixYardLeft),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x=xmax, y=sixYardRight, xend=sixYardOff, , yend=sixYardRight),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x=sixdefx, y=sixlinest, xend=sixdefx, , yend=sixlineend),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x=sixoffx, y=sixlinest, xend=sixoffx, , yend=sixlineend),colour = line_colour,linetype="solid",size = 0.5) + 
      geom_segment(aes(x = hwx, y = hwlinest, xend = hwx, yend = hwlineend),colour = line_colour) +
      geom_segment(aes(x =goaldefx, y = goallinest, xend = goaldefx, yend = goallineend),colour = goala_colour, size = 1) +
      geom_segment(aes(x =goaloffx, y = goallinest, xend = goaloffx, yend = goallineend),colour = goalb_colour, size = 1) +
      geom_path(data=def_circle, aes(x,y), colour = line_colour,size = 0.5) +
      geom_path(data=att_circle, aes(x,y), colour = line_colour,size = 0.5) + 
      annotate(geom="text", x= 1.45, y=.57, label="20",color = "white") +
      annotate(geom="text", x= 2.55, y=.57, label="45",color = "blue") +
      annotate(geom="text", x= 3.55, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.55, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.55, y=.57, label="45", color="red") +
      annotate(geom="text", x=6.55, y=.57, label="20",color = "white") +
      annotate(geom="text", x= 2, y=.65, label="witnesstheanalysis.com",color = "white",size = 6, alpha = 0.6) +
      annotate(geom="text", x= 6, y=5.45, label="witnesstheanalysis.com",color = "white",size = 5, alpha = 0.6) +
      annotate("segment", x = 3.5, xend = 4.5, y = 0.75, yend = 0.75, colour = "pink", size=3, alpha=0.6, arrow=arrow())
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
       p <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "white",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "blue",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "red",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_rect(aes(xmin=boxEdgeOff, xmax=xmax, ymin=boxEdgeLeft, ymax=boxEdgeRight), colour = "white", fill = grass_colour) + 
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "white") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "red", size = 2) +
      geom_path(data=def_circle, aes(x,y), colour = "white",size = 0.5) +
      geom_path(data=att_circle, aes(x,y), colour = "white",size = 0.5) + 
      annotate(geom="text", x= 1.50, y=.57, label="20",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "blue") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="red") +
      annotate(geom="text", x=6.50, y=.57, label="20",color = "white") +
      annotate("segment", x = 3.5, xend = 4.5, y = 0.75, yend = 0.75, colour = "pink", size=3, alpha=0.6, arrow=arrow())
    
  
  }
  
  return(p)}


p <- create_Stats_Pitch("#A2CD5A", "white", "white", "blue","red", BasicFeatures=TRUE)

```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  def14 <- 1.25
  def21 <- 1.5
  def45 <- 2.5
  def65 <- 3.5
  off65 <- 4.5
  off45 <- 5.5
  off21 <- 6.5
  off14 <- 6.75
  offel <- 7.5
  
  
  
  # Defining features along the width
  srwing <- 1.5
  frightwing <- 5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    wp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "black",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "black",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "black",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "black",linetype="solid") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "black",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "black",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_rect(aes(xmin=boxEdgeOff, xmax=xmax, ymin=boxEdgeLeft, ymax=boxEdgeRight), colour = "black", fill = grass_colour) + 
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "black") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "black", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "white") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="white") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") + 
      annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 4, alpha = 0.4)
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    wp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(wp)}


wp <- create_Stats_Pitch("#ffffff", "#A9A9A9", "#ffffff", "#000000", BasicFeatures=TRUE)


```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 3.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 5.5 # maximum length
  
  # Defining features along the length
  srwing <- 1.5
  rhalfsp <- 2.5
  ctre <- 3.5
  lhspce <- 4.5
  sixYardLeft <- 2.75
  sixYardRight <- 3.25
  
  # Defining features along the width
  
  off14 <- 2.7
  off21 <- 2.5
  off45 <- 1.5
  left14 <- 2.65
  right14 <- 3.35
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    qp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = xmin, y = off21, xend = xmax, yend = off21),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = off45, xend = xmax, yend = off45),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = off14, xend = xmax, yend = off14),colour = "white",linetype="solid") +
      geom_segment(aes(x = srwing, y = ymin, xend = srwing, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = rhalfsp, y = ymin, xend = rhalfsp, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = ctre, y = ymin, xend = ctre, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = lhspce, y = ymin, xend = lhspce, yend = ymax),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = left14, y = ymax, xend = left14, yend = 2.7),colour = "white" ,linetype="solid") + 
      geom_segment(aes(x = right14, y = ymax, xend = right14, yend = 2.7),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = sixYardLeft, y = ymax, xend = sixYardLeft, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = sixYardRight, y = ymax, xend = sixYardRight, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x = 2.75, y = 3.25, xend = 3.25, yend =3.25),colour = "white" ,linetype="solid") +
      geom_segment(aes(x =2.8, y = 3.5, xend = 3.20, yend = 3.5),colour = "black", size = 2) +
      annotate(geom="text", x=0.57, y=1.45, label="45", color="white") +
      annotate(geom="text", x=0.57, y=2.45, label="21",color = "white") +
      annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 4, alpha = 0.4)
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    qp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "Red",linetype="dotted")
    
  }
  
  return(qp)}


qp <- create_Stats_Pitch("#A2CD5A", "#6495ED", "#ffffff", "#000000", BasicFeatures=TRUE)
```

```{r}
create_Stats_Pitch <- function(grass_colour, line_colour, background_colour, goal_colour, BasicFeatures){
  
  theme_blankPitch = function(size=12) { 
    theme(
      #axis.line=element_blank(), 
      axis.text.x=element_blank(), 
      axis.text.y=element_blank(), 
      #axis.ticks.y=element_text(size=size),
      #   axis.ticks=element_blank(),
      axis.ticks.length=unit(0, "lines"), 
      #axis.ticks.margin=unit(0, "lines"), 
      axis.title.x=element_blank(), 
      axis.title.y=element_blank(), 
      legend.background=element_rect(fill=background_colour, colour=NA), 
      legend.key=element_rect(colour=background_colour,fill=background_colour), 
      legend.key.size=unit(1.2, "lines"), 
      legend.text=element_text(size=size), 
      legend.title=element_text(size=size, face="bold",hjust=0),
      strip.background = element_rect(colour = background_colour, fill = background_colour, size = .5),
      panel.background=element_rect(fill=background_colour,colour=background_colour), 
      #       panel.border=element_blank(), 
      panel.grid.major=element_blank(), 
      panel.grid.minor=element_blank(), 
      panel.spacing=element_blank(), 
      plot.background=element_blank(), 
      plot.margin=unit(c(0, 0, 0, 0), "lines"), 
      plot.title=element_text(size=size*1.2), 
      strip.text.y=element_text(colour=background_colour,size=size,angle=270),   
      strip.text.x=element_text(size=size*1))}
  
  ymin <- 0.5 # minimum width
  ymax <- 5.5 # maximum width
  xmin <- 0.5 # minimum length
  xmax <- 7.5 # maximum length
  
  # Defining features along the length
  defel <- 0.5
  defe1 <- 1
  def14 <- 1.25
  def21 <- 1.5
  defe2 <- 2
  def45 <- 2.5
  defe3 <- 3
  def65 <- 3.5
  defe4 <- 4
  off65 <- 4.5
  defe5 <- 5
  off45 <- 5.5
  defe6 <- 6
  off21 <- 6.5
  off14 <- 6.75
  defe7 <- 7
  offel <- 7.5
  
  
  
  # Defining features along the width
  ctre1 <- 1
  srwing <- 1.5
  ctre2 <- 2
  rhalfsp <- 2.5
  ctre3 <- 3
  ctre <- 3.5
  ctre4 <- 4
  lhspce <- 4.5
  ctre5 <- 5
  leftwing <- 5.5
  right14d <- 2.6
  left14d <- 3.4
  right14o <- 2.6
  left14o <- 3.4
  
  
  # Defining features along the width
  
  boxEdgeOff <- 6.75  
  boxEdgeLeft <- 2.6 
  boxEdgeRight <- 3.4 
  
  # small sqaure
  
  sixYardDef <- 0.75
  sixYardOff <- 7.25
  sixYardLeft <- 2.70 
  sixYardRight <- 3.3
  
  
  
  if(BasicFeatures == TRUE){
    ## initiate the plot, set some boundries to the plot
    sp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      # add the theme 
      theme_blankPitch() +
      # add halway line
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) + 
      geom_segment(aes(x = def14, y = ymin, xend = def14, yend = ymax),colour = "white",linetype="solid") +   
      geom_segment(aes(x = def21, y = ymin, xend = def21, yend = ymax),colour = "white",linetype="solid") + 
      geom_segment(aes(x = def45, y = ymin, xend = def45, yend = ymax),colour = "blue",linetype="solid") +
      geom_segment(aes(x = def65, y = ymin, xend = def65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "red",linetype="solid") +
      geom_segment(aes(x = off21, y = ymin, xend = off21, yend = ymax),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = ymin, xend = off14, yend = ymax),colour = "white",linetype="solid") + 
        geom_segment(aes(x = defe1, y = ymin, xend = defe1, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe2, y = ymin, xend = defe2, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe3, y = ymin, xend = defe3, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe4, y = ymin, xend = defe4, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe5, y = ymin, xend = defe5, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe6, y = ymin, xend = defe6, yend = ymax),colour = line_colour,linetype="dotted") + 
        geom_segment(aes(x = defe7, y = ymin, xend = defe7, yend = ymax),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = right14d, xend = def14, yend = right14d),colour = "white",linetype="solid") + 
      geom_segment(aes(x = xmin, y = left14d, xend = def14, yend = left14d),colour = "white",linetype="solid") +
      geom_segment(aes(x = off14, y = left14o, xend = xmax, yend = left14o),colour = "white",linetype="solid") +	
      geom_segment(aes(x = off14, y = right14o, xend = xmax, yend = right14o),colour = "white",linetype="solid") +
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = srwing, xend = xmax, yend = srwing),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = rhalfsp, xend = xmax, yend = rhalfsp),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre , xend = xmax, yend = ctre),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = lhspce, xend = xmax, yend = lhspce),colour = line_colour,linetype="dotted") + 
      geom_segment(aes(x = xmin, y = ctre1, xend = xmax, yend = ctre1),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre2, xend = xmax, yend = ctre2),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre3, xend = xmax, yend = ctre3),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre4, xend = xmax, yend = ctre4),colour = line_colour,linetype="dotted") +
      geom_segment(aes(x = xmin, y = ctre5, xend = xmax, yend = ctre5),colour = line_colour,linetype="dotted") +
      geom_rect(aes(xmin=xmin, xmax=sixYardDef, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") +  
      geom_rect(aes(xmin=sixYardOff, xmax=xmax, ymin=sixYardLeft, ymax=sixYardRight), fill = grass_colour, colour = "white") + 
      geom_segment(aes(x = 4, y = 2.90, xend = 4, yend = 3.10),colour = "white") +
      geom_segment(aes(x =0.5, y = 2.75, xend = 0.5, yend = 3.25),colour = "blue", size = 2) +
      geom_segment(aes(x =7.5, y = 2.75, xend = 7.5, yend = 3.25),colour = "red", size = 2) +
      annotate(geom="text", x= 1.50, y=.57, label="21",color = "white") +
      annotate(geom="text", x= 2.50, y=.57, label="45",color = "blue") +
      annotate(geom="text", x= 3.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x= 4.50, y=.57, label="65",color = "white") +
      annotate(geom="text", x=5.50, y=.57, label="45", color="red") +
      annotate(geom="text", x=6.50, y=.57, label="21",color = "white") + 
      annotate("segment", x = 3.6, xend = 4.4, y = 0.65, yend = 0.65, colour = "pink", size=3, alpha=0.6, arrow=arrow()) +
      annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 8, alpha = 0.4)
    
  }
  
  else{
    ## initiate the plot, set some boundries to the plot
    sp <- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin-0.5,ymax+0.5)) +
      # add the theme 
      theme_blankPitch() +
      # add the base rectangle of the pitch 
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = grass_colour, colour = line_colour) +
      geom_segment(aes(x = off65, y = ymin, xend = off65, yend = ymax),colour = line_colour) +
      geom_segment(aes(x = off45, y = ymin, xend = off45, yend = ymax),colour = "red",linetype="dotted") +
                 annotate(geom="text", x= 1.5, y=.75, label="witnesstheanalysis.com",color = "black",size = 4, alpha = 0.4)
    
  }
  
  return(sp)}


sp <- create_Stats_Pitch("#A2CD5A", "black", "#ffffff", "#000000", BasicFeatures=TRUE)

```

#Summary 
##Starting Line Up (Number, Player, Playing time)
###St Judes
```{r, fig.width = 16, fig.height = 10}
#Starting Line up change to single team

positionA <-position %>% filter (Teamnum == "A") 

p + geom_point(data = positionA, aes(x=Areax, y=Areay, shape = Team), colour = "darkblue",size = 8) +
  theme(plot.title = element_text( size=32, hjust=0)) +
  geom_text_repel(data = positionA, aes(x=Areax, y=Areay, label = ptPlayer), colour = "white", size = 6) +
  theme(legend.position="none")
```

###Ballyboden
```{r, fig.width = 16, fig.height = 10}
positionB <-position %>% filter (Teamnum == "B") 

p + geom_point(data = positionB, aes(x=Areax, y=Areay, shape = Team), colour = "blue",size = 6) +
  theme(plot.title = element_text( size=32, hjust=0)) +
  geom_text_repel(data = positionB, aes(x=Areax, y=Areay, label = ptPlayer), colour = "white", size = 8) +
  theme(legend.position="none")

```

##Scores
```{r}
 
kable (scorelist) %>% kable_styling()

```

```{r}
my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black")) +
theme(legend.position="none")
  }

# Plot
ggplot(overview, aes(x=Stat, y=BallyBoden)) + 
  geom_point(data = overview,aes(x=Stat, y=Ballyboden), col="lightblue", size=10) +  
  geom_point(data = overview,aes(x=Stat, y=St.Judes), col="blue", size= 10) +
  geom_segment(aes(x=Stat, xend=Stat, y=min(Ballyboden), yend=max(St.Judes)), 
  linetype="dashed", size=0.1,colour = "grey") +     
  coord_flip() +
geom_text(data = overview,aes(x=Stat, y=Ballyboden,label = Ballyboden), size = 6,col="darkblue") +
geom_text(data = overview,aes(x=Stat, y=St.Judes,label = St.Judes), size = 6,col="white") +
my_theme ()


```

##Efficiency
```{r}
 
kable (summary) %>%
  kable_styling(bootstrap_options = c("striped"),full_width = F)

```


```{r,out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}
goal_theme <- function(){
  theme_classic() +
    theme(text = element_blank(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title.x = element_blank(),
          axis.title.y = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          plot.title =  element_blank())
}

  
          ymin <- 0 # minimum width
          ymax <- 5 # maximum width
          xmin <- 0 # minimum length
          xmax <- 3 # maximum length

      bygoal<- ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = "lightgreen", colour = "white") + 
      geom_segment(aes(x = 0, y = 1, xend = 3, yend = 1),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 1, xend = 1, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 2, y = 1, xend = 2, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 2, xend = 2, yend = 2),colour = "white",linetype="solid",size = 3) +
      annotate(geom="text", x= 1.50, y=1.5, label="Goal - 1",color = "black",size = 14) + 
      annotate(geom="text", x= 1.50, y=3.5, label="Point - 10",color = "black",size = 14) + 
      annotate(geom="text", x= 2.50, y=3, label="Wide Right - 1",color = "black",size = 14) + 
      annotate(geom="text", x= .50, y=3, label="Wide Left - 3",color = "black",size = 14) + 
      annotate(geom="text", x= 1, y=.5, label="Short/Post - 1/0",color = "black",size = 14) + 
      annotate(geom="text", x= 2, y=.5, label="Save/Blkd - 0/1",color = "black",size = 14) +
      annotate(geom="text", x= 0.5, y=4.7, label="St Judes",color = "black",size = 18)  +
      annotate(geom="text", x= 0.5, y=4.4, label="Total Shots - 17",color = "black",size = 16)  +
      goal_theme ()
      
      bygoal
      
      crkgoal<-ggplot() + xlim(c(xmin,xmax)) + ylim(c(ymin,ymax)) +
      geom_rect(aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill = "lightgreen", colour = "white") + 
      geom_segment(aes(x = 0, y = 1, xend = 3, yend = 1),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 1, xend = 1, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 2, y = 1, xend = 2, yend = 4),colour = "white",linetype="solid",size = 3) +
      geom_segment(aes(x = 1, y = 2, xend = 2, yend = 2),colour = "white",linetype="solid",size = 3) +
      annotate(geom="text", x= 1.50, y=1.5, label="Goal - 2",color = "black",size = 14) + 
      annotate(geom="text", x= 1.50, y=3.5, label="Point - 10",color = "black",size = 14) + 
      annotate(geom="text", x= 2.50, y=3, label="Wide Right - 2",color = "black",size = 14) + 
      annotate(geom="text", x= .50, y=3, label="Wide Left - 3",color = "black",size = 14) + 
      annotate(geom="text", x= 1, y=.5, label="Short/Post - 2/0",color = "black",size = 14) + 
      annotate(geom="text", x= 2, y=.5, label="Save/Blkd - 1/3",color = "black",size = 14) +
      annotate(geom="text", x= 0.5, y=4.7, label="Ballyboden",color = "black",size = 18)  +
      annotate(geom="text", x= 0.5, y=4.4, label="Total Shots - 23",color = "black",size = 16)  +
      goal_theme ()
      
      crkgoal
      
```


##Scoring Timeline
```{r, fig.width = 16, fig.height = 10}
wormA <-scores%>%filter(Teamnum == "A", subsetoc =="Start"|subsetoc =="Scr Op"|subsetoc =="Scr Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

wormB <-scores%>%filter(Teamnum == "B",subsetoc =="Start"|subsetoc =="Scr Op"|subsetoc =="Scr Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

wormC <-scores%>%filter(Teamnum == "A", subsetoc =="Start"|subsetoc =="Ms Op"|subsetoc =="Ms Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

wormD <-scores%>%filter(Teamnum == "B",subsetoc =="Start"|subsetoc =="Ms Op"|subsetoc == "MS Rs")%>%select(Team, octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff)

 
ggplot(data=scores, aes(x=timeoc, y=score, group=Team)) +
    geom_step(data=wormA, aes(x=timeoc, y=score), colour = "lightblue", ,size=2) + 
    geom_step(data=wormB, aes(x=timeoc, y=score), colour = "black", size=2) + 
    geom_point(data = wormA, shape = 1, size = 4, stroke = 2, colour = "darkblue") +
    geom_point(data = wormB, shape = 1, size = 4, stroke = 2, colour = "blue") +
    geom_point(data = wormC, shape = 4, size = 3, stroke = 2, colour = "darkblue") +
    geom_point(data = wormD, shape = 4, size = 3, stroke = 2, colour = "blue") +
    theme_classic() + 
    theme(plot.background = element_blank(),
    legend.position="bottom",
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line.x = element_blank(),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.title.x = element_blank()) +
    geom_text_repel(data = wormA, aes(x=timeoc, y=score, label = plylabrec), size = 4, colour = "blue",  
    segment.size  = 0.2,  direction = "x", hjust = 1,nudge_x = -2, nudge_y = 2) + 
    geom_text_repel(data = wormB, aes(x=timeoc, y=score, label = plylabrec), size = 4, colour = "black",  
    segment.size  = 0.2,  direction = "y",nudge_x = 3, nudge_y = -4) + 
    guides(size = FALSE) +
  theme(axis.text.y =element_text(size=16),
        axis.title.y =element_text(size=16,face="bold"))

 
```

##Score Differential
```{r, fig.width = 16, fig.height = 10}
scores <- scores%>%filter(subsetoc =="Start"|subsetoc =="Scr Op"|subsetoc =="Scr Rs")%>%select(Team,octype,xend,yend,plylabrec,timeoc,shotlab,score,direction,scorediff,scrd)

#margins

ggplot(data=scores, aes(x=timeoc, y=scorediff )) +
  geom_step(size=2) +
  geom_point() +
geom_hline(yintercept=0, linetype="dashed", color = "orange") +
theme_classic() +
geom_text_repel(data = scores, aes(x=timeoc, y=scorediff, label = scrd),  size = 8) + 
 geom_vline(xintercept=35.5, linetype="dotted", color = "black") +
    annotate(geom="text", x=2, y=4.5, label="St Judes", color="black", size = 16) +
    annotate(geom="text", x=3.5, y=-4.5, label="Ballyboden", color="black", size = 12) +
    theme(plot.background = element_blank(),
    legend.position="none",
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(), 
    axis.title.x = element_blank(),
    axis.title.y = element_blank()) +
      annotate(geom="text", x= 35.5, y=-0.25, label="HT",color = "black") 

```


#Positioning & Possessions
##Average Position by Action
###St Judes
###Game
```{r, fig.width = 16, fig.height = 10}

aveposA <- pass %>%group_by(Player, main)%>%filter( Teamnum == "A", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "blue", size = 6) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 8, colour = "white") +
theme(legend.position="none")
```

###Period
```{r,  out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}

aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "1", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "red", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 1") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "2", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "blue", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 2") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))


aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "3", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "black", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 3") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposA <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "A", period == "4", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxA <- aveposA %>%
    group_by(Player) %>%
    summarise(AreaxA = mean(Areax,na.rm = TRUE)) 

AreayA <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayA = mean(Areay,na.rm = TRUE))

avgposA <- left_join(AreaxA, AreayA, by ="Player")

p + geom_point(data = avgposA, aes(x=AreaxA, y=AreayA), colour = "darkblue", size = 8) +
geom_text_repel(data = avgposA, aes(x=AreaxA, y=AreayA, label = Player), size = 10, colour = "white") +
labs(title = "Period 4") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))
```

###Ballyboden
###Game
```{r,  fig.width = 16, fig.height = 10}

aveposB <- pass %>%group_by(Player, main)%>%filter( Teamnum == "B", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "yellow", size = 6) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 8, colour = "white") +
theme(legend.position="none")
```

###Period 
```{r, out.width='50%', fig.show='hold', fig.width = 15, fig.height = 15}

aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "1", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "red", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
 ggtitle ("Period 1") +
theme(legend.position="none") + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "2", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "blue", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
ggtitle("Period 2") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))


aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "3", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposB%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "black", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
ggtitle("Period 3") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))

aveposB <- pass %>%group_by(Player, main, period)%>%filter( Teamnum == "B", period == "4", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|
main == "Ko Rec"|main == "Fkwns"|main == "Fkws"|main == "Fklns"|main == "Fkls"| main == "Spoil Def" |main == "Spoil Off")


AreaxB <- aveposB %>%
    group_by(Player) %>%
    summarise(AreaxB = mean(Areax,na.rm = TRUE)) 

AreayB <- aveposA%>%
    group_by(Player) %>%
    summarise(AreayB = mean(Areay,na.rm = TRUE))

avgposB <- left_join(AreaxB, AreayB, by ="Player")

p + geom_point(data = avgposB, aes(x=AreaxB, y=AreayB), colour = "darkblue", size = 8) +
geom_text_repel(data = avgposB, aes(x=AreaxB, y=AreayB, label = Player), size = 10, colour = "white") +
ggtitle("Period 4") +
theme(legend.position="none")  + 
  theme(plot.title = element_text(size = 26, face = "bold",hjust = 0.5))
```

##Areas of Play by Possession
###St Judes
```{r, fig.width = 16, fig.height = 10}
heatmapA <- passmap %>%filter(plyr == "A")


p + geom_raster(data = heatmapA, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "darkblue") + 
 theme(legend.position="none")
```

###Ballyboden
```{r, fig.width = 16, fig.height = 10}
heatmapB <- passmap %>%filter(plyr == "B")

p + geom_raster(data = heatmapB, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "blue") + 
 theme(legend.position="none")

```

##Denisty Map (All Actions)
###St Judes 
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "A", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|main == "Ko Rec"|main == "Free Won"|main == "Free Loss"| main == "Spoil Def" |main == "Spoil Off")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main),colour = "black",size = 4,stroke = 1)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

###Ballyboden 
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "B", main == "PW"|main == "Rec Op"|main == "Rec Rs"|main == "Pass Op"|main == "Pass Rs"|main == "Shot Op"|main == "Shot Rs"|main == "Ko Rec"|main == "Free Won"|main == "Free Loss"| main == "Spoil Def" |main == "Spoil Off")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main),colour = "black",size = 4,stroke = 1)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

##Path of Possession

```{r}

runcolpal <- c(
  "0" = "blue",
  "1" = "black", 
  "2" = "blue", 
  "3" = "white",
  "4" = "yellow",
  "5" =  "gold",
  "6" = "darkred",
  "7" = "red",
  "8" = "red",
  "9" = "pink",
  "10" = "lightblue",
  "Team"= "orange",
"PW" = "purple")


runlinepal <- c(
  "0" = 2,
  "1" = 1, 
  "2" = 2, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 2,
  "7" = 2,
  "8" = 2,
  "9" = 1,
  "10"= 1,
  "Team"= 6)
```

```{r}
kable (tabrun)%>% kable_styling(bootstrap_options=c("striped",full_width = F))%>%row_spec(6,bold = T)

```

###St Judes - Game
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```

```{r, fig.width = 16, fig.height = 10}


heatmapA <- passmap %>%filter(plyr == "A")

runA <- run%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")

p + geom_raster(data = heatmapA, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "orange") + 
 theme(legend.position="none") +
    geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```

###Pop Starting from Possession Won 
```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "A", main == "PW")



#Pulls out all shots from main TeamA
runA <- subset(runA, poss %in% TeamAPAScr$poss)

runA <- runA%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```

###Pop Starting from Kick Out
```{r, fig.width = 16, fig.height = 10}


#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "A", main == "Ko")



#Pulls out all shots from main TeamA
runA <- subset(run, poss %in% TeamAPAScr$poss)

runA <- runA%>%filter(Teamnum=="A",keep=="Y")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec")



p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
    geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
  


```

###St Judes - Period 1
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "1")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "1")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "1")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "1")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "1")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "1")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "1")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 




```

###St Judes - Period 2
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "2")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "2")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "2")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "2")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "2")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "2")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "2")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 


```

###St Judes - Period 3
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "3")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "3")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "3")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "3")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "3")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "3")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "3")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 



```

###St Judes - Period 4
```{r, fig.width = 16, fig.height = 10}

runA <- run%>%filter(Teamnum=="A",keep=="Y",period == "4")

actA <- runA%>% filter(Teamnum == "A", main == "PW",period == "4")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL",period == "4")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws",period == "4")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns",period == "4")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL",period == "4")

actAAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko Rec",period == "4")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actA, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actAAAAAA, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actAAAAAA, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 



```

###Ballyboden - Game
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
      geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
   geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```

```{r, fig.width = 16, fig.height = 10}
heatmapA <- passmap %>%filter(plyr == "B")

runB <- run%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")



p + geom_raster(data = heatmapA, aes(x=Areax, y=Areay, fill=value, alpha = value), interpolate = T) +
scale_fill_gradient(low = "gray95", high = "orange") + 
 theme(legend.position="none") + 
  geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
   geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```

###Pop Starting from Possession Won 

```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "B", main == "PW")



#Pulls out all shots from main TeamA
runB <- subset(run, poss %in% TeamAPAScr$poss)



runB <- runB%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)  +
    geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)
```

###Pop Starting from Kick Out

```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- run %>%group_by(Team, Action) %>% filter(Teamnum == "B", main == "Ko")



#Pulls out all shots from main TeamA
runB <- subset(run, poss %in% TeamAPAScr$poss)



runB <- runB%>%filter(Teamnum=="B",keep=="Y")

actB <- runB%>% filter(Teamnum == "B", main == "PW")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actB, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actBBB, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actBBBB, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19)  +
    geom_point(data = actBBBBBB, aes(x=xend, y=yend), colour = "black" ,size = 3, shape = 19)
```

###Ballyboden Period - 1
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "1")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "1")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "1")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "1")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "1")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "1")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec",period == "1")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x = Areax, y = Areay), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x = Areax, y = Areay), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Ballyboden Period - 2
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "2")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "2")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "2")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "2")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "2")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "2")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec",period == "2")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x = Areax, y = Areay), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x = Areax, y = Areay), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Ballyboden Period - 3
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "3")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "3")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "3")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "3")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "3")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "3")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc== "Ko Rec",period == "3")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x = Areax, y = Areay), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x = Areax, y = Areay), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

###Ballyboden Period - 4
```{r, fig.width = 16, fig.height = 10}

runB <- run%>%filter(Teamnum=="B",keep=="Y", period == "4")

actB <- runB%>% filter(Teamnum == "B", main == "PW", period == "4")

actBB <- runB%>% filter(Teamnum == "B", subsetoc == "Pass ToL", period == "4")

actBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkws", period == "4")

actBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Fkwns", period == "4")

actBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko ToL", period == "4")

actBBBBBB <- runB%>% filter(Teamnum == "B", subsetoc == "Ko Rec",period == "4")

p + geom_segment(data = runB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runB, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runB, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) + 
  geom_point(data = actB, aes(x = Areax, y = Areay), colour = "purple" ,size = 3, shape = 19) + 
    geom_text_repel(data = actB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
  geom_text_repel(data = actBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBB, aes(x = Areax, y = Areay), colour = "orange" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBB, aes(x = Areax, y = Areay), colour = "blue" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBB, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    geom_point(data = actBBBBB, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") +
  geom_point(data = actBBBBBB, aes( x=xend, y=yend), colour = "black" ,size = 3, shape = 19) +
  geom_text_repel(data = actBBBBBB, aes(x=xend, y=yend, label = poss), size = 6, colour = "white") 
```

##45 Entries
###St Judes - Game

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5 )

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###St Judes - Period 1

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, period == "1")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###St Judes - Period 2

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, period == "2")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###St Judes - Period 3

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, period == "3")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###St Judes - Period 4

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, period == "4")

actA <- runA%>% filter(Teamnum == "A", main == "PW")

actAA <- runA%>% filter(Teamnum == "A", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "A", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Game

```{r, fig.width = 16, fig.height = 10}



runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5 )

runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5 )

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 1

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, period == "1")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden- Period 2

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, period == "2")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 3

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, period == "3")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```

###Ballyboden - Period 4

```{r, fig.width = 16, fig.height = 10}


runA <- run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, period == "4")

actA <- runA%>% filter(Teamnum == "B", main == "PW")

actAA <- runA%>% filter(Teamnum == "B", subsetoc == "Pass ToL")

actAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkws")

actAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Fkwns")

actAAAAA <- runA%>% filter(Teamnum == "B", subsetoc == "Ko ToL")

p + geom_segment(data = runA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = as.factor(seg),linetype= as.factor(seg)),size = .5,arrow = arrow()) +
    geom_point(data = runA, aes(x = Areax, y = Areay), size = 1.5,colour = "white") +
    geom_point (data = runA, aes(x=xend, y=yend), size = 1.5,colour = "white") +   
    geom_text_repel(data = runA, aes(x = Areax, y = Areay, label = poss), size = 6, colour = "white") +
    theme(legend.position="none") + scale_colour_manual(values = runcolpal) +
    scale_linetype_manual(values = runlinepal) +
    geom_point(data = actA, aes(x=Areax, y=Areay, colour = main),size = 3, shape = 19) +
    geom_point(data = actAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) + 
    geom_point(data = actAAA, aes(x=xend, y=yend), colour = "orange" ,size = 3, shape = 19) +
    geom_point(data = actAAAA, aes(x=xend, y=yend), colour = "blue" ,size = 3, shape = 19) +
    geom_point(data = actAAAAA, aes(x=xend, y=yend), colour = "red" ,size = 3, shape = 19) 


```


###St Judes Total
```{r}
run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5 )%>%summarize(count=n())

```

###St Judes Handpass

```{r}

run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, seg == "1" )%>%summarize(count=n())

```

###St Judes Run

```{r}
run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, seg == "2"| seg == "0" )%>%summarize(count=n())
```

###St Judes Kick Pass Right

```{r}
run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, seg == "3" )%>%summarize(count=n())
```

###St Judes Pass Lost

```{r}
run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, seg == "7" )%>%summarize(count=n())

```

###St Judes Kick Pass Left

```{r}

run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, seg == "9" )%>%summarize(count=n())

```

###St Judes Fk/Mk/Sl Pass

```{r}

run%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5, seg == "10" )%>%summarize(count=n())
```


###Ballyboden Total
```{r}
run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5 )%>%summarize(count=n())

```

###Ballyboden Handpass

```{r}

run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, seg == "1" )%>%summarize(count=n())

```

###Ballyboden Run

```{r}
run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, seg == "2"| seg == "0" )%>%summarize(count=n())
```

###Ballyboden Kick Pass Right

```{r}
run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, seg == "3" )%>%summarize(count=n())
```

###Ballyboden Pass Lost

```{r}
run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, seg == "7" )%>%summarize(count=n())

```

###Ballyboden Kick Pass Left

```{r}

run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, seg == "9" )%>%summarize(count=n())

```

###Ballyboden Fk/Mk/Sl Pass

```{r}

run%>%filter(Teamnum=="B",keep=="Y", Areax <5.5 & xend > 5.5, seg == "10" )%>%summarize(count=n())
```


#General
##Kick Outs
###St Judes

```{r}

ko <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset=="Ko Rec"| subset =="Ko ToL")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 20, color = "gray10"))
  }

final_data <- ko %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ko <- paste0("Total Kickouts: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Kickout Outcomes", 
          subtitle = total_ko) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 16, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))




```

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 1
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="1")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 2
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="2")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 3

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="3")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 4

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL", period =="4")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Kickout Efficiency 
```{r, fig.width = 16, fig.height = 10}
koeffA <- koeff %>% filter(Teamnum== "A", yes == "2")

sp + geom_text(data= koeffA, aes(x= tx, y= ty, label = Recd),colour = "white", size = 9) +
geom_text(data= koeffA, aes(x= bx, y= by, label = Rec),colour = "white", size = 7)
```

###Kickout Network - St Judes
```{r, fig.width = 20, fig.height = 20}

linksABs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/linkskojudbod.csv", header=TRUE, sep=";")
attach (linksABs)

nodesteamAko <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodeskojudbod.csv", header=TRUE, sep=";")
attach (nodesteamAko)

linksAko <- linksABs %>% filter( Teamnum == "A") %>% select(Teamnum,plypass, plyrec)

linksAko <- rename(count(linksAko, plypass, plyrec), weight = n)

netAko <- graph_from_data_frame(d=linksAko, vertices=nodesteamAko, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("lightblue", "lightblue", "lightblue", "lightblue", "lightblue")
V(netAko)$color <- colrs[V(netAko)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netAko, mode="all")
V(netAko)$size <- deg*2 #size of node 

nodes.coordA <- data.frame(data = nodesteamAko,
    x= Areax,
    y=Areay)

plot(netAko, edge.arrow.size=.4, edge.color="lightblue",edge.arrow.width=.4,
      edge.width=E(netAko)$weight*5, layout=as.matrix(nodes.coordA[,c("x","y")]), vertex.label.color="darkblue", vertex.label = labkoA, vertex.label.cex = 5)

```

###Kickout Density
```{r, fig.width = 16, fig.height = 10}

komapA <-filter(pass, Teamnum == "A",subset =="Ko Rec"| subset =="Ko ToL")
pal <- c("Ko Rec" = "blue",
"Ko ToL"  = "red")

pals <- c("Ko Rec" = 19,
"Ko ToL"  = 4)

p  +  geom_density_2d(data = komapA, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = komapA, aes(x=Areax, y=Areay, shape= subset,colour = subset),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
 scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal) +
  guides(color = FALSE)
```


###Ballyboden

```{r}

ko <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset=="Ko Rec"| subset =="Ko ToL")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 20, color = "gray10"))
  }

final_data <- ko %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ko <- paste0("Total Kickouts: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Kickout Outcomes", 
          subtitle = total_ko) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 16, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))


```

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4)
#Map Team B
komapB <-filter(pass, Teamnum == "B", subset =="Ko Rec"| subset =="Ko ToL")

p + geom_point(data = komapB, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapB, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)
```

###Period 1
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="1")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 2
```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="2")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 3

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="3")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Period 4

```{r, fig.width = 16, fig.height = 10}

pal <- c("Ko Rec" = "blue",
"Ko Lost"  = "red",
"KoBrk Rec" = "purple",
"KoBrk Lost"  = "red",
"Ko Mk Won"  = "black",
"Ko Lost Mk" = "red",
"Ko Unc Rec" = "white",
"Ko Fk Won" = "lightblue",
"Ko Fk Loss Off" = "darkred",
"Ko MkW Po" = "darkgreen")

pals <- c("Ko Rec" = 19,
"Ko Lost"  = 4,
"KoBrk Rec" = 19,
"KoBrk Lost"  = 4,
"Ko Mk Won"  = 19,
"Ko Lost Mk" = 4,
"Ko Unc Rec" = 19,
"Ko Fk Won" = 19,
"Ko Fk Loss Off" = 4,
"Ko MkW Po" = 19)



#Map Team A
komapA <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL", period =="4")

p + geom_point(data = komapA, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6, stroke = 2))+
geom_text_repel(data = komapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal)

```

###Kickout Efficiency 

```{r, fig.width = 16, fig.height = 10}
koeffB <- koeff %>% filter(Teamnum== "B", yes == "2")

sp + geom_text(data= koeffB, aes(x= tx, y= ty, label = Recd),colour = "white", size = 9) +
geom_text(data= koeffB, aes(x= bx, y= by, label = Rec),colour = "white", size = 7)
```

###Kickout Network - Ballyboden
```{r, fig.width = 20, fig.height = 20}

linksABs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/linkskojudbod.csv", header=TRUE, sep=";")
attach (linksABs)

nodesteamBko <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodeskobodjud.csv", header=TRUE, sep=";")
attach (nodesteamBko)

linksBko <- linksABs %>% filter( Teamnum == "B") %>% select(Teamnum,plypass, plyrec)

linksBko <- rename(count(linksBko, plypass, plyrec), weight = n)

netBko <- graph_from_data_frame(d=linksBko, vertices=nodesteamBko, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("blue", "blue", "blue","blue","blue")
V(netBko)$color <- colrs[V(netBko)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netBko, mode="all")
V(netBko)$size <- deg*2 #size of node 

nodes.coordB <- data.frame(data = nodesteamBko,
    x= Areax,
    y=Areay)

plot(netBko, edge.arrow.size=.4, edge.color="blue",edge.arrow.width=.4,
      edge.width=E(netBko)$weight*5, layout=as.matrix(nodes.coordB[,c("x","y")]), vertex.label.color="black",  vertex.label = labkoB, vertex.label.cex = 5)

```

###Kickout Density
```{r, fig.width = 16, fig.height = 10}

komapB <-filter(pass, Teamnum == "B",subset =="Ko Rec"| subset =="Ko ToL")

pal <- c("Ko Rec" = "blue",
"Ko ToL"  = "red")

pals <- c("Ko Rec" = 19,
"Ko ToL"  = 4)

p  +  geom_density_2d(data = komapB, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = komapB, aes(x=Areax, y=Areay, shape= subset,colour = subset),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
 scale_shape_manual(values= pals) +
  scale_colour_manual(values = pal) +
  guides(color = FALSE)
```

##Turn overs/Possession Won
```{r}
paltow <- c("Tack W"="#000000",
"KP Int"="blue",
"HP Int"="purple",
"Kp Brk Int"="#FF6347",
"Hp Brk Int"="#0000FF",
"Kp Free Int"="#FFFF00",
"Fk Brk Int"="#00FFFF",
"Mk Kp Int"="#FF00FF",
"Sl Int"="darkblue",
"Short Def"=" black",
"Ko Int"="#800000",
"KoBrk Int"="#808000",
"Ko Int Mk"="#D2691E",
"Fk Short Gk"="#800080",
"Short Gk"="#008080",
"Loose TBW"="#000080",
"Free Won Def"="gold",
"Sl Kp Won To"="darkred",
"Rebnd Def"="#808080",
"Loss BW"="#000000",
"Brk Won"="#FF0000",
"Loose RBW"="#800000",
"Ko Fk Won Def" = "lightblue")

```

###St Judes

```{r}

ToWA <- run%>%group_by(Team, Action)%>%filter(Teamnum=="A",keep=="Y", Areax <5.5 & xend > 5.5 )%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ToWA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ToWA <- paste0("Total Possession Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Possession Won",  # Add the title and subtitle
          subtitle = total_ToWA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
conqmapA <- filter(pass, Teamnum == "A", main =="PW")


p + geom_point(data = conqmapA, aes(x=Areax, y=Areay, colour = Action, shape = main), size = 6)+
geom_text_repel(data = conqmapA, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(legend.position="none") + scale_colour_manual(
    values = paltow)

```

###Ballyboden

```{r}

ToWA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", main =="PW")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ToWA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ToWA <- paste0("Total Possession Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Possession Won",  # Add the title and subtitle
          subtitle = total_ToWA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
conqmapB <-filter(pass, Teamnum == "B", main =="PW")


p + geom_point(data = conqmapB, aes(x=Areax, y=Areay, colour = Action, shape = Team ), size = 6)+
geom_text_repel(data = conqmapB, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(legend.position="none")+ scale_colour_manual(
    values = paltow)

  
```

##Frees Won
###St Judes

```{r}

FKA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKA <- paste0("Total Fk Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Won",  # Add the title and subtitle
          subtitle = total_FKA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}

freeAmap <- filter(pass, Teamnum == "A", subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")

p + geom_point(data = freeAmap, aes(x=Areax, y=Areay, colour = subset, shape = subset, size = 6)) +
geom_text_repel(data = freeAmap, aes(x=Areax, y=Areay, label = plylab, col = subset), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none")  +
scale_shape_manual(values=c(15, 16,17)) +
    scale_color_manual(values=c("lightblue","white","blue"))
```

###Ballyboden

```{r}

FKB <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKB %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKB <- paste0("Total Fk Won: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Won",  # Add the title and subtitle
          subtitle = total_FKB) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}

#Map Team B

freeBmap <-filter(pass, Teamnum == "B",subset =="Fkws"|subset =="Fkwns"| Action == "Free Won Def")

p + geom_point(data = freeBmap, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6)) +
geom_text_repel(data = freeBmap, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values=c(15, 16, 17,18)) +
    scale_color_manual(values=c("lightblue","white","blue","white"))
```

##Frees Loss
###St Judes

```{r}

FKLA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A",  subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKLA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKLA  <- paste0("Total Fk Loss: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Loss",  # Add the title and subtitle
          subtitle = total_FKLA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}
#Map Team A

freeAmap <- filter(pass, Teamnum == "A", subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")

p + geom_point(data = freeAmap, aes(x=Areax, y=Areay, colour = Action, shape = Action, size = 6)) +
geom_text_repel(data = freeAmap, aes(x=Areax, y=Areay, label = plylab, col = Action), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values=c(15,16,17,18,4)) +
    scale_color_manual(values=c("red1","red","firebrick3","red","red"))
```

###Ballyboden

```{r}

FKLB <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- FKLB %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_FKLB <- paste0("Total Fk Loss: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Free Kicks Loss",  # Add the title and subtitle
          subtitle = total_FKLB) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 10}

freeBmap <-filter(pass, Teamnum == "B", subset =="Fkls"|subset =="Fklns"|Action == "Free Loss Off")

p + geom_point(data = freeBmap, aes(x=Areax, y=Areay, colour = subset, shape = subset, size = 6)) +
geom_text_repel(data = freeBmap, aes(x=Areax, y=Areay, label = plylab, col = subset), size = 8) +
theme(plot.title = element_text(hjust=0.5)) +
theme(plot.subtitle = element_text(hjust=0.5)) +
theme(legend.position="none") +
scale_shape_manual(values=c(15,16,17,18,4)) +
    scale_color_manual(values=c("red1","red","firebrick3","red","red"))
```

#Attacking

##Attacking Stats
```{r}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))

kable (attstats)%>% kable_styling(bootstrap_options=c("striped",full_width = F))%>%column_spec(1,bold = T)%>%add_header_above(c(" "= 1, "St Judes" = 2, "Ballyboden" = 2))

```


##Shot Stats
```{r}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))

kable (shotstats)%>% kable_styling(bootstrap_options=c("striped"))%>%row_spec(3, bold = T)%>%column_spec(1,bold = T)

```

##Shot Origin & Time 
```{r}

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, options(knitr.kable.NA = ''))

kable (origtime,col.names = NULL)%>% kable_styling(bootstrap_options=c("striped"))
```

```{r}
kable (linecol)%>% kable_styling(bootstrap_options=c("striped",full_width = F))%>%row_spec(9,bold = T)

```

##Shot Possessions 
###St Judes
```{r, fig.width = 16, fig.height = 14}

passline <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passlinejudbod.csv", header=TRUE, sep=";")
attach (passline)

passline <- passline[passline$Asht!="20", ]

passPW <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main =="PW")
passKo <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Ko Rec")
passRs <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Pass Rs")
passFk <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Shot Rs")
passOp <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Shot Op")


A1 <- passline %>% filter(Teamnum == "A" & poss == "A1") 
A2 <- passline %>% filter(Teamnum == "A" & poss == "A2") 
A3 <- passline %>% filter(Teamnum == "A" & poss == "A3") 
A4 <- passline %>% filter(Teamnum == "A" & poss == "A4") 
A5 <- passline %>% filter(Teamnum == "A" & poss == "A5") 
A6 <- passline %>% filter(Teamnum == "A" & poss == "A6") 
A7 <- passline %>% filter(Teamnum == "A" & poss == "A7") 
A8 <- passline %>% filter(Teamnum == "A" & poss == "A8") 
A9 <- passline %>% filter(Teamnum == "A" & poss == "A9") 
A10 <- passline %>% filter(Teamnum == "A" & poss == "A10") 
A11 <- passline %>% filter(Teamnum == "A" & poss == "A11") 
A12 <- passline %>% filter(Teamnum == "A" & poss == "A12") 
A13 <- passline %>% filter(Teamnum == "A" & poss == "A13") 
A14 <- passline %>% filter(Teamnum == "A" & poss == "A14") 
A15 <- passline %>% filter(Teamnum == "A" & poss == "A15") 
A16 <- passline %>% filter(Teamnum == "A" & poss == "A16") 
A17 <- passline %>% filter(Teamnum == "A" & poss == "A17") 
A18 <- passline %>% filter(Teamnum == "A" & poss == "A18") 
A19 <- passline %>% filter(Teamnum == "A" & poss == "A19") 
A20 <- passline %>% filter(Teamnum == "A" & poss == "A20") 
A21 <- passline %>% filter(Teamnum == "A" & poss == "A21") 
A22 <- passline %>% filter(Teamnum == "A" & poss == "A22") 
A23 <- passline %>% filter(Teamnum == "A" & poss == "A23") 
A24 <- passline %>% filter(Teamnum == "A" & poss == "A24") 
A25 <- passline %>% filter(Teamnum == "A" & poss == "A25") 
A26 <- passline %>% filter(Teamnum == "A" & poss == "A26") 
A27 <- passline %>% filter(Teamnum == "A" & poss == "A27") 
A28 <- passline %>% filter(Teamnum == "A" & poss == "A28") 
A29 <- passline %>% filter(Teamnum == "A" & poss == "A29") 
A30 <- passline %>% filter(Teamnum == "A" & poss == "A30") 
A31 <- passline %>% filter(Teamnum == "A" & poss == "A31") 
A32 <- passline %>% filter(Teamnum == "A" & poss == "A32") 
A33 <- passline %>% filter(Teamnum == "A" & poss == "A33") 
A34 <- passline %>% filter(Teamnum == "A" & poss == "A34") 
A35 <- passline %>% filter(Teamnum == "A" & poss == "A35") 
A36 <- passline %>% filter(Teamnum == "A" & poss == "A36") 
A37 <- passline %>% filter(Teamnum == "A" & poss == "A37") 
A38 <- passline %>% filter(Teamnum == "A" & poss == "A38") 
A39 <- passline %>% filter(Teamnum == "A" & poss == "A39") 
A40 <- passline %>% filter(Teamnum == "A" & poss == "A40") 
A41 <- passline %>% filter(Teamnum == "A" & poss == "A41") 
A42 <- passline %>% filter(Teamnum == "A" & poss == "A42") 
A43 <- passline %>% filter(Teamnum == "A" & poss == "A43") 
A44 <- passline %>% filter(Teamnum == "A" & poss == "A44") 
A45 <- passline %>% filter(Teamnum == "A" & poss == "A45") 
A46 <- passline %>% filter(Teamnum == "A" & poss == "A46") 
A47 <- passline %>% filter(Teamnum == "A" & poss == "A47") 
A48 <- passline %>% filter(Teamnum == "A" & poss == "A48") 
A49 <- passline %>% filter(Teamnum == "A" & poss == "A49") 
A50 <- passline %>% filter(Teamnum == "A" & poss == "A50") 
A51 <- passline %>% filter(Teamnum == "A" & poss == "A51") 
A52 <- passline %>% filter(Teamnum == "A" & poss == "A52") 
A53 <- passline %>% filter(Teamnum == "A" & poss == "A53") 
A54 <- passline %>% filter(Teamnum == "A" & poss == "A54") 
A55 <- passline %>% filter(Teamnum == "A" & poss == "A55") 
A56 <- passline %>% filter(Teamnum == "A" & poss == "A56") 
A57 <- passline %>% filter(Teamnum == "A" & poss == "A57") 
A58 <- passline %>% filter(Teamnum == "A" & poss == "A58") 
A59 <- passline %>% filter(Teamnum == "A" & poss == "A59") 
A60 <- passline %>% filter(Teamnum == "A" & poss == "A60") 
A61 <- passline %>% filter(Teamnum == "A" & poss == "A61") 
A62 <- passline %>% filter(Teamnum == "A" & poss == "A62") 
A63 <- passline %>% filter(Teamnum == "A" & poss == "A63") 
A64 <- passline %>% filter(Teamnum == "A" & poss == "A64") 
A65 <- passline %>% filter(Teamnum == "A" & poss == "A65") 
A66 <- passline %>% filter(Teamnum == "A" & poss == "A66") 
A67 <- passline %>% filter(Teamnum == "A" & poss == "A67") 
A68 <- passline %>% filter(Teamnum == "A" & poss == "A68") 
A69 <- passline %>% filter(Teamnum == "A" & poss == "A69") 
A70 <- passline %>% filter(Teamnum == "A" & poss == "A70") 
A71 <- passline %>% filter(Teamnum == "A" & poss == "A71") 
A72 <- passline %>% filter(Teamnum == "A" & poss == "A72") 
A73 <- passline %>% filter(Teamnum == "A" & poss == "A73") 
A74 <- passline %>% filter(Teamnum == "A" & poss == "A74") 
A75 <- passline %>% filter(Teamnum == "A" & poss == "A75") 
A76 <- passline %>% filter(Teamnum == "A" & poss == "A76") 
A77 <- passline %>% filter(Teamnum == "A" & poss == "A77") 
A78 <- passline %>% filter(Teamnum == "A" & poss == "A78") 
A79 <- passline %>% filter(Teamnum == "A" & poss == "A79") 
A80 <- passline %>% filter(Teamnum == "A" & poss == "A80") 
A81 <- passline %>% filter(Teamnum == "A" & poss == "A81") 
A82 <- passline %>% filter(Teamnum == "A" & poss == "A82") 
A83 <- passline %>% filter(Teamnum == "A" & poss == "A83") 
A84 <- passline %>% filter(Teamnum == "A" & poss == "A84") 
A85 <- passline %>% filter(Teamnum == "A" & poss == "A85") 
A86 <- passline %>% filter(Teamnum == "A" & poss == "A86") 
A87 <- passline %>% filter(Teamnum == "A" & poss == "A87") 
A88 <- passline %>% filter(Teamnum == "A" & poss == "A88") 
A89 <- passline %>% filter(Teamnum == "A" & poss == "A89") 
A90 <- passline %>% filter(Teamnum == "A" & poss == "A90") 
A91 <- passline %>% filter(Teamnum == "A" & poss == "A91") 
A92 <- passline %>% filter(Teamnum == "A" & poss == "A92") 
A93 <- passline %>% filter(Teamnum == "A" & poss == "A93") 
A94 <- passline %>% filter(Teamnum == "A" & poss == "A94") 
A95 <- passline %>% filter(Teamnum == "A" & poss == "A95") 
A96 <- passline %>% filter(Teamnum == "A" & poss == "A96") 
A97 <- passline %>% filter(Teamnum == "A" & poss == "A97") 
A98 <- passline %>% filter(Teamnum == "A" & poss == "A98") 
A99 <- passline %>% filter(Teamnum == "A" & poss == "A99") 
A100 <- passline %>% filter(Teamnum == "A" & poss == "A100") 

actcolpal <- c(
  "20" = "grey",
  "1" = "black", 
  "2" = "blue", 
  "3" = "red",
  "4" = "purple",
  "5" =  "yellow",
  "6" = "white",
  "7" = "orange",
  "8" = "pink")

runlinepal <- c(
  "20" = 2,
  "1" = 1, 
  "2" = 1, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 1,
  "7" = 1,
  "8" = 1,
  "9" = 1,
  "10"= 1)


p + 
geom_path(data = A1, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A2, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A3, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A4, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A5, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A6, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A7, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A8, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A9, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A10, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A11, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A12, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A13, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A14, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A15, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A16, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A17, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A18, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A19, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A20, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A21, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A22, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A23, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A24, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A25, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A26, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A27, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A28, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A29, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A30, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A31, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A32, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A33, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A34, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A35, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A36, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A37, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A38, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A39, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A40, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A41, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A42, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A43, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A44, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A45, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A46, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A47, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A48, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A49, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A50, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A51, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A52, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A53, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A54, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A55, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A56, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A57, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A58, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A59, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A60, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A61, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A62, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A63, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A64, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A65, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A66, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A67, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A68, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A69, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A70, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A71, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A72, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A73, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A74, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A75, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A76, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A77, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A78, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A79, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A80, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A81, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A82, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A83, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A84, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A85, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A86, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A87, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A88, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A89, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A90, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A91, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A92, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A93, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A94, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A95, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A96, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A97, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A98, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A99, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
geom_path(data = A100, aes(x=Areax, y=Areay, colour = as.factor(Asht) , linetype= as.factor(Asht)), size = 0.8) + 
theme(legend.position="none") +
scale_colour_manual(values = actcolpal) +
scale_linetype_manual(values = runlinepal) +
geom_point(data = passPW, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "white", shape = 16) +
geom_text(data = passPW, aes(x=Areax, y=Areay, label = possno),colour = "black") +
geom_point(data = passRs, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "blue", shape = 16) +
geom_text(data = passRs, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passOp, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "red", shape = 16) +
geom_text(data = passOp, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passFk, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "Purple", shape = 16) +
geom_text(data = passFk, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passKo, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "black", shape = 16) +
geom_text(data = passKo, aes(x=Areax, y=Areay, label = possno),colour = "white") 

```

###Ballyboden
```{r, fig.width = 16, fig.height = 14}


passline <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passlinejudbod.csv", header=TRUE, sep=";")
attach (passline)

passline <- passline[passline$Bsht!="20", ]

passPW <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main =="PW")
passKo <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Ko Rec")
passRs <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Pass Rs")
passFk <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Shot Rs")
passOp <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Shot Op")
pass45 <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="45")

B1 <- passline %>% filter(Teamnum == "B" & poss == "B1") 
 
B2 <- passline %>% filter(Teamnum == "B" & poss == "B2") 
 
B3 <- passline %>% filter(Teamnum == "B" & poss == "B3") 
 
B4 <- passline %>% filter(Teamnum == "B" & poss == "B4") 
 
B5 <- passline %>% filter(Teamnum == "B" & poss == "B5") 
 
B6 <- passline %>% filter(Teamnum == "B" & poss == "B6") 
 
B7 <- passline %>% filter(Teamnum == "B" & poss == "B7") 
 
B8 <- passline %>% filter(Teamnum == "B" & poss == "B8") 
 
B9 <- passline %>% filter(Teamnum == "B" & poss == "B9") 
 
B10 <- passline %>% filter(Teamnum == "B" & poss == "B10") 
 
B11 <- passline %>% filter(Teamnum == "B" & poss == "B11") 
 
B12 <- passline %>% filter(Teamnum == "B" & poss == "B12") 
 
B13 <- passline %>% filter(Teamnum == "B" & poss == "B13") 
 
B14 <- passline %>% filter(Teamnum == "B" & poss == "B14") 
 
B15 <- passline %>% filter(Teamnum == "B" & poss == "B15") 
 
B16 <- passline %>% filter(Teamnum == "B" & poss == "B16") 
 
B17 <- passline %>% filter(Teamnum == "B" & poss == "B17") 
 
B18 <- passline %>% filter(Teamnum == "B" & poss == "B18") 
 
B19 <- passline %>% filter(Teamnum == "B" & poss == "B19") 
 
B20 <- passline %>% filter(Teamnum == "B" & poss == "B20") 
 
B21 <- passline %>% filter(Teamnum == "B" & poss == "B21") 
 
B22 <- passline %>% filter(Teamnum == "B" & poss == "B22") 
 
B23 <- passline %>% filter(Teamnum == "B" & poss == "B23") 
 
B24 <- passline %>% filter(Teamnum == "B" & poss == "B24") 
 
B25 <- passline %>% filter(Teamnum == "B" & poss == "B25") 
 
B26 <- passline %>% filter(Teamnum == "B" & poss == "B26") 
 
B27 <- passline %>% filter(Teamnum == "B" & poss == "B27") 
 
B28 <- passline %>% filter(Teamnum == "B" & poss == "B28") 
 
B29 <- passline %>% filter(Teamnum == "B" & poss == "B29") 
 
B30 <- passline %>% filter(Teamnum == "B" & poss == "B30") 
 
B31 <- passline %>% filter(Teamnum == "B" & poss == "B31") 
 
B32 <- passline %>% filter(Teamnum == "B" & poss == "B32") 
 
B33 <- passline %>% filter(Teamnum == "B" & poss == "B33") 
 
B34 <- passline %>% filter(Teamnum == "B" & poss == "B34") 
 
B35 <- passline %>% filter(Teamnum == "B" & poss == "B35") 
 
B36 <- passline %>% filter(Teamnum == "B" & poss == "B36") 
 
B37 <- passline %>% filter(Teamnum == "B" & poss == "B37") 
 
B38 <- passline %>% filter(Teamnum == "B" & poss == "B38") 
 
B39 <- passline %>% filter(Teamnum == "B" & poss == "B39") 
 
B40 <- passline %>% filter(Teamnum == "B" & poss == "B40") 
 
B41 <- passline %>% filter(Teamnum == "B" & poss == "B41") 
 
B42 <- passline %>% filter(Teamnum == "B" & poss == "B42") 
 
B43 <- passline %>% filter(Teamnum == "B" & poss == "B43") 
 
B44 <- passline %>% filter(Teamnum == "B" & poss == "B44") 
 
B45 <- passline %>% filter(Teamnum == "B" & poss == "B45") 
 
B46 <- passline %>% filter(Teamnum == "B" & poss == "B46") 
 
B47 <- passline %>% filter(Teamnum == "B" & poss == "B47") 
 
B48 <- passline %>% filter(Teamnum == "B" & poss == "B48") 
 
B49 <- passline %>% filter(Teamnum == "B" & poss == "B49") 
 
B50 <- passline %>% filter(Teamnum == "B" & poss == "B50") 
 
B51 <- passline %>% filter(Teamnum == "B" & poss == "B51") 
 
B52 <- passline %>% filter(Teamnum == "B" & poss == "B52") 
 
B53 <- passline %>% filter(Teamnum == "B" & poss == "B53") 
 
B54 <- passline %>% filter(Teamnum == "B" & poss == "B54") 
 
B55 <- passline %>% filter(Teamnum == "B" & poss == "B55") 
 
B56 <- passline %>% filter(Teamnum == "B" & poss == "B56") 
 
B57 <- passline %>% filter(Teamnum == "B" & poss == "B57") 
 
B58 <- passline %>% filter(Teamnum == "B" & poss == "B58") 
 
B59 <- passline %>% filter(Teamnum == "B" & poss == "B59") 
 
B60 <- passline %>% filter(Teamnum == "B" & poss == "B60") 
 
B61 <- passline %>% filter(Teamnum == "B" & poss == "B61") 
 
B62 <- passline %>% filter(Teamnum == "B" & poss == "B62") 
 
B63 <- passline %>% filter(Teamnum == "B" & poss == "B63") 
 
B64 <- passline %>% filter(Teamnum == "B" & poss == "B64") 
 
B65 <- passline %>% filter(Teamnum == "B" & poss == "B65") 
 
B66 <- passline %>% filter(Teamnum == "B" & poss == "B66") 
 
B67 <- passline %>% filter(Teamnum == "B" & poss == "B67") 
 
B68 <- passline %>% filter(Teamnum == "B" & poss == "B68") 
 
B69 <- passline %>% filter(Teamnum == "B" & poss == "B69") 
 
B70 <- passline %>% filter(Teamnum == "B" & poss == "B70") 
 
B71 <- passline %>% filter(Teamnum == "B" & poss == "B71") 
 
B72 <- passline %>% filter(Teamnum == "B" & poss == "B72") 
 
B73 <- passline %>% filter(Teamnum == "B" & poss == "B73") 
 
B74 <- passline %>% filter(Teamnum == "B" & poss == "B74") 
 
B75 <- passline %>% filter(Teamnum == "B" & poss == "B75") 
 
B76 <- passline %>% filter(Teamnum == "B" & poss == "B76") 
 
B77 <- passline %>% filter(Teamnum == "B" & poss == "B77") 
 
B78 <- passline %>% filter(Teamnum == "B" & poss == "B78") 
 
B79 <- passline %>% filter(Teamnum == "B" & poss == "B79") 
 
B80 <- passline %>% filter(Teamnum == "B" & poss == "B80") 
 
B81 <- passline %>% filter(Teamnum == "B" & poss == "B81") 
 
B82 <- passline %>% filter(Teamnum == "B" & poss == "B82") 
 
B83 <- passline %>% filter(Teamnum == "B" & poss == "B83") 
 
B84 <- passline %>% filter(Teamnum == "B" & poss == "B84") 
 
B85 <- passline %>% filter(Teamnum == "B" & poss == "B85") 
 
B86 <- passline %>% filter(Teamnum == "B" & poss == "B86") 
 
B87 <- passline %>% filter(Teamnum == "B" & poss == "B87") 
 
B88 <- passline %>% filter(Teamnum == "B" & poss == "B88") 
 
B89 <- passline %>% filter(Teamnum == "B" & poss == "B89") 
 
B90 <- passline %>% filter(Teamnum == "B" & poss == "B90") 
 
B91 <- passline %>% filter(Teamnum == "B" & poss == "B91") 
 
B92 <- passline %>% filter(Teamnum == "B" & poss == "B92") 
 
B93 <- passline %>% filter(Teamnum == "B" & poss == "B93") 
 
B94 <- passline %>% filter(Teamnum == "B" & poss == "B94") 
 
B95 <- passline %>% filter(Teamnum == "B" & poss == "B95") 
 
B96 <- passline %>% filter(Teamnum == "B" & poss == "B96") 
 
B97 <- passline %>% filter(Teamnum == "B" & poss == "B97") 
 
B98 <- passline %>% filter(Teamnum == "B" & poss == "B98") 
 
B99 <- passline %>% filter(Teamnum == "B" & poss == "B99") 
 
B100 <- passline %>% filter(Teamnum == "B" & poss == "B100")

actcolpal <- c(
  "20" = "grey",
  "1" = "black", 
  "2" = "blue", 
  "3" = "red",
  "4" = "purple",
  "5" =  "yellow",
  "6" = "white",
  "7" = "orange",
  "8" = "pink")

runlinepal <- c(
  "20" = 2,
  "1" = 1, 
  "2" = 1, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 1,
  "7" = 1,
  "8" = 1,
  "9" = 1,
  "10"= 1)


p + 
geom_path(data = B1, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B2, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B3, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B4, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B5, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B6, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B7, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B8, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B9, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B10, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B11, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B12, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B13, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B14, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B15, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B16, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B17, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B18, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B19, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B20, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B21, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B22, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B23, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B24, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B25, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B26, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B27, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B28, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B29, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B30, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B31, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B32, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B33, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B34, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B35, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B36, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B37, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B38, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B39, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B40, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B41, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B42, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B43, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B44, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B45, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B46, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B47, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B48, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B49, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B50, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B51, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B52, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B53, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B54, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B55, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B56, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B57, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B58, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B59, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B60, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B61, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B62, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B63, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B64, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B65, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B66, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B67, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B68, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B69, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B70, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B71, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B72, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B73, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B74, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B75, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B76, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B77, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B78, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B79, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B80, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B81, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B82, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B83, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B84, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B85, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B86, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B87, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B88, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B89, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B90, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B91, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B92, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B93, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B94, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B95, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B96, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B97, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B98, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B99, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
 
geom_path(data = B100, aes(x=Areax, y=Areay, colour = as.factor(Bsht) , linetype= as.factor(Bsht)), size = 0.8) + 
theme(legend.position="none") +
scale_colour_manual(values = actcolpal) +
scale_linetype_manual(values = runlinepal) +
geom_point(data = passPW, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "white", shape = 16) +
geom_text(data = passPW, aes(x=Areax, y=Areay, label = possno),colour = "black") +
geom_point(data = passRs, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "blue", shape = 16) +
geom_text(data = passRs, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passFk, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "Purple", shape = 16) +
geom_text(data = passFk, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passOp, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "red", shape = 16) +
geom_text(data = passOp, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passKo, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "black", shape = 16) +
geom_text(data = passKo, aes(x=Areax, y=Areay, label = possno),colour = "white") +
  geom_point(data = pass45, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "darkgreen", shape = 16) +
geom_text(data = pass45, aes(x=Areax, y=Areay, label = possno),colour = "white")
  


```

##Score Possessions
###St Judes
```{r, fig.width = 16, fig.height = 14}

passline <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passlinejudbod.csv", header=TRUE, sep=";")
attach (passline)

passline <- passline[passline$Ascr!="20", ]

passPW <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main =="PW")
passKo <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Ko Rec")
passRs <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Pass Rs")
passFk <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Shot Rs")
passOp <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "A",main=="Shot Op")


A1 <- passline %>% filter(Teamnum == "A" & poss == "A1") 
A2 <- passline %>% filter(Teamnum == "A" & poss == "A2") 
A3 <- passline %>% filter(Teamnum == "A" & poss == "A3") 
A4 <- passline %>% filter(Teamnum == "A" & poss == "A4") 
A5 <- passline %>% filter(Teamnum == "A" & poss == "A5") 
A6 <- passline %>% filter(Teamnum == "A" & poss == "A6") 
A7 <- passline %>% filter(Teamnum == "A" & poss == "A7") 
A8 <- passline %>% filter(Teamnum == "A" & poss == "A8") 
A9 <- passline %>% filter(Teamnum == "A" & poss == "A9") 
A10 <- passline %>% filter(Teamnum == "A" & poss == "A10") 
A11 <- passline %>% filter(Teamnum == "A" & poss == "A11") 
A12 <- passline %>% filter(Teamnum == "A" & poss == "A12") 
A13 <- passline %>% filter(Teamnum == "A" & poss == "A13") 
A14 <- passline %>% filter(Teamnum == "A" & poss == "A14") 
A15 <- passline %>% filter(Teamnum == "A" & poss == "A15") 
A16 <- passline %>% filter(Teamnum == "A" & poss == "A16") 
A17 <- passline %>% filter(Teamnum == "A" & poss == "A17") 
A18 <- passline %>% filter(Teamnum == "A" & poss == "A18") 
A19 <- passline %>% filter(Teamnum == "A" & poss == "A19") 
A20 <- passline %>% filter(Teamnum == "A" & poss == "A20") 
A21 <- passline %>% filter(Teamnum == "A" & poss == "A21") 
A22 <- passline %>% filter(Teamnum == "A" & poss == "A22") 
A23 <- passline %>% filter(Teamnum == "A" & poss == "A23") 
A24 <- passline %>% filter(Teamnum == "A" & poss == "A24") 
A25 <- passline %>% filter(Teamnum == "A" & poss == "A25") 
A26 <- passline %>% filter(Teamnum == "A" & poss == "A26") 
A27 <- passline %>% filter(Teamnum == "A" & poss == "A27") 
A28 <- passline %>% filter(Teamnum == "A" & poss == "A28") 
A29 <- passline %>% filter(Teamnum == "A" & poss == "A29") 
A30 <- passline %>% filter(Teamnum == "A" & poss == "A30") 
A31 <- passline %>% filter(Teamnum == "A" & poss == "A31") 
A32 <- passline %>% filter(Teamnum == "A" & poss == "A32") 
A33 <- passline %>% filter(Teamnum == "A" & poss == "A33") 
A34 <- passline %>% filter(Teamnum == "A" & poss == "A34") 
A35 <- passline %>% filter(Teamnum == "A" & poss == "A35") 
A36 <- passline %>% filter(Teamnum == "A" & poss == "A36") 
A37 <- passline %>% filter(Teamnum == "A" & poss == "A37") 
A38 <- passline %>% filter(Teamnum == "A" & poss == "A38") 
A39 <- passline %>% filter(Teamnum == "A" & poss == "A39") 
A40 <- passline %>% filter(Teamnum == "A" & poss == "A40") 
A41 <- passline %>% filter(Teamnum == "A" & poss == "A41") 
A42 <- passline %>% filter(Teamnum == "A" & poss == "A42") 
A43 <- passline %>% filter(Teamnum == "A" & poss == "A43") 
A44 <- passline %>% filter(Teamnum == "A" & poss == "A44") 
A45 <- passline %>% filter(Teamnum == "A" & poss == "A45") 
A46 <- passline %>% filter(Teamnum == "A" & poss == "A46") 
A47 <- passline %>% filter(Teamnum == "A" & poss == "A47") 
A48 <- passline %>% filter(Teamnum == "A" & poss == "A48") 
A49 <- passline %>% filter(Teamnum == "A" & poss == "A49") 
A50 <- passline %>% filter(Teamnum == "A" & poss == "A50") 
A51 <- passline %>% filter(Teamnum == "A" & poss == "A51") 
A52 <- passline %>% filter(Teamnum == "A" & poss == "A52") 
A53 <- passline %>% filter(Teamnum == "A" & poss == "A53") 
A54 <- passline %>% filter(Teamnum == "A" & poss == "A54") 
A55 <- passline %>% filter(Teamnum == "A" & poss == "A55") 
A56 <- passline %>% filter(Teamnum == "A" & poss == "A56") 
A57 <- passline %>% filter(Teamnum == "A" & poss == "A57") 
A58 <- passline %>% filter(Teamnum == "A" & poss == "A58") 
A59 <- passline %>% filter(Teamnum == "A" & poss == "A59") 
A60 <- passline %>% filter(Teamnum == "A" & poss == "A60") 
A61 <- passline %>% filter(Teamnum == "A" & poss == "A61") 
A62 <- passline %>% filter(Teamnum == "A" & poss == "A62") 
A63 <- passline %>% filter(Teamnum == "A" & poss == "A63") 
A64 <- passline %>% filter(Teamnum == "A" & poss == "A64") 
A65 <- passline %>% filter(Teamnum == "A" & poss == "A65") 
A66 <- passline %>% filter(Teamnum == "A" & poss == "A66") 
A67 <- passline %>% filter(Teamnum == "A" & poss == "A67") 
A68 <- passline %>% filter(Teamnum == "A" & poss == "A68") 
A69 <- passline %>% filter(Teamnum == "A" & poss == "A69") 
A70 <- passline %>% filter(Teamnum == "A" & poss == "A70") 
A71 <- passline %>% filter(Teamnum == "A" & poss == "A71") 
A72 <- passline %>% filter(Teamnum == "A" & poss == "A72") 
A73 <- passline %>% filter(Teamnum == "A" & poss == "A73") 
A74 <- passline %>% filter(Teamnum == "A" & poss == "A74") 
A75 <- passline %>% filter(Teamnum == "A" & poss == "A75") 
A76 <- passline %>% filter(Teamnum == "A" & poss == "A76") 
A77 <- passline %>% filter(Teamnum == "A" & poss == "A77") 
A78 <- passline %>% filter(Teamnum == "A" & poss == "A78") 
A79 <- passline %>% filter(Teamnum == "A" & poss == "A79") 
A80 <- passline %>% filter(Teamnum == "A" & poss == "A80") 
A81 <- passline %>% filter(Teamnum == "A" & poss == "A81") 
A82 <- passline %>% filter(Teamnum == "A" & poss == "A82") 
A83 <- passline %>% filter(Teamnum == "A" & poss == "A83") 
A84 <- passline %>% filter(Teamnum == "A" & poss == "A84") 
A85 <- passline %>% filter(Teamnum == "A" & poss == "A85") 
A86 <- passline %>% filter(Teamnum == "A" & poss == "A86") 
A87 <- passline %>% filter(Teamnum == "A" & poss == "A87") 
A88 <- passline %>% filter(Teamnum == "A" & poss == "A88") 
A89 <- passline %>% filter(Teamnum == "A" & poss == "A89") 
A90 <- passline %>% filter(Teamnum == "A" & poss == "A90") 
A91 <- passline %>% filter(Teamnum == "A" & poss == "A91") 
A92 <- passline %>% filter(Teamnum == "A" & poss == "A92") 
A93 <- passline %>% filter(Teamnum == "A" & poss == "A93") 
A94 <- passline %>% filter(Teamnum == "A" & poss == "A94") 
A95 <- passline %>% filter(Teamnum == "A" & poss == "A95") 
A96 <- passline %>% filter(Teamnum == "A" & poss == "A96") 
A97 <- passline %>% filter(Teamnum == "A" & poss == "A97") 
A98 <- passline %>% filter(Teamnum == "A" & poss == "A98") 
A99 <- passline %>% filter(Teamnum == "A" & poss == "A99") 
A100 <- passline %>% filter(Teamnum == "A" & poss == "A100") 

actcolpal <- c(
  "20" = "grey",
  "1" = "black", 
  "2" = "blue", 
  "3" = "red",
  "4" = "purple",
  "5" =  "yellow",
  "6" = "white",
  "7" = "orange",
  "8" = "pink")

runlinepal <- c(
  "20" = 2,
  "1" = 1, 
  "2" = 1, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 1,
  "7" = 1,
  "8" = 1,
  "9" = 1,
  "10"= 1)


p + 
geom_path(data = A1, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A2, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A3, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A4, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A5, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A6, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A7, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A8, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A9, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A10, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A11, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A12, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A13, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A14, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A15, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A16, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A17, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A18, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A19, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A20, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A21, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A22, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A23, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A24, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A25, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A26, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A27, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A28, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A29, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A30, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A31, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A32, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A33, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A34, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A35, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A36, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A37, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A38, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A39, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A40, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A41, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A42, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A43, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A44, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A45, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A46, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A47, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A48, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A49, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A50, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A51, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A52, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A53, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A54, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A55, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A56, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A57, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A58, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A59, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A60, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A61, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A62, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A63, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A64, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A65, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A66, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A67, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A68, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A69, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A70, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A71, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A72, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A73, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A74, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A75, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A76, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A77, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A78, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A79, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A80, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A81, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A82, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A83, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A84, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A85, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A86, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A87, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A88, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A89, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A90, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A91, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A92, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A93, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A94, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A95, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A96, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A97, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A98, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A99, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
geom_path(data = A100, aes(x=Areax, y=Areay, colour = as.factor(Ascr) , linetype= as.factor(Ascr)), size = 0.8) + 
theme(legend.position="none") +
scale_colour_manual(values = actcolpal) +
scale_linetype_manual(values = runlinepal) +
geom_point(data = passPW, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "white", shape = 16) +
geom_text(data = passPW, aes(x=Areax, y=Areay, label = possno),colour = "black") +
geom_point(data = passRs, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "blue", shape = 16) +
geom_text(data = passRs, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passOp, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "red", shape = 16) +
geom_text(data = passOp, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passKo, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "black", shape = 16) +
geom_text(data = passKo, aes(x=Areax, y=Areay, label = possno),colour = "white") +
  geom_point(data = passFk, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "purple", shape = 16) +
geom_text(data = passFk, aes(x=Areax, y=Areay, label = possno),colour = "white") 


```

###Ballyboden
```{r, fig.width = 16, fig.height = 14}

passline <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passlinejudbod.csv", header=TRUE, sep=";")
attach (passline)

passline <- passline[passline$Bscr!="20", ]

passPW <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main =="PW")
passKo <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Ko Rec")
passRs <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Pass Rs")
passFk <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Shot Rs")
passOp <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="Shot Op")
pass45 <- passline %>%group_by(Team, Action) %>% filter(Teamnum == "B",main=="45")

B1 <- passline %>% filter(Teamnum == "B" & poss == "B1") 
 
B2 <- passline %>% filter(Teamnum == "B" & poss == "B2") 
 
B3 <- passline %>% filter(Teamnum == "B" & poss == "B3") 
 
B4 <- passline %>% filter(Teamnum == "B" & poss == "B4") 
 
B5 <- passline %>% filter(Teamnum == "B" & poss == "B5") 
 
B6 <- passline %>% filter(Teamnum == "B" & poss == "B6") 
 
B7 <- passline %>% filter(Teamnum == "B" & poss == "B7") 
 
B8 <- passline %>% filter(Teamnum == "B" & poss == "B8") 
 
B9 <- passline %>% filter(Teamnum == "B" & poss == "B9") 
 
B10 <- passline %>% filter(Teamnum == "B" & poss == "B10") 
 
B11 <- passline %>% filter(Teamnum == "B" & poss == "B11") 
 
B12 <- passline %>% filter(Teamnum == "B" & poss == "B12") 
 
B13 <- passline %>% filter(Teamnum == "B" & poss == "B13") 
 
B14 <- passline %>% filter(Teamnum == "B" & poss == "B14") 
 
B15 <- passline %>% filter(Teamnum == "B" & poss == "B15") 
 
B16 <- passline %>% filter(Teamnum == "B" & poss == "B16") 
 
B17 <- passline %>% filter(Teamnum == "B" & poss == "B17") 
 
B18 <- passline %>% filter(Teamnum == "B" & poss == "B18") 
 
B19 <- passline %>% filter(Teamnum == "B" & poss == "B19") 
 
B20 <- passline %>% filter(Teamnum == "B" & poss == "B20") 
 
B21 <- passline %>% filter(Teamnum == "B" & poss == "B21") 
 
B22 <- passline %>% filter(Teamnum == "B" & poss == "B22") 
 
B23 <- passline %>% filter(Teamnum == "B" & poss == "B23") 
 
B24 <- passline %>% filter(Teamnum == "B" & poss == "B24") 
 
B25 <- passline %>% filter(Teamnum == "B" & poss == "B25") 
 
B26 <- passline %>% filter(Teamnum == "B" & poss == "B26") 
 
B27 <- passline %>% filter(Teamnum == "B" & poss == "B27") 
 
B28 <- passline %>% filter(Teamnum == "B" & poss == "B28") 
 
B29 <- passline %>% filter(Teamnum == "B" & poss == "B29") 
 
B30 <- passline %>% filter(Teamnum == "B" & poss == "B30") 
 
B31 <- passline %>% filter(Teamnum == "B" & poss == "B31") 
 
B32 <- passline %>% filter(Teamnum == "B" & poss == "B32") 
 
B33 <- passline %>% filter(Teamnum == "B" & poss == "B33") 
 
B34 <- passline %>% filter(Teamnum == "B" & poss == "B34") 
 
B35 <- passline %>% filter(Teamnum == "B" & poss == "B35") 
 
B36 <- passline %>% filter(Teamnum == "B" & poss == "B36") 
 
B37 <- passline %>% filter(Teamnum == "B" & poss == "B37") 
 
B38 <- passline %>% filter(Teamnum == "B" & poss == "B38") 
 
B39 <- passline %>% filter(Teamnum == "B" & poss == "B39") 
 
B40 <- passline %>% filter(Teamnum == "B" & poss == "B40") 
 
B41 <- passline %>% filter(Teamnum == "B" & poss == "B41") 
 
B42 <- passline %>% filter(Teamnum == "B" & poss == "B42") 
 
B43 <- passline %>% filter(Teamnum == "B" & poss == "B43") 
 
B44 <- passline %>% filter(Teamnum == "B" & poss == "B44") 
 
B45 <- passline %>% filter(Teamnum == "B" & poss == "B45") 
 
B46 <- passline %>% filter(Teamnum == "B" & poss == "B46") 
 
B47 <- passline %>% filter(Teamnum == "B" & poss == "B47") 
 
B48 <- passline %>% filter(Teamnum == "B" & poss == "B48") 
 
B49 <- passline %>% filter(Teamnum == "B" & poss == "B49") 
 
B50 <- passline %>% filter(Teamnum == "B" & poss == "B50") 
 
B51 <- passline %>% filter(Teamnum == "B" & poss == "B51") 
 
B52 <- passline %>% filter(Teamnum == "B" & poss == "B52") 
 
B53 <- passline %>% filter(Teamnum == "B" & poss == "B53") 
 
B54 <- passline %>% filter(Teamnum == "B" & poss == "B54") 
 
B55 <- passline %>% filter(Teamnum == "B" & poss == "B55") 
 
B56 <- passline %>% filter(Teamnum == "B" & poss == "B56") 
 
B57 <- passline %>% filter(Teamnum == "B" & poss == "B57") 
 
B58 <- passline %>% filter(Teamnum == "B" & poss == "B58") 
 
B59 <- passline %>% filter(Teamnum == "B" & poss == "B59") 
 
B60 <- passline %>% filter(Teamnum == "B" & poss == "B60") 
 
B61 <- passline %>% filter(Teamnum == "B" & poss == "B61") 
 
B62 <- passline %>% filter(Teamnum == "B" & poss == "B62") 
 
B63 <- passline %>% filter(Teamnum == "B" & poss == "B63") 
 
B64 <- passline %>% filter(Teamnum == "B" & poss == "B64") 
 
B65 <- passline %>% filter(Teamnum == "B" & poss == "B65") 
 
B66 <- passline %>% filter(Teamnum == "B" & poss == "B66") 
 
B67 <- passline %>% filter(Teamnum == "B" & poss == "B67") 
 
B68 <- passline %>% filter(Teamnum == "B" & poss == "B68") 
 
B69 <- passline %>% filter(Teamnum == "B" & poss == "B69") 
 
B70 <- passline %>% filter(Teamnum == "B" & poss == "B70") 
 
B71 <- passline %>% filter(Teamnum == "B" & poss == "B71") 
 
B72 <- passline %>% filter(Teamnum == "B" & poss == "B72") 
 
B73 <- passline %>% filter(Teamnum == "B" & poss == "B73") 
 
B74 <- passline %>% filter(Teamnum == "B" & poss == "B74") 
 
B75 <- passline %>% filter(Teamnum == "B" & poss == "B75") 
 
B76 <- passline %>% filter(Teamnum == "B" & poss == "B76") 
 
B77 <- passline %>% filter(Teamnum == "B" & poss == "B77") 
 
B78 <- passline %>% filter(Teamnum == "B" & poss == "B78") 
 
B79 <- passline %>% filter(Teamnum == "B" & poss == "B79") 
 
B80 <- passline %>% filter(Teamnum == "B" & poss == "B80") 
 
B81 <- passline %>% filter(Teamnum == "B" & poss == "B81") 
 
B82 <- passline %>% filter(Teamnum == "B" & poss == "B82") 
 
B83 <- passline %>% filter(Teamnum == "B" & poss == "B83") 
 
B84 <- passline %>% filter(Teamnum == "B" & poss == "B84") 
 
B85 <- passline %>% filter(Teamnum == "B" & poss == "B85") 
 
B86 <- passline %>% filter(Teamnum == "B" & poss == "B86") 
 
B87 <- passline %>% filter(Teamnum == "B" & poss == "B87") 
 
B88 <- passline %>% filter(Teamnum == "B" & poss == "B88") 
 
B89 <- passline %>% filter(Teamnum == "B" & poss == "B89") 
 
B90 <- passline %>% filter(Teamnum == "B" & poss == "B90") 
 
B91 <- passline %>% filter(Teamnum == "B" & poss == "B91") 
 
B92 <- passline %>% filter(Teamnum == "B" & poss == "B92") 
 
B93 <- passline %>% filter(Teamnum == "B" & poss == "B93") 
 
B94 <- passline %>% filter(Teamnum == "B" & poss == "B94") 
 
B95 <- passline %>% filter(Teamnum == "B" & poss == "B95") 
 
B96 <- passline %>% filter(Teamnum == "B" & poss == "B96") 
 
B97 <- passline %>% filter(Teamnum == "B" & poss == "B97") 
 
B98 <- passline %>% filter(Teamnum == "B" & poss == "B98") 
 
B99 <- passline %>% filter(Teamnum == "B" & poss == "B99") 
 
B100 <- passline %>% filter(Teamnum == "B" & poss == "B100") 

actcolpal <- c(
  "20" = "grey",
  "1" = "black", 
  "2" = "blue", 
  "3" = "red",
  "4" = "purple",
  "5" =  "yellow",
  "6" = "white",
  "7" = "orange",
  "8" = "pink")

runlinepal <- c(
  "20" = 2,
  "1" = 1, 
  "2" = 1, 
  "3" = 1,
  "4" = 1,
  "5" = 1,
  "6" = 1,
  "7" = 1,
  "8" = 1,
  "9" = 1,
  "10"= 1)

p + 
geom_path(data = B1, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B2, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B3, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B4, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B5, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B6, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B7, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B8, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B9, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B10, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B11, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B12, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B13, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B14, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B15, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B16, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B17, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B18, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B19, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B20, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B21, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B22, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B23, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B24, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B25, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B26, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B27, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B28, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B29, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B30, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B31, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B32, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B33, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B34, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B35, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B36, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B37, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B38, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B39, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B40, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B41, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B42, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B43, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B44, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B45, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B46, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B47, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B48, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B49, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B50, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B51, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B52, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B53, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B54, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B55, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B56, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B57, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B58, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B59, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B60, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B61, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B62, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B63, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B64, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B65, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B66, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B67, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B68, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B69, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B70, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B71, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B72, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B73, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B74, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B75, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B76, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B77, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B78, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B79, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B80, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B81, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B82, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B83, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B84, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B85, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B86, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B87, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B88, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B89, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B90, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B91, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B92, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B93, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B94, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B95, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B96, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B97, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B98, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B99, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 
geom_path(data = B100, aes(x=Areax, y=Areay, colour = as.factor(Bscr) , linetype= as.factor(Bscr)), size = 0.8) + 
 theme(legend.position="none") +
scale_colour_manual(values = actcolpal) +
scale_linetype_manual(values = runlinepal) +
geom_point(data = passPW, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "white", shape = 16) +
geom_text(data = passPW, aes(x=Areax, y=Areay, label = possno),colour = "black") +
geom_point(data = passOp, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "red", shape = 16) +
geom_text(data = passOp, aes(x=Areax, y=Areay, label = possno),colour = "white") +
geom_point(data = passKo, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "black", shape = 16) +
geom_text(data = passKo, aes(x=Areax, y=Areay, label = possno),colour = "white") +
  geom_point(data = passFk, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "purple", shape = 16) +
geom_text(data = passFk, aes(x=Areax, y=Areay, label = possno),colour = "white") +
  geom_point(data = pass45, aes(x=Areax, y=Areay, stroke = 1), size = 7, colour = "darkgreen", shape = 16) +
geom_text(data = pass45, aes(x=Areax, y=Areay, label = possno),colour = "white")

```



##Open Play Shots - Location & Outcome 

```{r, include=FALSE, message=FALSE, warning=FALSE}
colshotvertpal <- c(
"Goal"= "white",
"Point"= "black",
"Wide Left"="purple",
"Wide Right"="#FF6347",
"Save"="#FFFF00",
"Blkd"="#00FFFF",
"Short"="#FF00FF",
"Post"="darkblue",
"Fk Goal"= "#FFFFFF",
"Fk Point"="#800000",
"Fk Wide Left"="#808000",
"Fk Wide Right"="#D2691E",
"Fk Save"="#800080",
"Fk Short"="#008080",
"Fk Post"="#000080",
"45 Goal"="#FFFFFF",
"45 Point"="darkred",
"45 Wide Left"="#808080",
"45 Wide Right"="#000000",
"45 Save"="#FF0000",
"45 Short"="#800000",
"45 Post"="yellow",
"Pen Goal" ="#619CFF",
"Pen Point"="#00BA38",
"Pen Wide Left"="#F8766D",
"Pen Wide Right"="#FF9326",
"Pen Save"="#FFFF4D",
"Pen Post"="#21D921",
"Mk Goal"="#D92121",
"Mk Point"="blue",
"Mk Wide Left"="gold",
"Mk Wide Right"="orange",
"Mk Short"="red",
"Mk Save"="#2121D9")

```

###St Judes

```{r}

OPA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="Shot Op Oc")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- OPA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_OPA <- paste0("Total Op Shots: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Open Play Shots",  # Add the title and subtitle
          subtitle = total_OPA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 14}
shotsA <- scrd  %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action=="Shot Right"| Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch")

p + geom_point(data = shotsA, aes(x=Areax, y=Areay, colour = octype, size = 8, shape = Action, stroke = 1.5)) + 
 scale_colour_manual(values = colshotvertpal) +
  geom_text_repel(data = shotsA, aes(x=Areax, y=Areay, label = plylabrec, col = octype), size = 8) +
    scale_shape_manual(values = 0:18) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12)))
```

###Shot Efficiency - St Judes
```{r, fig.width = 16, fig.height = 10}
shotsA <- shots %>% filter(Teamnum== "A", yes == "2")

sp + geom_text(data= shotsA, aes(x= tx, y= ty, label = Scrd),colour = "blue", size = 9) +
geom_text(data= shotsA, aes(x= bx, y= by, label = Scr),colour = "blue", size = 7)
```

###Shot Pressure - St Judes

```{r, fig.width = 16, fig.height = 14}

colshotpal <- c(
"1"= "white",
"2"= "yellow",
"3"="red")

shotsA <- scrd  %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action=="Shot Right"| Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch")

p + geom_point(data = shotsA, aes(x=Areax, y=Areay, colour = as.factor(shdf), size = 8, shape = Action, stroke = 1.5)) + 
 scale_colour_manual(values = colshotpal) +
  geom_text_repel(data = shotsA, aes(x=Areax, y=Areay, label = plylabrec, col = as.factor(shdf)), size = 8) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12))) +
  ggtitle("White = no pressure, yelow = light/late pressure, red = heavy pressure")
```

###Shot Density
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "A",main == "Shot Op")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main,colour = main),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

###Ballyboden
```{r}

OPB <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", main =="Shot Op Oc")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- OPB %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_OPB <- paste0("Total Op Shots: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("Open Play Shots",  # Add the title and subtitle
          subtitle = total_OPB) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 14}

shotsB <- scrd  %>%group_by(Team, Action) %>% filter(Teamnum == "B", Action=="Shot Right"|Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch")

p + geom_point(data = shotsB, aes(x=Areax, y=Areay, colour =octype , size = 8, shape = Action, stroke = 1.5)) + 
   scale_colour_manual(values = colshotvertpal) +
  geom_text_repel(data = shotsB, aes(x=Areax, y=Areay, label = plylabrec, col = octype), size = 8) +
    scale_shape_manual(values = 0:18) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12)))

```

###Shot Efficiency - Ballyboden
```{r, fig.width = 16, fig.height = 10}
shotsB <- shots %>% filter(Teamnum== "B", yes == "2")

sp + geom_text(data= shotsB, aes(x= tx, y= ty, label = Scrd),colour = "blue", size = 9) +
geom_text(data= shotsB, aes(x= bx, y= by, label = Scr),colour = "blue", size = 7)
```

###Shot Density
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "B",main == "Shot Op")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main,colour = main),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

###Shot Pressure - Ballyboden

```{r, fig.width = 16, fig.height = 14}

colshotpal <- c(
"1"= "white",
"2"= "yellow",
"3"="red")

shotsB <- scrd  %>%group_by(Team, Action) %>% filter(Teamnum == "B", Action=="Shot Right"| Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch")

p + geom_point(data = shotsB, aes(x=Areax, y=Areay, colour = as.factor(shdf), size = 8, shape = Action, stroke = 1.5)) + 
 scale_colour_manual(values = colshotpal) +
  geom_text_repel(data = shotsB, aes(x=Areax, y=Areay, label = plylabrec, col = as.factor(shdf)), size = 8) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12))) +
  ggtitle("White = no pressure, yelow = light/late pressure, red = heavy pressure")
```

##All Shots - Location & Outcome 
###St Judes
```{r}

ASA <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", main =="Shot Op Oc"| main == "Shot Rs Oc")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ASA %>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ASA <- paste0("All Shots: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("All Shots",  # Add the title and subtitle
          subtitle = total_ASA) +   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() +
theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 14}
shotsA <- scrd %>%group_by(Team, Action) %>% filter(Teamnum == "A", Action=="Shot Right"| Action =="Shot Left"| Action =="Hp Shot"| Action =="Punch"|Action =="Fk Shot Right"| Action =="Fk Shot Left"
|Action=="Mk Shot Right"| Action =="Mk Shot Left"|Action =="45 Shot Right"| Action =="45 Shot Left")

p + geom_point(data = shotsA, aes(x=Areax, y=Areay, colour = octype, size = 8, shape = Action, stroke = 1.5)) + 
   scale_colour_manual(values = colshotvertpal) +
  geom_text_repel(data = shotsA, aes(x=Areax, y=Areay, label = plylabrec, col = octype), size = 8) +
    scale_shape_manual(values = 0:18) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12)))
```

###All Shot Density
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "A",main == "Shot Op"|main == "Shot Rs")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main,colour = main),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

###Free Kick Shot Efficiency - St Judes
```{r, fig.width = 16, fig.height = 10}
RSshotsA <- rseff %>% filter(Teamnum== "A", yes == "2")

sp + geom_text(data= RSshotsA, aes(x= tx, y= ty, label = Scrd),colour = "blue", size = 9) +
geom_text(data= RSshotsA, aes(x= bx, y= by, label = Scr),colour = "blue", size = 7)
```

###Ballyboden
```{r}

ASB<- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", main =="Shot Op Oc"| main == "Shot Rs Oc")%>%summarize(count=n())

my_theme <- function(){
  theme_light() +
    theme(text = element_text(),  
          panel.grid = element_blank(),
          panel.border = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_text(size = 15, color = "gray10"),
          plot.title =  element_text(size = 20, color = "black"))
  }

final_data <- ASB%>% 
  # Calculate -- and format -- the percentage for each channel
  mutate(bar_percentage = sprintf("%.1f%%", 100*(count / sum(.$count)))) %>% 
  # Combine that percentage with the actual value
  mutate(bar_label = paste0(format(count, big.mark = ","), ", ", bar_percentage)) %>% 
  # Remove the "just the percentage" column
  select(-bar_percentage)


total_ASB<- paste0("All Shots: ",
                      format(sum(final_data$count), big.mark = ","))


ggplot(final_data, aes(x = Action, y = count)) +
ggtitle("All Shots",  # Add the title and subtitle
          subtitle = total_ASB)+   
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = 0.50) +  
geom_text(aes(label = bar_label, size = 5.5, hjust = 0)) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, max(final_data$count) * 1.3)) +
  my_theme() + theme(legend.position="none", plot.title =  element_text(size = 20, color = "black"),plot.subtitle =  element_text(size = 18, color = "black"))
```

```{r, fig.width = 16, fig.height = 14}

shotsB <- scrd  %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset =="Shot Op"|subset == "Shot Rs")

p + geom_point(data = shotsB, aes(x=Areax, y=Areay, colour =octype , size = 8, shape = Action, stroke = 1.5)) + 
   scale_colour_manual(values = colshotvertpal) +
  geom_text_repel(data = shotsB, aes(x=Areax, y=Areay, label = plylabrec, col = octype), size = 8) +
    scale_shape_manual(values = 0:18) +
    theme(legend.position="bottom", legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
    theme(plot.title = element_text(hjust=0.5)) +
    theme(plot.subtitle = element_text(hjust=0.5)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 12)))

```

###All Shot Density
```{r, fig.width = 16, fig.height = 10}

Dubden <- pass %>%group_by(Player, main)%>%filter( Teamnum == "B",main == "Shot Op"|main == "Shot Rs")

p  +  geom_density_2d(data = Dubden, aes(x=Areax, y=Areay),colour = "blue") +
    geom_point(data = Dubden, aes(x=Areax, y=Areay, shape= main,colour = main),size = 4,stroke = 2)+ 
    theme_classic () +  
    theme(axis.title.x=element_blank(),
          axis.ticks.x=element_blank(), 
          axis.title.y=element_blank(), 
          axis.text.y=element_blank(), 
          axis.ticks.y=element_blank(),
          axis.text.x=element_blank(),
          line = element_blank(),
          legend.position="bottom",legend.title=element_text(size=15), 
          legend.text=element_text(size=20)) +
  scale_shape_manual(values = 0:18) +
  guides(color = FALSE)

```

###Free Kick Shot Efficiency - Ballyboden
```{r, fig.width = 16, fig.height = 10}
RSshotsB <- rseff %>% filter(Teamnum== "B", yes == "2")

sp + geom_text(data= RSshotsB, aes(x= tx, y= ty, label = Scrd),colour = "blue", size = 9) +
geom_text(data= RSshotsB, aes(x= bx, y= by, label = Scr),colour = "blue", size = 7)
```

##All Shots Origin by Possession
###St Judes (Blue = Score)
```{r, fig.width = 16, fig.height = 10}

#Finds all shots

TeamAPAScr  <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset== "Scr Op"|subset== "Scr Rs")

TeamAPAMis <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset== "Ms Op"|subset== "Ms Rs")

#Pulls out all shots from main TeamA
TeamAPASc <- subset(pass, poss %in% TeamAPAScr$poss)

TeamAPAMi <- subset(pass, poss %in% TeamAPAMis$poss)

#Ones that start from turnover
TeamAphasePASccq <- TeamAPASc %>% filter(main == "PW")

TeamAphasePAMicq <- TeamAPAMi %>% filter(main == "PW")

#Ones that start from kickout

TeamAphasePAScko <- TeamAPASc %>% filter(main == "Ko Rec")

TeamAphasePAMiko <- TeamAPAMi %>% filter(main == "Ko Rec")

p + geom_point(data = TeamAphasePASccq , aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphasePAMicq, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamAphasePAScko, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphasePAMiko, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
theme(legend.position = "bottom") + 
geom_text_repel(data = TeamAphasePASccq , aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) +
geom_text_repel(data = TeamAphasePAMicq, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) +
geom_text_repel(data = TeamAphasePAScko, aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) + 
geom_text_repel(data = TeamAphasePAMiko, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) 
```

###Ballyboden (Blue = Score)
```{r, fig.width = 16, fig.height = 10}
#Finds all shots

TeamBPAScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset== "Scr Op"|subset== "Scr Rs")

TeamBPAMis <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset== "Ms Op"|subset== "Ms Rs")

#Pulls out all shots from main TeamB
TeamBPASc <- subset(pass, poss %in% TeamBPAScr$poss)

TeamBPAMi <- subset(pass, poss %in% TeamBPAMis$poss)

#Ones that start from turnover
TeamBphasePASccq <- TeamBPASc %>% filter(main == "PW")

TeamBphasePAMicq <- TeamBPAMi %>% filter(main == "PW")

#Ones that start from kickout

TeamBphasePAScko <- TeamBPASc %>% filter(main =="Ko Rec")

TeamBphasePAMiko <- TeamBPAMi %>% filter(main =="Ko Rec")

p + geom_point(data = TeamBphasePASccq , aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamBphasePAMicq, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamBphasePAScko, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamBphasePAMiko, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
theme(legend.position = "bottom") + 
geom_text_repel(data = TeamBphasePASccq , aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) +
geom_text_repel(data = TeamBphasePAMicq, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) +
geom_text_repel(data = TeamBphasePAScko, aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) + 
geom_text_repel(data = TeamBphasePAMiko, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8)

```

##Open Play Shot Origin by Phase
###St Judes (Blue = Score)
```{r, fig.width = 16, fig.height = 10}
#change from shot to coutcomes
TeamAPhScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset== "Scr Op")

TeamAPhAMis <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "A", subset== "Ms Op")

#Pulls out all shots from main TeamB
TeamAPhASc <- subset(pass, Phase %in% TeamAPhScr$Phase)

TeamAPhAMi <- subset(pass, Phase %in% TeamAPhAMis$Phase)

#Score
TeamAphasecq <- TeamAPhASc %>% filter(main == "PW")

TeamAphaseRs <- TeamAPhASc%>% filter(main=="Pass Rs"|Action =="Sl Kp Won To")

TeamAphaseko <- TeamAPhASc %>% filter(main =="Ko Rec")

#Add in Miss
TeamAphasecqMi <- TeamAPhAMi %>% filter(main == "PW")

TeamAphaseRsMi <- TeamAPhAMi%>% filter(main=="Pass Rs"|Action =="Sl Kp Won To"|main == "RBW")

TeamAphasekoMi <- TeamAPhAMi %>% filter(main =="Ko Rec")

#Add in Miss

p + geom_point(data = TeamAphasecq, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphaseRs, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamAphaseko, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
  geom_point(data = TeamAphasecqMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamAphaseRsMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamAphasekoMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_text_repel(data = TeamAphasecq, aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) +
geom_text_repel(data = TeamAphaseRs, aes(x=Areax, y=Areay, label = plylab), col = "blue", size = 8) +
geom_text_repel(data = TeamAphaseko, aes(x=Areax, y=Areay, label = plylab), col = "blue", size = 8) +
  geom_text_repel(data = TeamAphasecqMi, aes(x=Areax, y=Areay, label = plylab), colour = "white", size = 8) +
geom_text_repel(data = TeamAphaseRsMi, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) +
geom_text_repel(data = TeamAphasekoMi, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8)
```

###Ballyboden (Blue = Score)
```{r, fig.width = 16, fig.height = 10}

#change from shot to coutcomes
TeamBPhScr <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset== "Scr Op")

TeamBPhAMis <- pass %>%group_by(Team, Action) %>% filter(Teamnum == "B", subset== "Ms Op")

#Pulls out all shots from main TeamB
TeamBPhASc <- subset(pass, Phase %in% TeamBPhScr$Phase)

TeamBPhAMi <- subset(pass, Phase %in% TeamBPhAMis$Phase)

#Score
TeamBphasecq <- TeamBPhASc %>% filter(main  == "PW")

TeamBphaseRs <- TeamBPhASc%>% filter(main=="Pass Rs"|Action =="Sl Kp Won To"|main == "RBW")

TeamBphaseko <- TeamBPhASc %>% filter(main=="Ko Rec")

#Add in Miss
TeamBphasecqMi <- TeamBPhAMi %>% filter(main == "PW")

TeamBphaseRsMi <- TeamBPhAMi%>% filter(main=="Pass Rs"|Action =="Sl Kp Won To"|main == "RBW")

TeamBphasekoMi <- TeamBPhAMi %>% filter(main =="Ko Rec")

#Add in Miss

p + geom_point(data = TeamBphasecq, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamBphaseRs, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
geom_point(data = TeamBphaseko, aes(x=Areax, y=Areay), colour = "blue", size = 6, shape = 17) +
  geom_point(data = TeamBphasecqMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamBphaseRsMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_point(data = TeamBphasekoMi, aes(x=Areax, y=Areay), colour = "white", size = 6,shape = 4, stroke = 2) +
geom_text_repel(data = TeamBphasecq, aes(x=Areax, y=Areay, label = plylab), colour = "blue", size = 8) +
geom_text_repel(data = TeamBphaseRs, aes(x=Areax, y=Areay, label = plylab), col = "blue", size = 8) +
geom_text_repel(data = TeamBphaseko, aes(x=Areax, y=Areay, label = plylab), col = "blue", size = 8) +
geom_text_repel(data = TeamBphasecqMi, aes(x=Areax, y=Areay, label = plylab), colour = "white",size = 8) +
geom_text_repel(data = TeamBphaseRsMi, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8) +
geom_text_repel(data = TeamBphasekoMi, aes(x=Areax, y=Areay, label = plylab), col = "white", size = 8)
```

##Shot Network 
###St Judes
```{r, fig.width = 20, fig.height = 20}

linksABps <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passshotjudbod.csv", header=TRUE, sep=";")
attach (linksABps)

nodesteamAps <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodesshotjudbod.csv", header=TRUE, sep=";")
attach (nodesteamAps)

linksAps <- linksABps %>% filter( Teamnum == "A") %>% select(Teamnum,plypass, plyrec)

linksAps <- rename(count(linksAps, plypass, plyrec), weight = n)

netAps <- graph_from_data_frame(d=linksAps, vertices=nodesteamAps, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("lightblue", "lightblue", "lightblue", "lightblue", "lightblue")
V(netAps)$color <- colrs[V(netAps)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netAps, mode="all")
V(netAps)$size <- deg*2 #size of node 

nodes.coordA <- data.frame(data = nodesteamAps,
    x= Areax,
    y=Areay)

plot(netAps, edge.arrow.size=.4, edge.color="lightblue",edge.arrow.width=.4,
      edge.width=E(netAps)$weight*5, layout=as.matrix(nodes.coordA[,c("x","y")]), vertex.label.color="darkblue", vertex.label = labelAsh, vertex.label.cex = 5)
```

###Ballyboden
```{r, fig.width = 20, fig.height = 20}

linksABps <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/passshotjudbod.csv", header=TRUE, sep=";")
attach (linksABps)

nodesteamBps <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodesshotbodjud.csv", header=TRUE, sep=";")
attach (nodesteamBps)

linksBps <- linksABps %>% filter( Teamnum == "B") %>% select(Teamnum,plypass, plyrec)

linksBps <- rename(count(linksBps, plypass, plyrec), weight = n)

netBps <- graph_from_data_frame(d=linksBps, vertices=nodesteamBps, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("blue", "blue", "blue","blue","blue")
V(netBps)$color <- colrs[V(netBps)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netBps, mode="all")
V(netBps)$size <- deg*2 #size of node 

nodes.coordB <- data.frame(data = nodesteamBps,
    x= Areax,
    y=Areay)

plot(netBps, edge.arrow.size=.4, edge.color="blue",edge.arrow.width=.4,
      edge.width=E(netBps)$weight*5, layout=as.matrix(nodes.coordB[,c("x","y")]), vertex.label.color="black",  vertex.label = labelBsh, vertex.label.cex = 5)

```

##Score Network 
###St Judes
```{r, fig.width = 20, fig.height = 20}

linksABs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/linksscoresjudbod.csv", header=TRUE, sep=";")
attach (linksABps)

nodesteamAs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodesscorejudbod.csv", header=TRUE, sep=";")
attach (nodesteamAs)

linksAs <- linksABs %>% filter( Teamnum == "A") %>% select(Teamnum,plypass, plyrec)

linksAs <- rename(count(linksAs, plypass, plyrec), weight = n)

netAs <- graph_from_data_frame(d=linksAs, vertices=nodesteamAs, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("lightblue", "lightblue", "lightblue", "lightblue", "lightblue")
V(netAs)$color <- colrs[V(netAs)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netAs, mode="all")
V(netAs)$size <- deg*2 #size of node 

nodes.coordA <- data.frame(data = nodesteamAs,
    x= Areax,
    y=Areay)

plot(netAs, edge.arrow.size=.4, edge.color="lightblue",edge.arrow.width=.4,
      edge.width=E(netAs)$weight*5, layout=as.matrix(nodes.coordA[,c("x","y")]), vertex.label.color="darkblue", vertex.label = labAscr, vertex.label.cex = 5)

```

###Ballyboden
```{r, fig.width = 20, fig.height = 20}

linksABs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/linksscoresjudbod.csv", header=TRUE, sep=";")
attach (linksABs)

nodesteamAs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodesscorejudbod.csv", header=TRUE, sep=";")
attach (nodesteamAs)

nodesteamBs <- read.csv(file="c:/Users/donagh/OneDrive/Spreadsheet fun/PA Analytics/PA Template/judbod/nodesscorebodjud.csv", header=TRUE, sep=";")
attach (nodesteamBs)

linksBs <- linksABs %>% filter( Teamnum == "B") %>% select(Teamnum,plypass, plyrec)

linksBs <- rename(count(linksBs, plypass, plyrec), weight = n)

netBs <- graph_from_data_frame(d=linksBs, vertices=nodesteamBs, directed=T) 

# Generate colors based on number of position (ie gk back mf for) type:
colrs <- c("blue","blue","blue","blue","blue")
V(netBs)$color <- colrs[V(netBs)$posn]

# Compute node degrees (#links) and use that to set node size:
deg <- degree(netBs, mode="all")
V(netBs)$size <- deg*2 #size of node 

nodes.coordB <- data.frame(data = nodesteamBs,
    x= Areax,
    y=Areay)

plot(netBs, edge.arrow.size=.4, edge.color="blue",edge.arrow.width=.4,
      edge.width=E(netBs)$weight*5, layout=as.matrix(nodes.coordB[,c("x","y")]), vertex.label.color="black",  vertex.label = labBscr, vertex.label.cex = 5)

```


#Passing

##Pass Breakdown
```{r}
 
kable (passbd) %>% kable_styling()

```

```{r}

palpatt<- c("Rec Op"="blue",
"Rec Rs"="blue",
"Pass ToL"="red",
"Fk Loss ToL"="red",
"Rs ToL"="red",
"Rec Key" = "black",
"Rec Ast" = "darkgreen",
"Rec Rs Ast"="blue",
"Rec Rs Key"="blue")

palspatts <- c("Pass Op" = 15,
"Pass Rs"  = 16,
"Pass Ast" = 15,
"Pass Key" = 15,
"Rec Op"=0,
"Rec Rs"=1,
"Pass ToL"=4,
"Fk Loss ToL"=4,
"Rs ToL"=4,
"Rec Key" = 0,
"Rec Ast" = 0,
"Pass Rs Ast"  = 2,
"Pass RS Key" = 6,
"Rec Rs Key" = 0,
"Rec Rs Ast" = 0)


```

##All Passes 
###St Judes

```{r, fig.width = 16, fig.height = 10}

#All Pass

passA <- passtofrom %>% filter(Teamnum == "A")

p + geom_segment(data = passA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = subrec)) +
    geom_point(data = passA, aes(x = Areax, y = Areay, colour = subrec, shape = subset, size = 1,stroke = 1)) +
    geom_point (data = passA, aes(x=xend, y=yend, colour = subrec, shape = subrec, size = .5,stroke = 2)) +   
    theme(legend.position="none", legend.title=element_text(size=14), 
          legend.text=element_text(size=16)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 14))) +
scale_shape_manual(values= palspatts) +
  scale_colour_manual(values = palpatt) + 
geom_text(data = passA, aes(x = Areax, y = Areay, label = Player), colour = "white", size = 4) +
  ggtitle("blue = Pass, red = lost pass, green = assist(score), black = key pass(shot attempt)")

```

 
###Ballyboden

```{r, fig.width = 16, fig.height = 10}

#All Pass

passB <- passtofrom %>% filter(Teamnum == "B")

p + geom_segment(data = passB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = subrec)) +
    geom_point(data = passB, aes(x = Areax, y = Areay, colour = subrec, shape = subset, size = 1,stroke = 1)) +
    geom_point (data = passB, aes(x=xend, y=yend, colour = subrec, shape = subrec, size = .5,stroke = 2)) +   
    theme(legend.position="none", legend.title=element_text(size=14), 
          legend.text=element_text(size=16)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 14))) +
scale_shape_manual(values= palspatts) +
  scale_colour_manual(values = palpatt) + 
geom_text(data = passB, aes(x = Areax, y = Areay, label = Player), colour = "white", size = 4) +
  ggtitle("blue = Pass, red = lost pass, green = assist(score), black = key pass(shot attempt)")

```

##Passes into 45
###St Judes

```{r, fig.width = 16, fig.height = 10}

#passing to from
advpassA <- passtofrom %>% filter(Areax <5.5 & xend > 5.5 , Teamnum == "A")

p + geom_segment(data = advpassA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = subrec)) +
    geom_point(data = advpassA, aes(x = Areax, y = Areay, colour = subrec, shape = subset, size = 1,stroke = 1)) +
    geom_point (data = advpassA, aes(x=xend, y=yend, colour = subrec, shape = subrec, size = .5,stroke = 2)) +   
    theme(legend.position="none", legend.title=element_text(size=14), 
          legend.text=element_text(size=16)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 14))) +
scale_shape_manual(values= palspatts) +
  scale_colour_manual(values = palpatt) + 
geom_text(data = advpassA, aes(x = Areax, y = Areay, label = Player), colour = "white", size = 4) +
  ggtitle("blue = Pass, red = lost pass, green = assist(score), black = key pass(shot attempt)")
```

###Ballyboden

```{r, fig.width = 16, fig.height = 10}
advpassB <- passtofrom %>% filter(Areax <5.5 & xend > 5.5 , Teamnum == "B")

p + geom_segment(data = advpassB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = subrec)) +
    geom_point(data = advpassB, aes(x = Areax, y = Areay, colour = subrec, shape = subset, size = 1,stroke = 1)) +
    geom_point (data = advpassB, aes(x=xend, y=yend, colour = subrec, shape = subrec, size = .5,stroke = 2)) +   
    theme(legend.position="none", legend.title=element_text(size=14), 
          legend.text=element_text(size=16)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 14))) +
scale_shape_manual(values= palspatts) +
  scale_colour_manual(values = palpatt) + 
geom_text(data = advpassB, aes(x = Areax, y = Areay, label = Player), colour = "white", size = 4) +
  ggtitle("blue = Pass, red = lost pass, green = assist(score), black = key pass(shot attempt)")
```

##Passes Inside Opp 65
###St Judes

```{r, fig.width = 16, fig.height = 10}

#passing to from
advpassA <- passtofrom %>% filter(Areax >4.5, Teamnum == "A")

p + geom_segment(data = advpassA, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = subrec)) +
    geom_point(data = advpassA, aes(x = Areax, y = Areay, colour = subrec, shape = subset, size = 1,stroke = 1)) +
    geom_point (data = advpassA, aes(x=xend, y=yend, colour = subrec, shape = subrec, size = .5,stroke = 2)) +   
    theme(legend.position="none", legend.title=element_text(size=14), 
          legend.text=element_text(size=16)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 14))) +
scale_shape_manual(values= palspatts) +
  scale_colour_manual(values = palpatt) + 
geom_text(data = advpassA, aes(x = Areax, y = Areay, label = Player), colour = "white", size = 4) +
  ggtitle("blue = Pass, red = lost pass, green = assist(score), black = key pass(shot attempt)")

```

###Ballyboden

```{r, fig.width = 16, fig.height = 10}
advpassB <- passtofrom %>% filter(Areax >4.5, Teamnum == "B")

p + geom_segment(data = advpassB, aes(x = Areax, y = Areay, xend = xend, yend = yend, colour = subrec)) +
    geom_point(data = advpassB, aes(x = Areax, y = Areay, colour = subrec, shape = subset, size = 1,stroke = 1)) +
    geom_point (data = advpassB, aes(x=xend, y=yend, colour = subrec, shape = subrec, size = .5,stroke = 2)) +   
    theme(legend.position="none", legend.title=element_text(size=14), 
          legend.text=element_text(size=16)) +
    guides(color = FALSE, size = FALSE) +
    guides(shape = guide_legend(override.aes = list(size = 14))) +
scale_shape_manual(values= palspatts) +
  scale_colour_manual(values = palpatt) + 
geom_text(data = advpassB, aes(x = Areax, y = Areay, label = Player), colour = "white", size = 4) +
  ggtitle("blue = Pass, red = lost pass, green = assist(score), black = key pass(shot attempt)")
```



#Player Stats 
##Player On Ball Possession (Number, Player, Total)
###St Judes

```{r, fig.width = 16, fig.height = 10}

plyA <- plytree%>% filter(Teamnum == "A")

treemap(dtf = plyA,
        index=c("plylab"),
        vSize="possessions",
        vColor="possessions",
        palette="Spectral",
        type="value",
        border.col=c("grey70", "grey90"),
        fontsize.title = 36,
        algorithm="pivotSize",
        title ="On Ball Possessions",
        title.legend="Possessions",
        fontsize.labels= 25)
```

###Ballyboden

```{r, fig.width = 16, fig.height = 10}

plyB<- plytree%>% filter(Teamnum == "B")
treemap(dtf = plyB,
        index=c("plylab"),
        vSize="possessions",
        vColor="possessions",
        palette="Spectral",
        type="value",
        border.col=c("grey70", "grey90"),
        fontsize.title = 26,
        algorithm="pivotSize",
        title ="On Ball Possessions",
        title.legend="Possessions",
        fontsize.labels= 25,
         inflate.labels=F)

```

##Player Possession Involvement
###St Judes
```{r}
shotinvA <- plystats%>%filter(Teamnum=="A")%>% select(Team, plyposs, involposs, plysh,involsh,plyscr,involscr) 
ggplot(shotinvA , aes(x = plyposs, y = involposs)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =involposs, vjust = 0), size = 8,colour ="black") +
scale_x_continuous("player", labels = as.character(plyposs), breaks = plyposs)  + 
ylab("Poessession involvements") +
theme(legend.position="none") +
 theme_classic()



```

###Ballyboden
```{r}
shotinvA <- plystats%>%filter(Teamnum=="B")%>% select(Team, plyposs, involposs, plysh,involsh,plyscr,involscr) 
ggplot(shotinvA , aes(x = plyposs, y = involposs)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =involposs, vjust = 0), size = 8,colour ="black") +
scale_x_continuous("player", labels = as.character(plyposs), breaks = plyposs)  + 
ylab("Poessession involvements") +
theme(legend.position="none") +
 theme_classic()



```

##Player Shot Involvement

###St Judes
```{r}
shotinvA <- plystats%>%filter(Teamnum=="A")%>% select(Team, plysh,involsh,plyscr,involscr) 
ggplot(shotinvA , aes(x = plysh, y = involsh)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =involsh, vjust = 0), size = 8,colour ="black") +
scale_x_continuous("plysh", labels = as.character(plysh), breaks = plysh)  + 
ylab("Shot involvements") +
theme(legend.position="none") +
 theme_classic()



```

###Ballyboden
```{r}
shotinvB <- plystats%>%filter(Teamnum=="B")%>% select(Team, plysh,involsh,plyscr,involscr) 
ggplot(shotinvB , aes(x = plysh, y = involsh)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =involsh, vjust = 0), size = 8,colour ="black") +
scale_x_continuous("plysh", labels = as.character(plysh), breaks = plysh)  + 
ylab("Shot involvements") +
theme(legend.position="none") +
 theme_classic()

```

##Player Score Involvement

###St Judes
```{r}

scrinvA <- plystats%>%filter(Teamnum=="A")%>% select(Team, plysh,involsh,plyscr,involscr) 
ggplot(scrinvA , aes(x = plyscr, y = involscr)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =involscr, vjust = 0), size = 8,colour ="black") +
scale_x_continuous("plyscr", labels = as.character(plyscr), breaks = plyscr)  + 
ylab("Score involvements") +
theme(legend.position="none") +
 theme_classic()

```


###Ballyboden
```{r}
scrinvB <- plystats%>%filter(Teamnum=="B")%>% select(Team, plysh,involsh,plyscr,involscr) 
ggplot(scrinvB , aes(x = plyscr, y = involscr)) +
  geom_bar(stat = "identity", 
           fill = "lightgreen",    
           width = .5) +  
geom_text(aes(label =involscr, vjust = 0), size = 8,colour ="black") +
scale_x_continuous("plyscr", labels = as.character(plyscr), breaks = plyscr)  + 
ylab("Score involvements") +
theme(legend.position="none") +
 theme_classic()

```


##Posessions Per Playing Time

```{r}
ggplot(data = plystats , aes(x = plytime, y = OBP)) + 
geom_point(data = plystats , aes(x = plytime, y = OBP, colour = Team), size =2) +
geom_text_repel(data = plystats , aes(x = plytime, y = OBP, colour = Team, label = ply), size = 4) +
theme_classic () +
guides(size = FALSE) + 
  theme(legend.position="bottom")
```

##Player % involvement and shot efficiency
```{r}
scrA <- plystats%>%filter(Teamnum=="A")%>% select(Team, ply,opshots, Totteamshot,opscr,Totteamscr,convrate) 
kable (scrA)%>% kable_styling(bootstrap_options=c("striped"))

scrB <- plystats%>%filter(Teamnum=="B")%>% select(Team, ply,opshots, Totteamshot,opscr,Totteamscr,convrate) 
kable (scrB)%>% kable_styling(bootstrap_options=c("striped"))

```

##Open Play Shots vs Playing Time
```{r}
ggplot(data = plystats , aes(x = plytime, y = opshots)) + 
geom_point(data = plystats , aes(x = plytime, y = opshots, colour = Team), size = 2) +
geom_text_repel(data = plystats , aes(x = plytime, y = opshots, colour = Team, label = ply), size = 4) +
theme_classic () +
guides(color = FALSE, size = FALSE) + 
  theme(legend.position="bottom")
```

##Open Play Scores vs Playing Time
```{r}
ggplot(data = plystats , aes(x = plytime, y = opscr)) + 
geom_point(data = plystats , aes(x = plytime, y = opscr, colour = Team), size = 2) +
geom_text_repel(data = plystats , aes(x = plytime, y = opscr, colour = Team, label = ply), size = 4) +
theme_classic () +
guides(color = FALSE, size = FALSE) + 
  theme(legend.position="bottom")
```

##Open Play Shots vs Open Play Score
```{r}
plystatsscr <- plystats %>% filter(opscr >0)

ggplot(data = plystatsscr , aes(x = opshots, y = opscr)) + 
geom_point(data = plystatsscr , aes(x = opshots, y = opscr, colour = Team), size = 2) +
geom_text_repel(data = plystatsscr , aes(x = opshots, y = opscr, colour = Team, label = ply), size = 4) +
theme_classic () +
guides(color = FALSE, size = FALSE) + 
  theme(legend.position="bottom")
```

##Open Play Assists vs Playing Time

```{r}
ggplot(data = plystats , aes(x = plytime, y = Assist)) + 
geom_point(data = plystats , aes(x = plytime, y = Assist, colour = Team), size = 2) +
geom_text_repel(data = plystats , aes(x = plytime, y = Assist, colour = Team, label = ply), size = 4) +
theme_classic () +
guides(color = FALSE, size = FALSE) + 
  theme(legend.position="bottom")
```

##Open Play Key Passes vs Playing time

```{r}
ggplot(data = plystats , aes(x = plytime, y = Key)) + 
geom_point(data = plystats , aes(x = plytime, y = Key, colour = Team), size = 2) +
geom_text_repel(data = plystats , aes(x = plytime, y = Key, colour = Team, label = ply), size = 4) +
theme_classic () +
guides(color = FALSE, size = FALSE) + 
  theme(legend.position="bottom")
```




##Actions and Zones
##By Period
###St Judes
```{r}
passA <- pass
passA <- passA[passA$possno!="0", ]
passA <- passA[passA$phaseno!="0", ]
passA <- passA[passA$main!="Shot Op Oc", ]
passA <- passA[passA$main!="Shot Rs Oc", ]
passA <- passA[passA$main!="Shot Op", ]
passA <- passA[passA$main!="Shot Rs", ]



perA <- passA %>%group_by(Team,main,period) %>% filter(Teamnum == "A")%>%tally%>%mutate(f = sum(n))
pA <- ggplot(perA,aes(x=period,weight = n)) + geom_histogram()+facet_grid(Team ~ main) + theme_light()
pA

```

```{r}

passB <- pass
passB <- passB[passB$main!="Pass Op", ]
passB <- passB[passB$main!="Rec Op", ]
passB <- passB[passB$main!="Pass Rs", ]
passB <- passB[passB$main!="Rec Rs", ]
passB <- passB[passB$possno!="0", ]
passB <- passB[passB$phaseno!="0", ]
passB <- passB[passB$main!="ToL", ]
passB <- passB[passB$main!="PW", ]
passB <- passB[passB$main!="Ko", ]
passB <- passB[passB$main!="Ko Rec", ]
passB <- passB[passB$main!="Fk Won", ]

perAA <- passB %>%group_by(Team,subset,period) %>% filter(Teamnum == "A")%>%tally%>%mutate(f = sum(n))
pAA <- ggplot(perAA,aes(x=period,weight = n)) + geom_histogram()+facet_grid(Team ~ subset) + theme_light()

pAA

```

###Ballyboden
```{r}

passA <- pass
passA <- passA[passA$possno!="0", ]
passA <- passA[passA$phaseno!="0", ]
passA <- passA[passA$main!="Shot Op Oc", ]
passA <- passA[passA$main!="Shot Rs Oc", ]
passA <- passA[passA$main!="Shot Op", ]
passA <- passA[passA$main!="Shot Rs", ]


perB <- passA %>%group_by(Team,main,period) %>% filter(Teamnum == "B")%>%tally%>%mutate(f = sum(n))
pB <- ggplot(perB,aes(x=period,weight = n)) + geom_histogram()+facet_grid(Team ~ main) + theme_light()
pB
```

```{r}

passB <- pass
passB <- passB[passB$main!="Pass Op", ]
passB <- passB[passB$main!="Rec Op", ]
passB <- passB[passB$main!="Pass Rs", ]
passB <- passB[passB$main!="Rec Rs", ]
passB <- passB[passB$possno!="0", ]
passB <- passB[passB$phaseno!="0", ]
passB <- passB[passB$main!="ToL", ]
passB <- passB[passB$main!="PW", ]
passB <- passB[passB$main!="Ko", ]
passB <- passB[passB$main!="Ko Rec", ]
passB <- passB[passB$main!="Fk Won", ]

perAB <- passB %>%group_by(Team,subset,period) %>% filter(Teamnum == "B")%>%tally%>%mutate(f = sum(n))
pAB <- ggplot(perAB,aes(x=period,weight = n)) + geom_histogram()+facet_grid(Team ~ subset) + theme_light()

pAB

```


##Zones Frequency
###St Judes

```{r}

zoneA <- pass %>%group_by(Team, Zone) %>% filter(Teamnum == "A", Zone >=0, Zone <=140)%>%summarize(count=n())

ggplot(zoneA, aes(x = Zone, y = count)) +   
  geom_bar(stat = "identity", 
           fill = "lightblue",    
           width = 0.50) +
theme_classic() +
   geom_vline(xintercept=40.25, linetype="dotted", color = "black") +
   geom_vline(xintercept=70.25, linetype="dotted", color = "black") +
   geom_vline(xintercept=100.25, linetype="dotted", color = "black") +
   geom_vline(xintercept=140.25, linetype="dotted", color = "black") +  
      annotate(geom="text", x= 20, y=-0.25, label="Def",color = "black") +
      annotate(geom="text", x= 55, y=-0.25, label="Mid Def",color = "black") +
      annotate(geom="text", x= 85, y=-0.25, label="Mid Att",color = "black") +
      annotate(geom="text", x= 120, y=-0.25, label="Att",color = "black") 
```

###Ballyboden
```{r}
zoneB <- pass %>%group_by(Team, Zone) %>% filter(Teamnum == "B", Zone >=0, Zone <=140)%>%summarize(count=n())

ggplot(zoneB, aes(x = Zone, y = count)) +   
  geom_bar(stat = "identity", 
           fill = "lightblue",    
           width = 0.50) +
theme_classic() +
   geom_vline(xintercept=40.25, linetype="dotted", color = "black") +
   geom_vline(xintercept=70.25, linetype="dotted", color = "black") +
   geom_vline(xintercept=100.25, linetype="dotted", color = "black") +
   geom_vline(xintercept=140.25, linetype="dotted", color = "black") +  
      annotate(geom="text", x= 20, y=-0.25, label="Def",color = "black") +
      annotate(geom="text", x= 55, y=-0.25, label="Mid Def",color = "black") +
      annotate(geom="text", x= 85, y=-0.25, label="Mid Att",color = "black") +
      annotate(geom="text", x= 120, y=-0.25, label="Att",color = "black") 
```


